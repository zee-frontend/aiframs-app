var Ty=e=>{throw TypeError(e)};var zf=(e,t,n)=>t.has(e)||Ty("Cannot "+n);var Q=(e,t,n)=>(zf(e,t,"read from private field"),n?n.call(e):t.get(e)),qe=(e,t,n)=>t.has(e)?Ty("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Pe=(e,t,n,r)=>(zf(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Qt=(e,t,n)=>(zf(e,t,"access private method"),n);var Ll=(e,t,n,r)=>({set _(o){Pe(e,t,o,n)},get _(){return Q(e,t,r)}});function bk(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(r,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function rw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ow={exports:{}},Vd={},aw={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dl=Symbol.for("react.element"),Ck=Symbol.for("react.portal"),Ek=Symbol.for("react.fragment"),_k=Symbol.for("react.strict_mode"),Sk=Symbol.for("react.profiler"),kk=Symbol.for("react.provider"),Rk=Symbol.for("react.context"),Nk=Symbol.for("react.forward_ref"),Dk=Symbol.for("react.suspense"),Ik=Symbol.for("react.memo"),Tk=Symbol.for("react.lazy"),Py=Symbol.iterator;function Pk(e){return e===null||typeof e!="object"?null:(e=Py&&e[Py]||e["@@iterator"],typeof e=="function"?e:null)}var iw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sw=Object.assign,uw={};function Fs(e,t,n){this.props=e,this.context=t,this.refs=uw,this.updater=n||iw}Fs.prototype.isReactComponent={};Fs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lw(){}lw.prototype=Fs.prototype;function Yv(e,t,n){this.props=e,this.context=t,this.refs=uw,this.updater=n||iw}var Xv=Yv.prototype=new lw;Xv.constructor=Yv;sw(Xv,Fs.prototype);Xv.isPureReactComponent=!0;var Ay=Array.isArray,cw=Object.prototype.hasOwnProperty,Qv={current:null},dw={key:!0,ref:!0,__self:!0,__source:!0};function fw(e,t,n){var r,o={},a=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)cw.call(t,r)&&!dw.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:dl,type:e,key:a,ref:i,props:o,_owner:Qv.current}}function Ak(e,t){return{$$typeof:dl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Jv(e){return typeof e=="object"&&e!==null&&e.$$typeof===dl}function Mk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var My=/\/+/g;function $f(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Mk(""+e.key):t.toString(36)}function Cc(e,t,n,r,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case dl:case Ck:i=!0}}if(i)return i=e,o=o(i),e=r===""?"."+$f(i,0):r,Ay(o)?(n="",e!=null&&(n=e.replace(My,"$&/")+"/"),Cc(o,t,n,"",function(l){return l})):o!=null&&(Jv(o)&&(o=Ak(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(My,"$&/")+"/")+e)),t.push(o)),1;if(i=0,r=r===""?".":r+":",Ay(e))for(var s=0;s<e.length;s++){a=e[s];var u=r+$f(a,s);i+=Cc(a,t,n,u,o)}else if(u=Pk(e),typeof u=="function")for(e=u.call(e),s=0;!(a=e.next()).done;)a=a.value,u=r+$f(a,s++),i+=Cc(a,t,n,u,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Bl(e,t,n){if(e==null)return e;var r=[],o=0;return Cc(e,r,"","",function(a){return t.call(n,a,o++)}),r}function Fk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xn={current:null},Ec={transition:null},Ok={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:Ec,ReactCurrentOwner:Qv};function hw(){throw Error("act(...) is not supported in production builds of React.")}Oe.Children={map:Bl,forEach:function(e,t,n){Bl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Bl(e,function(){t++}),t},toArray:function(e){return Bl(e,function(t){return t})||[]},only:function(e){if(!Jv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Oe.Component=Fs;Oe.Fragment=Ek;Oe.Profiler=Sk;Oe.PureComponent=Yv;Oe.StrictMode=_k;Oe.Suspense=Dk;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ok;Oe.act=hw;Oe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=sw({},e.props),o=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Qv.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)cw.call(t,u)&&!dw.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:dl,type:e.type,key:o,ref:a,props:r,_owner:i}};Oe.createContext=function(e){return e={$$typeof:Rk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kk,_context:e},e.Consumer=e};Oe.createElement=fw;Oe.createFactory=function(e){var t=fw.bind(null,e);return t.type=e,t};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(e){return{$$typeof:Nk,render:e}};Oe.isValidElement=Jv;Oe.lazy=function(e){return{$$typeof:Tk,_payload:{_status:-1,_result:e},_init:Fk}};Oe.memo=function(e,t){return{$$typeof:Ik,type:e,compare:t===void 0?null:t}};Oe.startTransition=function(e){var t=Ec.transition;Ec.transition={};try{e()}finally{Ec.transition=t}};Oe.unstable_act=hw;Oe.useCallback=function(e,t){return xn.current.useCallback(e,t)};Oe.useContext=function(e){return xn.current.useContext(e)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(e){return xn.current.useDeferredValue(e)};Oe.useEffect=function(e,t){return xn.current.useEffect(e,t)};Oe.useId=function(){return xn.current.useId()};Oe.useImperativeHandle=function(e,t,n){return xn.current.useImperativeHandle(e,t,n)};Oe.useInsertionEffect=function(e,t){return xn.current.useInsertionEffect(e,t)};Oe.useLayoutEffect=function(e,t){return xn.current.useLayoutEffect(e,t)};Oe.useMemo=function(e,t){return xn.current.useMemo(e,t)};Oe.useReducer=function(e,t,n){return xn.current.useReducer(e,t,n)};Oe.useRef=function(e){return xn.current.useRef(e)};Oe.useState=function(e){return xn.current.useState(e)};Oe.useSyncExternalStore=function(e,t,n){return xn.current.useSyncExternalStore(e,t,n)};Oe.useTransition=function(){return xn.current.useTransition()};Oe.version="18.3.1";aw.exports=Oe;var R=aw.exports;const te=rw(R),pw=bk({__proto__:null,default:te},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lk=R,Bk=Symbol.for("react.element"),jk=Symbol.for("react.fragment"),Wk=Object.prototype.hasOwnProperty,zk=Lk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$k={key:!0,ref:!0,__self:!0,__source:!0};function vw(e,t,n){var r,o={},a=null,i=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Wk.call(t,r)&&!$k.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:Bk,type:e,key:a,ref:i,props:o,_owner:zk.current}}Vd.Fragment=jk;Vd.jsx=vw;Vd.jsxs=vw;ow.exports=Vd;var C=ow.exports,mw={exports:{}},Jn={},gw={exports:{}},yw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,F){var z=D.length;D.push(F);e:for(;0<z;){var H=z-1>>>1,X=D[H];if(0<o(X,F))D[H]=F,D[z]=X,z=H;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var F=D[0],z=D.pop();if(z!==F){D[0]=z;e:for(var H=0,X=D.length,ee=X>>>1;H<ee;){var le=2*(H+1)-1,ye=D[le],se=le+1,xe=D[se];if(0>o(ye,z))se<X&&0>o(xe,ye)?(D[H]=xe,D[se]=z,H=se):(D[H]=ye,D[le]=z,H=le);else if(se<X&&0>o(xe,z))D[H]=xe,D[se]=z,H=se;else break e}}return F}function o(D,F){var z=D.sortIndex-F.sortIndex;return z!==0?z:D.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,s=i.now();e.unstable_now=function(){return i.now()-s}}var u=[],l=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(D){for(var F=n(l);F!==null;){if(F.callback===null)r(l);else if(F.startTime<=D)r(l),F.sortIndex=F.expirationTime,t(u,F);else break;F=n(l)}}function w(D){if(m=!1,x(D),!p)if(n(u)!==null)p=!0,U(b);else{var F=n(l);F!==null&&j(w,F.startTime-D)}}function b(D,F){p=!1,m&&(m=!1,v(_),_=-1),h=!0;var z=f;try{for(x(F),d=n(u);d!==null&&(!(d.expirationTime>F)||D&&!A());){var H=d.callback;if(typeof H=="function"){d.callback=null,f=d.priorityLevel;var X=H(d.expirationTime<=F);F=e.unstable_now(),typeof X=="function"?d.callback=X:d===n(u)&&r(u),x(F)}else r(u);d=n(u)}if(d!==null)var ee=!0;else{var le=n(l);le!==null&&j(w,le.startTime-F),ee=!1}return ee}finally{d=null,f=z,h=!1}}var E=!1,S=null,_=-1,k=5,N=-1;function A(){return!(e.unstable_now()-N<k)}function T(){if(S!==null){var D=e.unstable_now();N=D;var F=!0;try{F=S(!0,D)}finally{F?L():(E=!1,S=null)}}else E=!1}var L;if(typeof y=="function")L=function(){y(T)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,$=M.port2;M.port1.onmessage=T,L=function(){$.postMessage(null)}}else L=function(){g(T,0)};function U(D){S=D,E||(E=!0,L())}function j(D,F){_=g(function(){D(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,U(b))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(D){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var z=f;f=F;try{return D()}finally{f=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,F){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var z=f;f=D;try{return F()}finally{f=z}},e.unstable_scheduleCallback=function(D,F,z){var H=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?H+z:H):z=H,D){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=z+X,D={id:c++,callback:F,priorityLevel:D,startTime:z,expirationTime:X,sortIndex:-1},z>H?(D.sortIndex=z,t(l,D),n(u)===null&&D===n(l)&&(m?(v(_),_=-1):m=!0,j(w,z-H))):(D.sortIndex=X,t(u,D),p||h||(p=!0,U(b))),D},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(D){var F=f;return function(){var z=f;f=F;try{return D.apply(this,arguments)}finally{f=z}}}})(yw);gw.exports=yw;var Uk=gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vk=R,Xn=Uk;function ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xw=new Set,Iu={};function fi(e,t){ws(e,t),ws(e+"Capture",t)}function ws(e,t){for(Iu[e]=t,e=0;e<t.length;e++)xw.add(t[e])}var ko=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ip=Object.prototype.hasOwnProperty,Hk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fy={},Oy={};function Gk(e){return ip.call(Oy,e)?!0:ip.call(Fy,e)?!1:Hk.test(e)?Oy[e]=!0:(Fy[e]=!0,!1)}function qk(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Kk(e,t,n,r){if(t===null||typeof t>"u"||qk(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wn(e,t,n,r,o,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Yt[e]=new wn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Yt[t]=new wn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Yt[e]=new wn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Yt[e]=new wn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Yt[e]=new wn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Yt[e]=new wn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Yt[e]=new wn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Yt[e]=new wn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Yt[e]=new wn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zv=/[\-:]([a-z])/g;function em(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zv,em);Yt[t]=new wn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zv,em);Yt[t]=new wn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zv,em);Yt[t]=new wn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Yt[e]=new wn(e,1,!1,e.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Yt[e]=new wn(e,1,!1,e.toLowerCase(),null,!0,!0)});function tm(e,t,n,r){var o=Yt.hasOwnProperty(t)?Yt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Kk(t,n,o,r)&&(n=null),r||o===null?Gk(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Po=Vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jl=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),Fi=Symbol.for("react.fragment"),nm=Symbol.for("react.strict_mode"),sp=Symbol.for("react.profiler"),ww=Symbol.for("react.provider"),bw=Symbol.for("react.context"),rm=Symbol.for("react.forward_ref"),up=Symbol.for("react.suspense"),lp=Symbol.for("react.suspense_list"),om=Symbol.for("react.memo"),qo=Symbol.for("react.lazy"),Cw=Symbol.for("react.offscreen"),Ly=Symbol.iterator;function Vs(e){return e===null||typeof e!="object"?null:(e=Ly&&e[Ly]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,Uf;function lu(e){if(Uf===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Uf=t&&t[1]||""}return`
`+Uf+e}var Vf=!1;function Hf(e,t){if(!e||Vf)return"";Vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),a=r.stack.split(`
`),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(i!==1||s!==1)do if(i--,s--,0>s||o[i]!==a[s]){var u=`
`+o[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=s);break}}}finally{Vf=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?lu(e):""}function Yk(e){switch(e.tag){case 5:return lu(e.type);case 16:return lu("Lazy");case 13:return lu("Suspense");case 19:return lu("SuspenseList");case 0:case 2:case 15:return e=Hf(e.type,!1),e;case 11:return e=Hf(e.type.render,!1),e;case 1:return e=Hf(e.type,!0),e;default:return""}}function cp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fi:return"Fragment";case Mi:return"Portal";case sp:return"Profiler";case nm:return"StrictMode";case up:return"Suspense";case lp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bw:return(e.displayName||"Context")+".Consumer";case ww:return(e._context.displayName||"Context")+".Provider";case rm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case om:return t=e.displayName||null,t!==null?t:cp(e.type)||"Memo";case qo:t=e._payload,e=e._init;try{return cp(e(t))}catch{}}return null}function Xk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cp(t);case 8:return t===nm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ba(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ew(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Qk(e){var t=Ew(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wl(e){e._valueTracker||(e._valueTracker=Qk(e))}function _w(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ew(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Wc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function dp(e,t){var n=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function By(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ba(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Sw(e,t){t=t.checked,t!=null&&tm(e,"checked",t,!1)}function fp(e,t){Sw(e,t);var n=ba(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hp(e,t.type,n):t.hasOwnProperty("defaultValue")&&hp(e,t.type,ba(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jy(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function hp(e,t,n){(t!=="number"||Wc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var cu=Array.isArray;function qi(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ba(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function pp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ne(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wy(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ne(92));if(cu(n)){if(1<n.length)throw Error(ne(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ba(n)}}function kw(e,t){var n=ba(t.value),r=ba(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function zy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zl,Nw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zl=zl||document.createElement("div"),zl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Tu(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var pu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jk=["Webkit","ms","Moz","O"];Object.keys(pu).forEach(function(e){Jk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pu[t]=pu[e]})});function Dw(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||pu.hasOwnProperty(e)&&pu[e]?(""+t).trim():t+"px"}function Iw(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Dw(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var Zk=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mp(e,t){if(t){if(Zk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ne(62))}}function gp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yp=null;function am(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xp=null,Ki=null,Yi=null;function $y(e){if(e=pl(e)){if(typeof xp!="function")throw Error(ne(280));var t=e.stateNode;t&&(t=Yd(t),xp(e.stateNode,e.type,t))}}function Tw(e){Ki?Yi?Yi.push(e):Yi=[e]:Ki=e}function Pw(){if(Ki){var e=Ki,t=Yi;if(Yi=Ki=null,$y(e),t)for(e=0;e<t.length;e++)$y(t[e])}}function Aw(e,t){return e(t)}function Mw(){}var Gf=!1;function Fw(e,t,n){if(Gf)return e(t,n);Gf=!0;try{return Aw(e,t,n)}finally{Gf=!1,(Ki!==null||Yi!==null)&&(Mw(),Pw())}}function Pu(e,t){var n=e.stateNode;if(n===null)return null;var r=Yd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var wp=!1;if(ko)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){wp=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{wp=!1}function eR(e,t,n,r,o,a,i,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var vu=!1,zc=null,$c=!1,bp=null,tR={onError:function(e){vu=!0,zc=e}};function nR(e,t,n,r,o,a,i,s,u){vu=!1,zc=null,eR.apply(tR,arguments)}function rR(e,t,n,r,o,a,i,s,u){if(nR.apply(this,arguments),vu){if(vu){var l=zc;vu=!1,zc=null}else throw Error(ne(198));$c||($c=!0,bp=l)}}function hi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ow(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Uy(e){if(hi(e)!==e)throw Error(ne(188))}function oR(e){var t=e.alternate;if(!t){if(t=hi(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return Uy(o),e;if(a===r)return Uy(o),t;a=a.sibling}throw Error(ne(188))}if(n.return!==r.return)n=o,r=a;else{for(var i=!1,s=o.child;s;){if(s===n){i=!0,n=o,r=a;break}if(s===r){i=!0,r=o,n=a;break}s=s.sibling}if(!i){for(s=a.child;s;){if(s===n){i=!0,n=a,r=o;break}if(s===r){i=!0,r=a,n=o;break}s=s.sibling}if(!i)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function Lw(e){return e=oR(e),e!==null?Bw(e):null}function Bw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Bw(e);if(t!==null)return t;e=e.sibling}return null}var jw=Xn.unstable_scheduleCallback,Vy=Xn.unstable_cancelCallback,aR=Xn.unstable_shouldYield,iR=Xn.unstable_requestPaint,xt=Xn.unstable_now,sR=Xn.unstable_getCurrentPriorityLevel,im=Xn.unstable_ImmediatePriority,Ww=Xn.unstable_UserBlockingPriority,Uc=Xn.unstable_NormalPriority,uR=Xn.unstable_LowPriority,zw=Xn.unstable_IdlePriority,Hd=null,Jr=null;function lR(e){if(Jr&&typeof Jr.onCommitFiberRoot=="function")try{Jr.onCommitFiberRoot(Hd,e,void 0,(e.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:fR,cR=Math.log,dR=Math.LN2;function fR(e){return e>>>=0,e===0?32:31-(cR(e)/dR|0)|0}var $l=64,Ul=4194304;function du(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,i=n&268435455;if(i!==0){var s=i&~o;s!==0?r=du(s):(a&=i,a!==0&&(r=du(a)))}else i=n&~o,i!==0?r=du(i):a!==0&&(r=du(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Er(t),o=1<<n,r|=e[n],t&=~o;return r}function hR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pR(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Er(a),s=1<<i,u=o[i];u===-1?(!(s&n)||s&r)&&(o[i]=hR(s,t)):u<=t&&(e.expiredLanes|=s),a&=~s}}function Cp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $w(){var e=$l;return $l<<=1,!($l&4194240)&&($l=64),e}function qf(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function fl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Er(t),e[t]=n}function vR(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Er(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}function sm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Er(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var Xe=0;function Uw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Vw,um,Hw,Gw,qw,Ep=!1,Vl=[],ca=null,da=null,fa=null,Au=new Map,Mu=new Map,Yo=[],mR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hy(e,t){switch(e){case"focusin":case"focusout":ca=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":fa=null;break;case"pointerover":case"pointerout":Au.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mu.delete(t.pointerId)}}function Gs(e,t,n,r,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},t!==null&&(t=pl(t),t!==null&&um(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function gR(e,t,n,r,o){switch(t){case"focusin":return ca=Gs(ca,e,t,n,r,o),!0;case"dragenter":return da=Gs(da,e,t,n,r,o),!0;case"mouseover":return fa=Gs(fa,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return Au.set(a,Gs(Au.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Mu.set(a,Gs(Mu.get(a)||null,e,t,n,r,o)),!0}return!1}function Kw(e){var t=Ua(e.target);if(t!==null){var n=hi(t);if(n!==null){if(t=n.tag,t===13){if(t=Ow(n),t!==null){e.blockedOn=t,qw(e.priority,function(){Hw(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _c(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=_p(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);yp=r,n.target.dispatchEvent(r),yp=null}else return t=pl(n),t!==null&&um(t),e.blockedOn=n,!1;t.shift()}return!0}function Gy(e,t,n){_c(e)&&n.delete(t)}function yR(){Ep=!1,ca!==null&&_c(ca)&&(ca=null),da!==null&&_c(da)&&(da=null),fa!==null&&_c(fa)&&(fa=null),Au.forEach(Gy),Mu.forEach(Gy)}function qs(e,t){e.blockedOn===t&&(e.blockedOn=null,Ep||(Ep=!0,Xn.unstable_scheduleCallback(Xn.unstable_NormalPriority,yR)))}function Fu(e){function t(o){return qs(o,e)}if(0<Vl.length){qs(Vl[0],e);for(var n=1;n<Vl.length;n++){var r=Vl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ca!==null&&qs(ca,e),da!==null&&qs(da,e),fa!==null&&qs(fa,e),Au.forEach(t),Mu.forEach(t),n=0;n<Yo.length;n++)r=Yo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Yo.length&&(n=Yo[0],n.blockedOn===null);)Kw(n),n.blockedOn===null&&Yo.shift()}var Xi=Po.ReactCurrentBatchConfig,Hc=!0;function xR(e,t,n,r){var o=Xe,a=Xi.transition;Xi.transition=null;try{Xe=1,lm(e,t,n,r)}finally{Xe=o,Xi.transition=a}}function wR(e,t,n,r){var o=Xe,a=Xi.transition;Xi.transition=null;try{Xe=4,lm(e,t,n,r)}finally{Xe=o,Xi.transition=a}}function lm(e,t,n,r){if(Hc){var o=_p(e,t,n,r);if(o===null)rh(e,t,r,Gc,n),Hy(e,r);else if(gR(o,e,t,n,r))r.stopPropagation();else if(Hy(e,r),t&4&&-1<mR.indexOf(e)){for(;o!==null;){var a=pl(o);if(a!==null&&Vw(a),a=_p(e,t,n,r),a===null&&rh(e,t,r,Gc,n),a===o)break;o=a}o!==null&&r.stopPropagation()}else rh(e,t,r,null,n)}}var Gc=null;function _p(e,t,n,r){if(Gc=null,e=am(r),e=Ua(e),e!==null)if(t=hi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Ow(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gc=e,null}function Yw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sR()){case im:return 1;case Ww:return 4;case Uc:case uR:return 16;case zw:return 536870912;default:return 16}default:return 16}}var ra=null,cm=null,Sc=null;function Xw(){if(Sc)return Sc;var e,t=cm,n=t.length,r,o="value"in ra?ra.value:ra.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===o[a-r];r++);return Sc=o.slice(e,1<r?1-r:void 0)}function kc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Hl(){return!0}function qy(){return!1}function Zn(e){function t(n,r,o,a,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Hl:qy,this.isPropagationStopped=qy,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Hl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Hl)},persist:function(){},isPersistent:Hl}),t}var Os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dm=Zn(Os),hl=pt({},Os,{view:0,detail:0}),bR=Zn(hl),Kf,Yf,Ks,Gd=pt({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ks&&(Ks&&e.type==="mousemove"?(Kf=e.screenX-Ks.screenX,Yf=e.screenY-Ks.screenY):Yf=Kf=0,Ks=e),Kf)},movementY:function(e){return"movementY"in e?e.movementY:Yf}}),Ky=Zn(Gd),CR=pt({},Gd,{dataTransfer:0}),ER=Zn(CR),_R=pt({},hl,{relatedTarget:0}),Xf=Zn(_R),SR=pt({},Os,{animationName:0,elapsedTime:0,pseudoElement:0}),kR=Zn(SR),RR=pt({},Os,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),NR=Zn(RR),DR=pt({},Os,{data:0}),Yy=Zn(DR),IR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=PR[e])?!!t[e]:!1}function fm(){return AR}var MR=pt({},hl,{key:function(e){if(e.key){var t=IR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fm,charCode:function(e){return e.type==="keypress"?kc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),FR=Zn(MR),OR=pt({},Gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xy=Zn(OR),LR=pt({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fm}),BR=Zn(LR),jR=pt({},Os,{propertyName:0,elapsedTime:0,pseudoElement:0}),WR=Zn(jR),zR=pt({},Gd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$R=Zn(zR),UR=[9,13,27,32],hm=ko&&"CompositionEvent"in window,mu=null;ko&&"documentMode"in document&&(mu=document.documentMode);var VR=ko&&"TextEvent"in window&&!mu,Qw=ko&&(!hm||mu&&8<mu&&11>=mu),Qy=" ",Jy=!1;function Jw(e,t){switch(e){case"keyup":return UR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oi=!1;function HR(e,t){switch(e){case"compositionend":return Zw(t);case"keypress":return t.which!==32?null:(Jy=!0,Qy);case"textInput":return e=t.data,e===Qy&&Jy?null:e;default:return null}}function GR(e,t){if(Oi)return e==="compositionend"||!hm&&Jw(e,t)?(e=Xw(),Sc=cm=ra=null,Oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qw&&t.locale!=="ko"?null:t.data;default:return null}}var qR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qR[e.type]:t==="textarea"}function eb(e,t,n,r){Tw(r),t=qc(t,"onChange"),0<t.length&&(n=new dm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var gu=null,Ou=null;function KR(e){db(e,0)}function qd(e){var t=ji(e);if(_w(t))return e}function YR(e,t){if(e==="change")return t}var tb=!1;if(ko){var Qf;if(ko){var Jf="oninput"in document;if(!Jf){var e0=document.createElement("div");e0.setAttribute("oninput","return;"),Jf=typeof e0.oninput=="function"}Qf=Jf}else Qf=!1;tb=Qf&&(!document.documentMode||9<document.documentMode)}function t0(){gu&&(gu.detachEvent("onpropertychange",nb),Ou=gu=null)}function nb(e){if(e.propertyName==="value"&&qd(Ou)){var t=[];eb(t,Ou,e,am(e)),Fw(KR,t)}}function XR(e,t,n){e==="focusin"?(t0(),gu=t,Ou=n,gu.attachEvent("onpropertychange",nb)):e==="focusout"&&t0()}function QR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qd(Ou)}function JR(e,t){if(e==="click")return qd(t)}function ZR(e,t){if(e==="input"||e==="change")return qd(t)}function eN(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kr=typeof Object.is=="function"?Object.is:eN;function Lu(e,t){if(kr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ip.call(t,o)||!kr(e[o],t[o]))return!1}return!0}function n0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function r0(e,t){var n=n0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=n0(n)}}function rb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ob(){for(var e=window,t=Wc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Wc(e.document)}return t}function pm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tN(e){var t=ob(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&rb(n.ownerDocument.documentElement,n)){if(r!==null&&pm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=r.end===void 0?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=r0(n,a);var i=r0(n,r);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nN=ko&&"documentMode"in document&&11>=document.documentMode,Li=null,Sp=null,yu=null,kp=!1;function o0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;kp||Li==null||Li!==Wc(r)||(r=Li,"selectionStart"in r&&pm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yu&&Lu(yu,r)||(yu=r,r=qc(Sp,"onSelect"),0<r.length&&(t=new dm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Li)))}function Gl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bi={animationend:Gl("Animation","AnimationEnd"),animationiteration:Gl("Animation","AnimationIteration"),animationstart:Gl("Animation","AnimationStart"),transitionend:Gl("Transition","TransitionEnd")},Zf={},ab={};ko&&(ab=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function Kd(e){if(Zf[e])return Zf[e];if(!Bi[e])return e;var t=Bi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ab)return Zf[e]=t[n];return e}var ib=Kd("animationend"),sb=Kd("animationiteration"),ub=Kd("animationstart"),lb=Kd("transitionend"),cb=new Map,a0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ia(e,t){cb.set(e,t),fi(t,[e])}for(var eh=0;eh<a0.length;eh++){var th=a0[eh],rN=th.toLowerCase(),oN=th[0].toUpperCase()+th.slice(1);Ia(rN,"on"+oN)}Ia(ib,"onAnimationEnd");Ia(sb,"onAnimationIteration");Ia(ub,"onAnimationStart");Ia("dblclick","onDoubleClick");Ia("focusin","onFocus");Ia("focusout","onBlur");Ia(lb,"onTransitionEnd");ws("onMouseEnter",["mouseout","mouseover"]);ws("onMouseLeave",["mouseout","mouseover"]);ws("onPointerEnter",["pointerout","pointerover"]);ws("onPointerLeave",["pointerout","pointerover"]);fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fi("onBeforeInput",["compositionend","keypress","textInput","paste"]);fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aN=new Set("cancel close invalid load scroll toggle".split(" ").concat(fu));function i0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,rR(r,t,void 0,e),e.currentTarget=null}function db(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==a&&o.isPropagationStopped())break e;i0(o,s,l),a=u}else for(i=0;i<r.length;i++){if(s=r[i],u=s.instance,l=s.currentTarget,s=s.listener,u!==a&&o.isPropagationStopped())break e;i0(o,s,l),a=u}}}if($c)throw e=bp,$c=!1,bp=null,e}function at(e,t){var n=t[Tp];n===void 0&&(n=t[Tp]=new Set);var r=e+"__bubble";n.has(r)||(fb(t,e,2,!1),n.add(r))}function nh(e,t,n){var r=0;t&&(r|=4),fb(n,e,r,t)}var ql="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[ql]){e[ql]=!0,xw.forEach(function(n){n!=="selectionchange"&&(aN.has(n)||nh(n,!1,e),nh(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ql]||(t[ql]=!0,nh("selectionchange",!1,t))}}function fb(e,t,n,r){switch(Yw(t)){case 1:var o=xR;break;case 4:o=wR;break;default:o=lm}n=o.bind(null,t,n,e),o=void 0,!wp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function rh(e,t,n,r,o){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;i=i.return}for(;s!==null;){if(i=Ua(s),i===null)return;if(u=i.tag,u===5||u===6){r=a=i;continue e}s=s.parentNode}}r=r.return}Fw(function(){var l=a,c=am(n),d=[];e:{var f=cb.get(e);if(f!==void 0){var h=dm,p=e;switch(e){case"keypress":if(kc(n)===0)break e;case"keydown":case"keyup":h=FR;break;case"focusin":p="focus",h=Xf;break;case"focusout":p="blur",h=Xf;break;case"beforeblur":case"afterblur":h=Xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Ky;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ER;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=BR;break;case ib:case sb:case ub:h=kR;break;case lb:h=WR;break;case"scroll":h=bR;break;case"wheel":h=$R;break;case"copy":case"cut":case"paste":h=NR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Xy}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var y=l,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=Pu(y,v),w!=null&&m.push(ju(y,w,x)))),g)break;y=y.return}0<m.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==yp&&(p=n.relatedTarget||n.fromElement)&&(Ua(p)||p[Ro]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Ua(p):null,p!==null&&(g=hi(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=Ky,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Xy,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=h==null?f:ji(h),x=p==null?f:ji(p),f=new m(w,y+"leave",h,n,c),f.target=g,f.relatedTarget=x,w=null,Ua(c)===l&&(m=new m(v,y+"enter",p,n,c),m.target=x,m.relatedTarget=g,w=m),g=w,h&&p)t:{for(m=h,v=p,y=0,x=m;x;x=Ci(x))y++;for(x=0,w=v;w;w=Ci(w))x++;for(;0<y-x;)m=Ci(m),y--;for(;0<x-y;)v=Ci(v),x--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ci(m),v=Ci(v)}m=null}else m=null;h!==null&&s0(d,f,h,m,!1),p!==null&&g!==null&&s0(d,g,p,m,!0)}}e:{if(f=l?ji(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=YR;else if(Zy(f))if(tb)b=ZR;else{b=QR;var E=XR}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=JR);if(b&&(b=b(e,l))){eb(d,b,n,c);break e}E&&E(e,f,l),e==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&hp(f,"number",f.value)}switch(E=l?ji(l):window,e){case"focusin":(Zy(E)||E.contentEditable==="true")&&(Li=E,Sp=l,yu=null);break;case"focusout":yu=Sp=Li=null;break;case"mousedown":kp=!0;break;case"contextmenu":case"mouseup":case"dragend":kp=!1,o0(d,n,c);break;case"selectionchange":if(nN)break;case"keydown":case"keyup":o0(d,n,c)}var S;if(hm)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Oi?Jw(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Qw&&n.locale!=="ko"&&(Oi||_!=="onCompositionStart"?_==="onCompositionEnd"&&Oi&&(S=Xw()):(ra=c,cm="value"in ra?ra.value:ra.textContent,Oi=!0)),E=qc(l,_),0<E.length&&(_=new Yy(_,e,null,n,c),d.push({event:_,listeners:E}),S?_.data=S:(S=Zw(n),S!==null&&(_.data=S)))),(S=VR?HR(e,n):GR(e,n))&&(l=qc(l,"onBeforeInput"),0<l.length&&(c=new Yy("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=S))}db(d,t)})}function ju(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qc(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=Pu(e,n),a!=null&&r.unshift(ju(e,a,o)),a=Pu(e,t),a!=null&&r.push(ju(e,a,o))),e=e.return}return r}function Ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function s0(e,t,n,r,o){for(var a=t._reactName,i=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=Pu(n,a),u!=null&&i.unshift(ju(n,u,s))):o||(u=Pu(n,a),u!=null&&i.push(ju(n,u,s)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var iN=/\r\n?/g,sN=/\u0000|\uFFFD/g;function u0(e){return(typeof e=="string"?e:""+e).replace(iN,`
`).replace(sN,"")}function Kl(e,t,n){if(t=u0(t),u0(e)!==t&&n)throw Error(ne(425))}function Kc(){}var Rp=null,Np=null;function Dp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ip=typeof setTimeout=="function"?setTimeout:void 0,uN=typeof clearTimeout=="function"?clearTimeout:void 0,l0=typeof Promise=="function"?Promise:void 0,lN=typeof queueMicrotask=="function"?queueMicrotask:typeof l0<"u"?function(e){return l0.resolve(null).then(e).catch(cN)}:Ip;function cN(e){setTimeout(function(){throw e})}function oh(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),Fu(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Fu(t)}function ha(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function c0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ls=Math.random().toString(36).slice(2),Gr="__reactFiber$"+Ls,Wu="__reactProps$"+Ls,Ro="__reactContainer$"+Ls,Tp="__reactEvents$"+Ls,dN="__reactListeners$"+Ls,fN="__reactHandles$"+Ls;function Ua(e){var t=e[Gr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ro]||n[Gr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=c0(e);e!==null;){if(n=e[Gr])return n;e=c0(e)}return t}e=n,n=e.parentNode}return null}function pl(e){return e=e[Gr]||e[Ro],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ji(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function Yd(e){return e[Wu]||null}var Pp=[],Wi=-1;function Ta(e){return{current:e}}function ut(e){0>Wi||(e.current=Pp[Wi],Pp[Wi]=null,Wi--)}function Ze(e,t){Wi++,Pp[Wi]=e.current,e.current=t}var Ca={},ln=Ta(Ca),Nn=Ta(!1),ri=Ca;function bs(e,t){var n=e.type.contextTypes;if(!n)return Ca;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Dn(e){return e=e.childContextTypes,e!=null}function Yc(){ut(Nn),ut(ln)}function d0(e,t,n){if(ln.current!==Ca)throw Error(ne(168));Ze(ln,t),Ze(Nn,n)}function hb(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(ne(108,Xk(e)||"Unknown",o));return pt({},n,r)}function Xc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ca,ri=ln.current,Ze(ln,e),Ze(Nn,Nn.current),!0}function f0(e,t,n){var r=e.stateNode;if(!r)throw Error(ne(169));n?(e=hb(e,t,ri),r.__reactInternalMemoizedMergedChildContext=e,ut(Nn),ut(ln),Ze(ln,e)):ut(Nn),Ze(Nn,n)}var bo=null,Xd=!1,ah=!1;function pb(e){bo===null?bo=[e]:bo.push(e)}function hN(e){Xd=!0,pb(e)}function Pa(){if(!ah&&bo!==null){ah=!0;var e=0,t=Xe;try{var n=bo;for(Xe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}bo=null,Xd=!1}catch(o){throw bo!==null&&(bo=bo.slice(e+1)),jw(im,Pa),o}finally{Xe=t,ah=!1}}return null}var zi=[],$i=0,Qc=null,Jc=0,tr=[],nr=0,oi=null,Eo=1,_o="";function La(e,t){zi[$i++]=Jc,zi[$i++]=Qc,Qc=e,Jc=t}function vb(e,t,n){tr[nr++]=Eo,tr[nr++]=_o,tr[nr++]=oi,oi=e;var r=Eo;e=_o;var o=32-Er(r)-1;r&=~(1<<o),n+=1;var a=32-Er(t)+o;if(30<a){var i=o-o%5;a=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Eo=1<<32-Er(t)+o|n<<o|r,_o=a+e}else Eo=1<<a|n<<o|r,_o=e}function vm(e){e.return!==null&&(La(e,1),vb(e,1,0))}function mm(e){for(;e===Qc;)Qc=zi[--$i],zi[$i]=null,Jc=zi[--$i],zi[$i]=null;for(;e===oi;)oi=tr[--nr],tr[nr]=null,_o=tr[--nr],tr[nr]=null,Eo=tr[--nr],tr[nr]=null}var Gn=null,$n=null,lt=!1,yr=null;function mb(e,t){var n=ar(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function h0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gn=e,$n=ha(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gn=e,$n=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=oi!==null?{id:Eo,overflow:_o}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ar(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gn=e,$n=null,!0):!1;default:return!1}}function Ap(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mp(e){if(lt){var t=$n;if(t){var n=t;if(!h0(e,t)){if(Ap(e))throw Error(ne(418));t=ha(n.nextSibling);var r=Gn;t&&h0(e,t)?mb(r,n):(e.flags=e.flags&-4097|2,lt=!1,Gn=e)}}else{if(Ap(e))throw Error(ne(418));e.flags=e.flags&-4097|2,lt=!1,Gn=e}}}function p0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gn=e}function Yl(e){if(e!==Gn)return!1;if(!lt)return p0(e),lt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Dp(e.type,e.memoizedProps)),t&&(t=$n)){if(Ap(e))throw gb(),Error(ne(418));for(;t;)mb(e,t),t=ha(t.nextSibling)}if(p0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$n=ha(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$n=null}}else $n=Gn?ha(e.stateNode.nextSibling):null;return!0}function gb(){for(var e=$n;e;)e=ha(e.nextSibling)}function Cs(){$n=Gn=null,lt=!1}function gm(e){yr===null?yr=[e]:yr.push(e)}var pN=Po.ReactCurrentBatchConfig;function Ys(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,e));var o=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var s=o.refs;i===null?delete s[a]:s[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,e))}return e}function Xl(e,t){throw e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function v0(e){var t=e._init;return t(e._payload)}function yb(e){function t(v,y){if(e){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function o(v,y){return v=ga(v,y),v.index=0,v.sibling=null,v}function a(v,y,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function s(v,y,x,w){return y===null||y.tag!==6?(y=fh(x,v.mode,w),y.return=v,y):(y=o(y,x),y.return=v,y)}function u(v,y,x,w){var b=x.type;return b===Fi?c(v,y,x.props.children,w,x.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===qo&&v0(b)===y.type)?(w=o(y,x.props),w.ref=Ys(v,y,x),w.return=v,w):(w=Ac(x.type,x.key,x.props,null,v.mode,w),w.ref=Ys(v,y,x),w.return=v,w)}function l(v,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=hh(x,v.mode,w),y.return=v,y):(y=o(y,x.children||[]),y.return=v,y)}function c(v,y,x,w,b){return y===null||y.tag!==7?(y=ei(x,v.mode,w,b),y.return=v,y):(y=o(y,x),y.return=v,y)}function d(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fh(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case jl:return x=Ac(y.type,y.key,y.props,null,v.mode,x),x.ref=Ys(v,null,y),x.return=v,x;case Mi:return y=hh(y,v.mode,x),y.return=v,y;case qo:var w=y._init;return d(v,w(y._payload),x)}if(cu(y)||Vs(y))return y=ei(y,v.mode,x,null),y.return=v,y;Xl(v,y)}return null}function f(v,y,x,w){var b=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:s(v,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case jl:return x.key===b?u(v,y,x,w):null;case Mi:return x.key===b?l(v,y,x,w):null;case qo:return b=x._init,f(v,y,b(x._payload),w)}if(cu(x)||Vs(x))return b!==null?null:c(v,y,x,w,null);Xl(v,x)}return null}function h(v,y,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,s(y,v,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case jl:return v=v.get(w.key===null?x:w.key)||null,u(y,v,w,b);case Mi:return v=v.get(w.key===null?x:w.key)||null,l(y,v,w,b);case qo:var E=w._init;return h(v,y,x,E(w._payload),b)}if(cu(w)||Vs(w))return v=v.get(x)||null,c(y,v,w,b,null);Xl(y,w)}return null}function p(v,y,x,w){for(var b=null,E=null,S=y,_=y=0,k=null;S!==null&&_<x.length;_++){S.index>_?(k=S,S=null):k=S.sibling;var N=f(v,S,x[_],w);if(N===null){S===null&&(S=k);break}e&&S&&N.alternate===null&&t(v,S),y=a(N,y,_),E===null?b=N:E.sibling=N,E=N,S=k}if(_===x.length)return n(v,S),lt&&La(v,_),b;if(S===null){for(;_<x.length;_++)S=d(v,x[_],w),S!==null&&(y=a(S,y,_),E===null?b=S:E.sibling=S,E=S);return lt&&La(v,_),b}for(S=r(v,S);_<x.length;_++)k=h(S,v,_,x[_],w),k!==null&&(e&&k.alternate!==null&&S.delete(k.key===null?_:k.key),y=a(k,y,_),E===null?b=k:E.sibling=k,E=k);return e&&S.forEach(function(A){return t(v,A)}),lt&&La(v,_),b}function m(v,y,x,w){var b=Vs(x);if(typeof b!="function")throw Error(ne(150));if(x=b.call(x),x==null)throw Error(ne(151));for(var E=b=null,S=y,_=y=0,k=null,N=x.next();S!==null&&!N.done;_++,N=x.next()){S.index>_?(k=S,S=null):k=S.sibling;var A=f(v,S,N.value,w);if(A===null){S===null&&(S=k);break}e&&S&&A.alternate===null&&t(v,S),y=a(A,y,_),E===null?b=A:E.sibling=A,E=A,S=k}if(N.done)return n(v,S),lt&&La(v,_),b;if(S===null){for(;!N.done;_++,N=x.next())N=d(v,N.value,w),N!==null&&(y=a(N,y,_),E===null?b=N:E.sibling=N,E=N);return lt&&La(v,_),b}for(S=r(v,S);!N.done;_++,N=x.next())N=h(S,v,_,N.value,w),N!==null&&(e&&N.alternate!==null&&S.delete(N.key===null?_:N.key),y=a(N,y,_),E===null?b=N:E.sibling=N,E=N);return e&&S.forEach(function(T){return t(v,T)}),lt&&La(v,_),b}function g(v,y,x,w){if(typeof x=="object"&&x!==null&&x.type===Fi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case jl:e:{for(var b=x.key,E=y;E!==null;){if(E.key===b){if(b=x.type,b===Fi){if(E.tag===7){n(v,E.sibling),y=o(E,x.props.children),y.return=v,v=y;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===qo&&v0(b)===E.type){n(v,E.sibling),y=o(E,x.props),y.ref=Ys(v,E,x),y.return=v,v=y;break e}n(v,E);break}else t(v,E);E=E.sibling}x.type===Fi?(y=ei(x.props.children,v.mode,w,x.key),y.return=v,v=y):(w=Ac(x.type,x.key,x.props,null,v.mode,w),w.ref=Ys(v,y,x),w.return=v,v=w)}return i(v);case Mi:e:{for(E=x.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(v,y.sibling),y=o(y,x.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=hh(x,v.mode,w),y.return=v,v=y}return i(v);case qo:return E=x._init,g(v,y,E(x._payload),w)}if(cu(x))return p(v,y,x,w);if(Vs(x))return m(v,y,x,w);Xl(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(v,y.sibling),y=o(y,x),y.return=v,v=y):(n(v,y),y=fh(x,v.mode,w),y.return=v,v=y),i(v)):n(v,y)}return g}var Es=yb(!0),xb=yb(!1),Zc=Ta(null),ed=null,Ui=null,ym=null;function xm(){ym=Ui=ed=null}function wm(e){var t=Zc.current;ut(Zc),e._currentValue=t}function Fp(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Qi(e,t){ed=e,ym=Ui=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(kn=!0),e.firstContext=null)}function ur(e){var t=e._currentValue;if(ym!==e)if(e={context:e,memoizedValue:t,next:null},Ui===null){if(ed===null)throw Error(ne(308));Ui=e,ed.dependencies={lanes:0,firstContext:e}}else Ui=Ui.next=e;return t}var Va=null;function bm(e){Va===null?Va=[e]:Va.push(e)}function wb(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,bm(t)):(n.next=o.next,o.next=n),t.interleaved=n,No(e,r)}function No(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ko=!1;function Cm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bb(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function So(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pa(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,$e&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,No(e,n)}return o=r.interleaved,o===null?(t.next=t,bm(r)):(t.next=o.next,o.next=t),r.interleaved=t,No(e,n)}function Rc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,sm(e,n)}}function m0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=i:a=a.next=i,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function td(e,t,n,r){var o=e.updateQueue;Ko=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,i===null?a=l:i.next=l,i=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==i&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(a!==null){var d=o.baseState;i=0,c=l=u=null,s=a;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(f=t,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=pt({},d,f);break e;case 2:Ko=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,i|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(u=d),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do i|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);ii|=i,e.lanes=i,e.memoizedState=d}}function g0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ne(191,o));o.call(r)}}}var vl={},Zr=Ta(vl),zu=Ta(vl),$u=Ta(vl);function Ha(e){if(e===vl)throw Error(ne(174));return e}function Em(e,t){switch(Ze($u,t),Ze(zu,e),Ze(Zr,vl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vp(t,e)}ut(Zr),Ze(Zr,t)}function _s(){ut(Zr),ut(zu),ut($u)}function Cb(e){Ha($u.current);var t=Ha(Zr.current),n=vp(t,e.type);t!==n&&(Ze(zu,e),Ze(Zr,n))}function _m(e){zu.current===e&&(ut(Zr),ut(zu))}var ct=Ta(0);function nd(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ih=[];function Sm(){for(var e=0;e<ih.length;e++)ih[e]._workInProgressVersionPrimary=null;ih.length=0}var Nc=Po.ReactCurrentDispatcher,sh=Po.ReactCurrentBatchConfig,ai=0,ht=null,Tt=null,jt=null,rd=!1,xu=!1,Uu=0,vN=0;function Jt(){throw Error(ne(321))}function km(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!kr(e[n],t[n]))return!1;return!0}function Rm(e,t,n,r,o,a){if(ai=a,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nc.current=e===null||e.memoizedState===null?xN:wN,e=n(r,o),xu){a=0;do{if(xu=!1,Uu=0,25<=a)throw Error(ne(301));a+=1,jt=Tt=null,t.updateQueue=null,Nc.current=bN,e=n(r,o)}while(xu)}if(Nc.current=od,t=Tt!==null&&Tt.next!==null,ai=0,jt=Tt=ht=null,rd=!1,t)throw Error(ne(300));return e}function Nm(){var e=Uu!==0;return Uu=0,e}function jr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?ht.memoizedState=jt=e:jt=jt.next=e,jt}function lr(){if(Tt===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var t=jt===null?ht.memoizedState:jt.next;if(t!==null)jt=t,Tt=e;else{if(e===null)throw Error(ne(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},jt===null?ht.memoizedState=jt=e:jt=jt.next=e}return jt}function Vu(e,t){return typeof t=="function"?t(e):t}function uh(e){var t=lr(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=Tt,o=r.baseQueue,a=n.pending;if(a!==null){if(o!==null){var i=o.next;o.next=a.next,a.next=i}r.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,r=r.baseState;var s=i=null,u=null,l=a;do{var c=l.lane;if((ai&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,i=r):u=u.next=d,ht.lanes|=c,ii|=c}l=l.next}while(l!==null&&l!==a);u===null?i=r:u.next=s,kr(r,t.memoizedState)||(kn=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do a=o.lane,ht.lanes|=a,ii|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function lh(e){var t=lr(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do a=e(a,i.action),i=i.next;while(i!==o);kr(a,t.memoizedState)||(kn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Eb(){}function _b(e,t){var n=ht,r=lr(),o=t(),a=!kr(r.memoizedState,o);if(a&&(r.memoizedState=o,kn=!0),r=r.queue,Dm(Rb.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,Hu(9,kb.bind(null,n,r,o,t),void 0,null),Wt===null)throw Error(ne(349));ai&30||Sb(n,t,o)}return o}function Sb(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function kb(e,t,n,r){t.value=n,t.getSnapshot=r,Nb(t)&&Db(e)}function Rb(e,t,n){return n(function(){Nb(t)&&Db(e)})}function Nb(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kr(e,n)}catch{return!0}}function Db(e){var t=No(e,1);t!==null&&_r(t,e,1,-1)}function y0(e){var t=jr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vu,lastRenderedState:e},t.queue=e,e=e.dispatch=yN.bind(null,ht,e),[t.memoizedState,e]}function Hu(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Ib(){return lr().memoizedState}function Dc(e,t,n,r){var o=jr();ht.flags|=e,o.memoizedState=Hu(1|t,n,void 0,r===void 0?null:r)}function Qd(e,t,n,r){var o=lr();r=r===void 0?null:r;var a=void 0;if(Tt!==null){var i=Tt.memoizedState;if(a=i.destroy,r!==null&&km(r,i.deps)){o.memoizedState=Hu(t,n,a,r);return}}ht.flags|=e,o.memoizedState=Hu(1|t,n,a,r)}function x0(e,t){return Dc(8390656,8,e,t)}function Dm(e,t){return Qd(2048,8,e,t)}function Tb(e,t){return Qd(4,2,e,t)}function Pb(e,t){return Qd(4,4,e,t)}function Ab(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Mb(e,t,n){return n=n!=null?n.concat([e]):null,Qd(4,4,Ab.bind(null,t,e),n)}function Im(){}function Fb(e,t){var n=lr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&km(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ob(e,t){var n=lr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&km(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Lb(e,t,n){return ai&21?(kr(n,t)||(n=$w(),ht.lanes|=n,ii|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,kn=!0),e.memoizedState=n)}function mN(e,t){var n=Xe;Xe=n!==0&&4>n?n:4,e(!0);var r=sh.transition;sh.transition={};try{e(!1),t()}finally{Xe=n,sh.transition=r}}function Bb(){return lr().memoizedState}function gN(e,t,n){var r=ma(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jb(e))Wb(t,n);else if(n=wb(e,t,n,r),n!==null){var o=yn();_r(n,e,r,o),zb(n,t,r)}}function yN(e,t,n){var r=ma(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jb(e))Wb(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,s=a(i,n);if(o.hasEagerState=!0,o.eagerState=s,kr(s,i)){var u=t.interleaved;u===null?(o.next=o,bm(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=wb(e,t,o,r),n!==null&&(o=yn(),_r(n,e,r,o),zb(n,t,r))}}function jb(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function Wb(e,t){xu=rd=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zb(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,sm(e,n)}}var od={readContext:ur,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},xN={readContext:ur,useCallback:function(e,t){return jr().memoizedState=[e,t===void 0?null:t],e},useContext:ur,useEffect:x0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Dc(4194308,4,Ab.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dc(4,2,e,t)},useMemo:function(e,t){var n=jr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=jr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=gN.bind(null,ht,e),[r.memoizedState,e]},useRef:function(e){var t=jr();return e={current:e},t.memoizedState=e},useState:y0,useDebugValue:Im,useDeferredValue:function(e){return jr().memoizedState=e},useTransition:function(){var e=y0(!1),t=e[0];return e=mN.bind(null,e[1]),jr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ht,o=jr();if(lt){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),Wt===null)throw Error(ne(349));ai&30||Sb(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,x0(Rb.bind(null,r,a,e),[e]),r.flags|=2048,Hu(9,kb.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=jr(),t=Wt.identifierPrefix;if(lt){var n=_o,r=Eo;n=(r&~(1<<32-Er(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Uu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=vN++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wN={readContext:ur,useCallback:Fb,useContext:ur,useEffect:Dm,useImperativeHandle:Mb,useInsertionEffect:Tb,useLayoutEffect:Pb,useMemo:Ob,useReducer:uh,useRef:Ib,useState:function(){return uh(Vu)},useDebugValue:Im,useDeferredValue:function(e){var t=lr();return Lb(t,Tt.memoizedState,e)},useTransition:function(){var e=uh(Vu)[0],t=lr().memoizedState;return[e,t]},useMutableSource:Eb,useSyncExternalStore:_b,useId:Bb,unstable_isNewReconciler:!1},bN={readContext:ur,useCallback:Fb,useContext:ur,useEffect:Dm,useImperativeHandle:Mb,useInsertionEffect:Tb,useLayoutEffect:Pb,useMemo:Ob,useReducer:lh,useRef:Ib,useState:function(){return lh(Vu)},useDebugValue:Im,useDeferredValue:function(e){var t=lr();return Tt===null?t.memoizedState=e:Lb(t,Tt.memoizedState,e)},useTransition:function(){var e=lh(Vu)[0],t=lr().memoizedState;return[e,t]},useMutableSource:Eb,useSyncExternalStore:_b,useId:Bb,unstable_isNewReconciler:!1};function pr(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Op(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:pt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Jd={isMounted:function(e){return(e=e._reactInternals)?hi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=yn(),o=ma(e),a=So(r,o);a.payload=t,n!=null&&(a.callback=n),t=pa(e,a,o),t!==null&&(_r(t,e,o,r),Rc(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=yn(),o=ma(e),a=So(r,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=pa(e,a,o),t!==null&&(_r(t,e,o,r),Rc(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=yn(),r=ma(e),o=So(n,r);o.tag=2,t!=null&&(o.callback=t),t=pa(e,o,r),t!==null&&(_r(t,e,r,n),Rc(t,e,r))}};function w0(e,t,n,r,o,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,i):t.prototype&&t.prototype.isPureReactComponent?!Lu(n,r)||!Lu(o,a):!0}function $b(e,t,n){var r=!1,o=Ca,a=t.contextType;return typeof a=="object"&&a!==null?a=ur(a):(o=Dn(t)?ri:ln.current,r=t.contextTypes,a=(r=r!=null)?bs(e,o):Ca),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Jd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function b0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Jd.enqueueReplaceState(t,t.state,null)}function Lp(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Cm(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=ur(a):(a=Dn(t)?ri:ln.current,o.context=bs(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Op(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Jd.enqueueReplaceState(o,o.state,null),td(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ss(e,t){try{var n="",r=t;do n+=Yk(r),r=r.return;while(r);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function ch(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Bp(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var CN=typeof WeakMap=="function"?WeakMap:Map;function Ub(e,t,n){n=So(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){id||(id=!0,Kp=r),Bp(e,t)},n}function Vb(e,t,n){n=So(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Bp(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Bp(e,t),typeof r!="function"&&(va===null?va=new Set([this]):va.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function C0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new CN;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=ON.bind(null,e,t,n),t.then(e,e))}function E0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _0(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=So(-1,1),t.tag=2,pa(n,t,1))),n.lanes|=1),e)}var EN=Po.ReactCurrentOwner,kn=!1;function hn(e,t,n,r){t.child=e===null?xb(t,null,n,r):Es(t,e.child,n,r)}function S0(e,t,n,r,o){n=n.render;var a=t.ref;return Qi(t,o),r=Rm(e,t,n,r,a,o),n=Nm(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Do(e,t,o)):(lt&&n&&vm(t),t.flags|=1,hn(e,t,r,o),t.child)}function k0(e,t,n,r,o){if(e===null){var a=n.type;return typeof a=="function"&&!Bm(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Hb(e,t,a,r,o)):(e=Ac(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var i=a.memoizedProps;if(n=n.compare,n=n!==null?n:Lu,n(i,r)&&e.ref===t.ref)return Do(e,t,o)}return t.flags|=1,e=ga(a,r),e.ref=t.ref,e.return=t,t.child=e}function Hb(e,t,n,r,o){if(e!==null){var a=e.memoizedProps;if(Lu(a,r)&&e.ref===t.ref)if(kn=!1,t.pendingProps=r=a,(e.lanes&o)!==0)e.flags&131072&&(kn=!0);else return t.lanes=e.lanes,Do(e,t,o)}return jp(e,t,n,r,o)}function Gb(e,t,n){var r=t.pendingProps,o=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Hi,Bn),Bn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ze(Hi,Bn),Bn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Ze(Hi,Bn),Bn|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ze(Hi,Bn),Bn|=r;return hn(e,t,o,n),t.child}function qb(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function jp(e,t,n,r,o){var a=Dn(n)?ri:ln.current;return a=bs(t,a),Qi(t,o),n=Rm(e,t,n,r,a,o),r=Nm(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Do(e,t,o)):(lt&&r&&vm(t),t.flags|=1,hn(e,t,n,o),t.child)}function R0(e,t,n,r,o){if(Dn(n)){var a=!0;Xc(t)}else a=!1;if(Qi(t,o),t.stateNode===null)Ic(e,t),$b(t,n,r),Lp(t,n,r,o),r=!0;else if(e===null){var i=t.stateNode,s=t.memoizedProps;i.props=s;var u=i.context,l=n.contextType;typeof l=="object"&&l!==null?l=ur(l):(l=Dn(n)?ri:ln.current,l=bs(t,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==r||u!==l)&&b0(t,i,r,l),Ko=!1;var f=t.memoizedState;i.state=f,td(t,r,i,o),u=t.memoizedState,s!==r||f!==u||Nn.current||Ko?(typeof c=="function"&&(Op(t,n,c,r),u=t.memoizedState),(s=Ko||w0(t,n,s,r,f,u,l))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),i.props=r,i.state=u,i.context=l,r=s):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,bb(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:pr(t.type,s),i.props=l,d=t.pendingProps,f=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=ur(u):(u=Dn(n)?ri:ln.current,u=bs(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==d||f!==u)&&b0(t,i,r,u),Ko=!1,f=t.memoizedState,i.state=f,td(t,r,i,o);var p=t.memoizedState;s!==d||f!==p||Nn.current||Ko?(typeof h=="function"&&(Op(t,n,h,r),p=t.memoizedState),(l=Ko||w0(t,n,l,r,f,p,u)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),i.props=r,i.state=p,i.context=u,r=l):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Wp(e,t,n,r,a,o)}function Wp(e,t,n,r,o,a){qb(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return o&&f0(t,n,!1),Do(e,t,a);r=t.stateNode,EN.current=t;var s=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Es(t,e.child,null,a),t.child=Es(t,null,s,a)):hn(e,t,s,a),t.memoizedState=r.state,o&&f0(t,n,!0),t.child}function Kb(e){var t=e.stateNode;t.pendingContext?d0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&d0(e,t.context,!1),Em(e,t.containerInfo)}function N0(e,t,n,r,o){return Cs(),gm(o),t.flags|=256,hn(e,t,n,r),t.child}var zp={dehydrated:null,treeContext:null,retryLane:0};function $p(e){return{baseLanes:e,cachePool:null,transitions:null}}function Yb(e,t,n){var r=t.pendingProps,o=ct.current,a=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ze(ct,o&1),e===null)return Mp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,a?(r=t.mode,a=t.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=tf(i,r,0,null),e=ei(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$p(n),t.memoizedState=zp,e):Tm(t,i));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return _N(e,t,i,r,s,o,n);if(a){a=r.fallback,i=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=ga(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?a=ga(s,a):(a=ei(a,i,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,i=e.child.memoizedState,i=i===null?$p(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~n,t.memoizedState=zp,r}return a=e.child,e=a.sibling,r=ga(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Tm(e,t){return t=tf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ql(e,t,n,r){return r!==null&&gm(r),Es(t,e.child,null,n),e=Tm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _N(e,t,n,r,o,a,i){if(n)return t.flags&256?(t.flags&=-257,r=ch(Error(ne(422))),Ql(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=tf({mode:"visible",children:r.children},o,0,null),a=ei(a,o,i,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&Es(t,e.child,null,i),t.child.memoizedState=$p(i),t.memoizedState=zp,a);if(!(t.mode&1))return Ql(e,t,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(ne(419)),r=ch(a,r,void 0),Ql(e,t,i,r)}if(s=(i&e.childLanes)!==0,kn||s){if(r=Wt,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,No(e,o),_r(r,e,o,-1))}return Lm(),r=ch(Error(ne(421))),Ql(e,t,i,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=LN.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,$n=ha(o.nextSibling),Gn=t,lt=!0,yr=null,e!==null&&(tr[nr++]=Eo,tr[nr++]=_o,tr[nr++]=oi,Eo=e.id,_o=e.overflow,oi=t),t=Tm(t,r.children),t.flags|=4096,t)}function D0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Fp(e.return,t,n)}function dh(e,t,n,r,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function Xb(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(hn(e,t,r.children,n),r=ct.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&D0(e,n,t);else if(e.tag===19)D0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ze(ct,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&nd(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),dh(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&nd(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}dh(t,!0,n,null,a);break;case"together":dh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ic(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Do(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ii|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=ga(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ga(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function SN(e,t,n){switch(t.tag){case 3:Kb(t),Cs();break;case 5:Cb(t);break;case 1:Dn(t.type)&&Xc(t);break;case 4:Em(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ze(Zc,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ze(ct,ct.current&1),t.flags|=128,null):n&t.child.childLanes?Yb(e,t,n):(Ze(ct,ct.current&1),e=Do(e,t,n),e!==null?e.sibling:null);Ze(ct,ct.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Xb(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ze(ct,ct.current),r)break;return null;case 22:case 23:return t.lanes=0,Gb(e,t,n)}return Do(e,t,n)}var Qb,Up,Jb,Zb;Qb=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Up=function(){};Jb=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Ha(Zr.current);var a=null;switch(n){case"input":o=dp(e,o),r=dp(e,r),a=[];break;case"select":o=pt({},o,{value:void 0}),r=pt({},r,{value:void 0}),a=[];break;case"textarea":o=pp(e,o),r=pp(e,r),a=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Kc)}mp(n,r);var i;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Iu.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(i in s)!s.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&s[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(a||(a=[]),a.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(a=a||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Iu.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&at("scroll",e),a||s===u||(a=[])):(a=a||[]).push(l,u))}n&&(a=a||[]).push("style",n);var l=a;(t.updateQueue=l)&&(t.flags|=4)}};Zb=function(e,t,n,r){n!==r&&(t.flags|=4)};function Xs(e,t){if(!lt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function kN(e,t,n){var r=t.pendingProps;switch(mm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(t),null;case 1:return Dn(t.type)&&Yc(),Zt(t),null;case 3:return r=t.stateNode,_s(),ut(Nn),ut(ln),Sm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Yl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yr!==null&&(Qp(yr),yr=null))),Up(e,t),Zt(t),null;case 5:_m(t);var o=Ha($u.current);if(n=t.type,e!==null&&t.stateNode!=null)Jb(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ne(166));return Zt(t),null}if(e=Ha(Zr.current),Yl(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Gr]=t,r[Wu]=a,e=(t.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(o=0;o<fu.length;o++)at(fu[o],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":By(r,a),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},at("invalid",r);break;case"textarea":Wy(r,a),at("invalid",r)}mp(n,a),o=null;for(var i in a)if(a.hasOwnProperty(i)){var s=a[i];i==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&Kl(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&Kl(r.textContent,s,e),o=["children",""+s]):Iu.hasOwnProperty(i)&&s!=null&&i==="onScroll"&&at("scroll",r)}switch(n){case"input":Wl(r),jy(r,a,!0);break;case"textarea":Wl(r),zy(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Kc)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rw(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Gr]=t,e[Wu]=r,Qb(e,t,!1,!1),t.stateNode=e;e:{switch(i=gp(n,r),n){case"dialog":at("cancel",e),at("close",e),o=r;break;case"iframe":case"object":case"embed":at("load",e),o=r;break;case"video":case"audio":for(o=0;o<fu.length;o++)at(fu[o],e);o=r;break;case"source":at("error",e),o=r;break;case"img":case"image":case"link":at("error",e),at("load",e),o=r;break;case"details":at("toggle",e),o=r;break;case"input":By(e,r),o=dp(e,r),at("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=pt({},r,{value:void 0}),at("invalid",e);break;case"textarea":Wy(e,r),o=pp(e,r),at("invalid",e);break;default:o=r}mp(n,o),s=o;for(a in s)if(s.hasOwnProperty(a)){var u=s[a];a==="style"?Iw(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Nw(e,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Tu(e,u):typeof u=="number"&&Tu(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Iu.hasOwnProperty(a)?u!=null&&a==="onScroll"&&at("scroll",e):u!=null&&tm(e,a,u,i))}switch(n){case"input":Wl(e),jy(e,r,!1);break;case"textarea":Wl(e),zy(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ba(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?qi(e,!!r.multiple,a,!1):r.defaultValue!=null&&qi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Kc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Zt(t),null;case 6:if(e&&t.stateNode!=null)Zb(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ne(166));if(n=Ha($u.current),Ha(Zr.current),Yl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gr]=t,(a=r.nodeValue!==n)&&(e=Gn,e!==null))switch(e.tag){case 3:Kl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Kl(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gr]=t,t.stateNode=r}return Zt(t),null;case 13:if(ut(ct),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(lt&&$n!==null&&t.mode&1&&!(t.flags&128))gb(),Cs(),t.flags|=98560,a=!1;else if(a=Yl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(ne(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ne(317));a[Gr]=t}else Cs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Zt(t),a=!1}else yr!==null&&(Qp(yr),yr=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ct.current&1?Pt===0&&(Pt=3):Lm())),t.updateQueue!==null&&(t.flags|=4),Zt(t),null);case 4:return _s(),Up(e,t),e===null&&Bu(t.stateNode.containerInfo),Zt(t),null;case 10:return wm(t.type._context),Zt(t),null;case 17:return Dn(t.type)&&Yc(),Zt(t),null;case 19:if(ut(ct),a=t.memoizedState,a===null)return Zt(t),null;if(r=(t.flags&128)!==0,i=a.rendering,i===null)if(r)Xs(a,!1);else{if(Pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=nd(e),i!==null){for(t.flags|=128,Xs(a,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ze(ct,ct.current&1|2),t.child}e=e.sibling}a.tail!==null&&xt()>ks&&(t.flags|=128,r=!0,Xs(a,!1),t.lanes=4194304)}else{if(!r)if(e=nd(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Xs(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!lt)return Zt(t),null}else 2*xt()-a.renderingStartTime>ks&&n!==1073741824&&(t.flags|=128,r=!0,Xs(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(n=a.last,n!==null?n.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=xt(),t.sibling=null,n=ct.current,Ze(ct,r?n&1|2:n&1),t):(Zt(t),null);case 22:case 23:return Om(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Bn&1073741824&&(Zt(t),t.subtreeFlags&6&&(t.flags|=8192)):Zt(t),null;case 24:return null;case 25:return null}throw Error(ne(156,t.tag))}function RN(e,t){switch(mm(t),t.tag){case 1:return Dn(t.type)&&Yc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _s(),ut(Nn),ut(ln),Sm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _m(t),null;case 13:if(ut(ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));Cs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(ct),null;case 4:return _s(),null;case 10:return wm(t.type._context),null;case 22:case 23:return Om(),null;case 24:return null;default:return null}}var Jl=!1,rn=!1,NN=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Vi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(e,t,r)}else n.current=null}function Vp(e,t,n){try{n()}catch(r){yt(e,t,r)}}var I0=!1;function DN(e,t){if(Rp=Hc,e=ob(),pm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var i=0,s=-1,u=-1,l=0,c=0,d=e,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=i+o),d!==a||r!==0&&d.nodeType!==3||(u=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++l===o&&(s=i),f===a&&++c===r&&(u=i),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Np={focusedElem:e,selectionRange:n},Hc=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:pr(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(w){yt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return p=I0,I0=!1,p}function wu(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&Vp(t,n,a)}o=o.next}while(o!==r)}}function Zd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Hp(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function e2(e){var t=e.alternate;t!==null&&(e.alternate=null,e2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gr],delete t[Wu],delete t[Tp],delete t[dN],delete t[fN])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function t2(e){return e.tag===5||e.tag===3||e.tag===4}function T0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||t2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Kc));else if(r!==4&&(e=e.child,e!==null))for(Gp(e,t,n),e=e.sibling;e!==null;)Gp(e,t,n),e=e.sibling}function qp(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(qp(e,t,n),e=e.sibling;e!==null;)qp(e,t,n),e=e.sibling}var Vt=null,gr=!1;function jo(e,t,n){for(n=n.child;n!==null;)n2(e,t,n),n=n.sibling}function n2(e,t,n){if(Jr&&typeof Jr.onCommitFiberUnmount=="function")try{Jr.onCommitFiberUnmount(Hd,n)}catch{}switch(n.tag){case 5:rn||Vi(n,t);case 6:var r=Vt,o=gr;Vt=null,jo(e,t,n),Vt=r,gr=o,Vt!==null&&(gr?(e=Vt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Vt.removeChild(n.stateNode));break;case 18:Vt!==null&&(gr?(e=Vt,n=n.stateNode,e.nodeType===8?oh(e.parentNode,n):e.nodeType===1&&oh(e,n),Fu(e)):oh(Vt,n.stateNode));break;case 4:r=Vt,o=gr,Vt=n.stateNode.containerInfo,gr=!0,jo(e,t,n),Vt=r,gr=o;break;case 0:case 11:case 14:case 15:if(!rn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var a=o,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Vp(n,t,i),o=o.next}while(o!==r)}jo(e,t,n);break;case 1:if(!rn&&(Vi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){yt(n,t,s)}jo(e,t,n);break;case 21:jo(e,t,n);break;case 22:n.mode&1?(rn=(r=rn)||n.memoizedState!==null,jo(e,t,n),rn=r):jo(e,t,n);break;default:jo(e,t,n)}}function P0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new NN),t.forEach(function(r){var o=BN.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function hr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,i=t,s=i;e:for(;s!==null;){switch(s.tag){case 5:Vt=s.stateNode,gr=!1;break e;case 3:Vt=s.stateNode.containerInfo,gr=!0;break e;case 4:Vt=s.stateNode.containerInfo,gr=!0;break e}s=s.return}if(Vt===null)throw Error(ne(160));n2(a,i,o),Vt=null,gr=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){yt(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)r2(t,e),t=t.sibling}function r2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hr(t,e),Lr(e),r&4){try{wu(3,e,e.return),Zd(3,e)}catch(m){yt(e,e.return,m)}try{wu(5,e,e.return)}catch(m){yt(e,e.return,m)}}break;case 1:hr(t,e),Lr(e),r&512&&n!==null&&Vi(n,n.return);break;case 5:if(hr(t,e),Lr(e),r&512&&n!==null&&Vi(n,n.return),e.flags&32){var o=e.stateNode;try{Tu(o,"")}catch(m){yt(e,e.return,m)}}if(r&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,i=n!==null?n.memoizedProps:a,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&Sw(o,a),gp(s,i);var l=gp(s,a);for(i=0;i<u.length;i+=2){var c=u[i],d=u[i+1];c==="style"?Iw(o,d):c==="dangerouslySetInnerHTML"?Nw(o,d):c==="children"?Tu(o,d):tm(o,c,d,l)}switch(s){case"input":fp(o,a);break;case"textarea":kw(o,a);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?qi(o,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?qi(o,!!a.multiple,a.defaultValue,!0):qi(o,!!a.multiple,a.multiple?[]:"",!1))}o[Wu]=a}catch(m){yt(e,e.return,m)}}break;case 6:if(hr(t,e),Lr(e),r&4){if(e.stateNode===null)throw Error(ne(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(m){yt(e,e.return,m)}}break;case 3:if(hr(t,e),Lr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Fu(t.containerInfo)}catch(m){yt(e,e.return,m)}break;case 4:hr(t,e),Lr(e);break;case 13:hr(t,e),Lr(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(Mm=xt())),r&4&&P0(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(rn=(l=rn)||c,hr(t,e),rn=l):hr(t,e),Lr(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ce=e,c=e.child;c!==null;){for(d=ce=c;ce!==null;){switch(f=ce,h=f.child,f.tag){case 0:case 11:case 14:case 15:wu(4,f,f.return);break;case 1:Vi(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){yt(r,n,m)}}break;case 5:Vi(f,f.return);break;case 22:if(f.memoizedState!==null){M0(d);continue}}h!==null?(h.return=f,ce=h):M0(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,l?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=d.stateNode,u=d.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=Dw("display",i))}catch(m){yt(e,e.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){yt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:hr(t,e),Lr(e),r&4&&P0(e);break;case 21:break;default:hr(t,e),Lr(e)}}function Lr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(t2(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Tu(o,""),r.flags&=-33);var a=T0(e);qp(e,a,o);break;case 3:case 4:var i=r.stateNode.containerInfo,s=T0(e);Gp(e,s,i);break;default:throw Error(ne(161))}}catch(u){yt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function IN(e,t,n){ce=e,o2(e)}function o2(e,t,n){for(var r=(e.mode&1)!==0;ce!==null;){var o=ce,a=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||Jl;if(!i){var s=o.alternate,u=s!==null&&s.memoizedState!==null||rn;s=Jl;var l=rn;if(Jl=i,(rn=u)&&!l)for(ce=o;ce!==null;)i=ce,u=i.child,i.tag===22&&i.memoizedState!==null?F0(o):u!==null?(u.return=i,ce=u):F0(o);for(;a!==null;)ce=a,o2(a),a=a.sibling;ce=o,Jl=s,rn=l}A0(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,ce=a):A0(e)}}function A0(e){for(;ce!==null;){var t=ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rn||Zd(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!rn)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:pr(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&g0(t,a,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}g0(t,i,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Fu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}rn||t.flags&512&&Hp(t)}catch(f){yt(t,t.return,f)}}if(t===e){ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,ce=n;break}ce=t.return}}function M0(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ce=n;break}ce=t.return}}function F0(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Zd(4,t)}catch(u){yt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){yt(t,o,u)}}var a=t.return;try{Hp(t)}catch(u){yt(t,a,u)}break;case 5:var i=t.return;try{Hp(t)}catch(u){yt(t,i,u)}}}catch(u){yt(t,t.return,u)}if(t===e){ce=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ce=s;break}ce=t.return}}var TN=Math.ceil,ad=Po.ReactCurrentDispatcher,Pm=Po.ReactCurrentOwner,sr=Po.ReactCurrentBatchConfig,$e=0,Wt=null,St=null,Kt=0,Bn=0,Hi=Ta(0),Pt=0,Gu=null,ii=0,ef=0,Am=0,bu=null,En=null,Mm=0,ks=1/0,wo=null,id=!1,Kp=null,va=null,Zl=!1,oa=null,sd=0,Cu=0,Yp=null,Tc=-1,Pc=0;function yn(){return $e&6?xt():Tc!==-1?Tc:Tc=xt()}function ma(e){return e.mode&1?$e&2&&Kt!==0?Kt&-Kt:pN.transition!==null?(Pc===0&&(Pc=$w()),Pc):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:Yw(e.type)),e):1}function _r(e,t,n,r){if(50<Cu)throw Cu=0,Yp=null,Error(ne(185));fl(e,n,r),(!($e&2)||e!==Wt)&&(e===Wt&&(!($e&2)&&(ef|=n),Pt===4&&Xo(e,Kt)),In(e,r),n===1&&$e===0&&!(t.mode&1)&&(ks=xt()+500,Xd&&Pa()))}function In(e,t){var n=e.callbackNode;pR(e,t);var r=Vc(e,e===Wt?Kt:0);if(r===0)n!==null&&Vy(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Vy(n),t===1)e.tag===0?hN(O0.bind(null,e)):pb(O0.bind(null,e)),lN(function(){!($e&6)&&Pa()}),n=null;else{switch(Uw(r)){case 1:n=im;break;case 4:n=Ww;break;case 16:n=Uc;break;case 536870912:n=zw;break;default:n=Uc}n=f2(n,a2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function a2(e,t){if(Tc=-1,Pc=0,$e&6)throw Error(ne(327));var n=e.callbackNode;if(Ji()&&e.callbackNode!==n)return null;var r=Vc(e,e===Wt?Kt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ud(e,r);else{t=r;var o=$e;$e|=2;var a=s2();(Wt!==e||Kt!==t)&&(wo=null,ks=xt()+500,Za(e,t));do try{MN();break}catch(s){i2(e,s)}while(!0);xm(),ad.current=a,$e=o,St!==null?t=0:(Wt=null,Kt=0,t=Pt)}if(t!==0){if(t===2&&(o=Cp(e),o!==0&&(r=o,t=Xp(e,o))),t===1)throw n=Gu,Za(e,0),Xo(e,r),In(e,xt()),n;if(t===6)Xo(e,r);else{if(o=e.current.alternate,!(r&30)&&!PN(o)&&(t=ud(e,r),t===2&&(a=Cp(e),a!==0&&(r=a,t=Xp(e,a))),t===1))throw n=Gu,Za(e,0),Xo(e,r),In(e,xt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(ne(345));case 2:Ba(e,En,wo);break;case 3:if(Xo(e,r),(r&130023424)===r&&(t=Mm+500-xt(),10<t)){if(Vc(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){yn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ip(Ba.bind(null,e,En,wo),t);break}Ba(e,En,wo);break;case 4:if(Xo(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var i=31-Er(r);a=1<<i,i=t[i],i>o&&(o=i),r&=~a}if(r=o,r=xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TN(r/1960))-r,10<r){e.timeoutHandle=Ip(Ba.bind(null,e,En,wo),r);break}Ba(e,En,wo);break;case 5:Ba(e,En,wo);break;default:throw Error(ne(329))}}}return In(e,xt()),e.callbackNode===n?a2.bind(null,e):null}function Xp(e,t){var n=bu;return e.current.memoizedState.isDehydrated&&(Za(e,t).flags|=256),e=ud(e,t),e!==2&&(t=En,En=n,t!==null&&Qp(t)),e}function Qp(e){En===null?En=e:En.push.apply(En,e)}function PN(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!kr(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xo(e,t){for(t&=~Am,t&=~ef,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Er(t),r=1<<n;e[n]=-1,t&=~r}}function O0(e){if($e&6)throw Error(ne(327));Ji();var t=Vc(e,0);if(!(t&1))return In(e,xt()),null;var n=ud(e,t);if(e.tag!==0&&n===2){var r=Cp(e);r!==0&&(t=r,n=Xp(e,r))}if(n===1)throw n=Gu,Za(e,0),Xo(e,t),In(e,xt()),n;if(n===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ba(e,En,wo),In(e,xt()),null}function Fm(e,t){var n=$e;$e|=1;try{return e(t)}finally{$e=n,$e===0&&(ks=xt()+500,Xd&&Pa())}}function si(e){oa!==null&&oa.tag===0&&!($e&6)&&Ji();var t=$e;$e|=1;var n=sr.transition,r=Xe;try{if(sr.transition=null,Xe=1,e)return e()}finally{Xe=r,sr.transition=n,$e=t,!($e&6)&&Pa()}}function Om(){Bn=Hi.current,ut(Hi)}function Za(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,uN(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(mm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yc();break;case 3:_s(),ut(Nn),ut(ln),Sm();break;case 5:_m(r);break;case 4:_s();break;case 13:ut(ct);break;case 19:ut(ct);break;case 10:wm(r.type._context);break;case 22:case 23:Om()}n=n.return}if(Wt=e,St=e=ga(e.current,null),Kt=Bn=t,Pt=0,Gu=null,Am=ef=ii=0,En=bu=null,Va!==null){for(t=0;t<Va.length;t++)if(n=Va[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,a=n.pending;if(a!==null){var i=a.next;a.next=o,r.next=i}n.pending=r}Va=null}return e}function i2(e,t){do{var n=St;try{if(xm(),Nc.current=od,rd){for(var r=ht.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}rd=!1}if(ai=0,jt=Tt=ht=null,xu=!1,Uu=0,Pm.current=null,n===null||n.return===null){Pt=1,Gu=t,St=null;break}e:{var a=e,i=n.return,s=n,u=t;if(t=Kt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=E0(i);if(h!==null){h.flags&=-257,_0(h,i,s,a,t),h.mode&1&&C0(a,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var m=new Set;m.add(u),t.updateQueue=m}else p.add(u);break e}else{if(!(t&1)){C0(a,l,t),Lm();break e}u=Error(ne(426))}}else if(lt&&s.mode&1){var g=E0(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),_0(g,i,s,a,t),gm(Ss(u,s));break e}}a=u=Ss(u,s),Pt!==4&&(Pt=2),bu===null?bu=[a]:bu.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var v=Ub(a,u,t);m0(a,v);break e;case 1:s=u;var y=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(va===null||!va.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var w=Vb(a,s,t);m0(a,w);break e}}a=a.return}while(a!==null)}l2(n)}catch(b){t=b,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function s2(){var e=ad.current;return ad.current=od,e===null?od:e}function Lm(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),Wt===null||!(ii&268435455)&&!(ef&268435455)||Xo(Wt,Kt)}function ud(e,t){var n=$e;$e|=2;var r=s2();(Wt!==e||Kt!==t)&&(wo=null,Za(e,t));do try{AN();break}catch(o){i2(e,o)}while(!0);if(xm(),$e=n,ad.current=r,St!==null)throw Error(ne(261));return Wt=null,Kt=0,Pt}function AN(){for(;St!==null;)u2(St)}function MN(){for(;St!==null&&!aR();)u2(St)}function u2(e){var t=d2(e.alternate,e,Bn);e.memoizedProps=e.pendingProps,t===null?l2(e):St=t,Pm.current=null}function l2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=RN(n,t),n!==null){n.flags&=32767,St=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pt=6,St=null;return}}else if(n=kN(n,t,Bn),n!==null){St=n;return}if(t=t.sibling,t!==null){St=t;return}St=t=e}while(t!==null);Pt===0&&(Pt=5)}function Ba(e,t,n){var r=Xe,o=sr.transition;try{sr.transition=null,Xe=1,FN(e,t,n,r)}finally{sr.transition=o,Xe=r}return null}function FN(e,t,n,r){do Ji();while(oa!==null);if($e&6)throw Error(ne(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(vR(e,a),e===Wt&&(St=Wt=null,Kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zl||(Zl=!0,f2(Uc,function(){return Ji(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=sr.transition,sr.transition=null;var i=Xe;Xe=1;var s=$e;$e|=4,Pm.current=null,DN(e,n),r2(n,e),tN(Np),Hc=!!Rp,Np=Rp=null,e.current=n,IN(n),iR(),$e=s,Xe=i,sr.transition=a}else e.current=n;if(Zl&&(Zl=!1,oa=e,sd=o),a=e.pendingLanes,a===0&&(va=null),lR(n.stateNode),In(e,xt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(id)throw id=!1,e=Kp,Kp=null,e;return sd&1&&e.tag!==0&&Ji(),a=e.pendingLanes,a&1?e===Yp?Cu++:(Cu=0,Yp=e):Cu=0,Pa(),null}function Ji(){if(oa!==null){var e=Uw(sd),t=sr.transition,n=Xe;try{if(sr.transition=null,Xe=16>e?16:e,oa===null)var r=!1;else{if(e=oa,oa=null,sd=0,$e&6)throw Error(ne(331));var o=$e;for($e|=4,ce=e.current;ce!==null;){var a=ce,i=a.child;if(ce.flags&16){var s=a.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(ce=l;ce!==null;){var c=ce;switch(c.tag){case 0:case 11:case 15:wu(8,c,a)}var d=c.child;if(d!==null)d.return=c,ce=d;else for(;ce!==null;){c=ce;var f=c.sibling,h=c.return;if(e2(c),c===l){ce=null;break}if(f!==null){f.return=h,ce=f;break}ce=h}}}var p=a.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ce=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ce=i;else e:for(;ce!==null;){if(a=ce,a.flags&2048)switch(a.tag){case 0:case 11:case 15:wu(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,ce=v;break e}ce=a.return}}var y=e.current;for(ce=y;ce!==null;){i=ce;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,ce=x;else e:for(i=y;ce!==null;){if(s=ce,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Zd(9,s)}}catch(b){yt(s,s.return,b)}if(s===i){ce=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ce=w;break e}ce=s.return}}if($e=o,Pa(),Jr&&typeof Jr.onPostCommitFiberRoot=="function")try{Jr.onPostCommitFiberRoot(Hd,e)}catch{}r=!0}return r}finally{Xe=n,sr.transition=t}}return!1}function L0(e,t,n){t=Ss(n,t),t=Ub(e,t,1),e=pa(e,t,1),t=yn(),e!==null&&(fl(e,1,t),In(e,t))}function yt(e,t,n){if(e.tag===3)L0(e,e,n);else for(;t!==null;){if(t.tag===3){L0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(va===null||!va.has(r))){e=Ss(n,e),e=Vb(t,e,1),t=pa(t,e,1),e=yn(),t!==null&&(fl(t,1,e),In(t,e));break}}t=t.return}}function ON(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=yn(),e.pingedLanes|=e.suspendedLanes&n,Wt===e&&(Kt&n)===n&&(Pt===4||Pt===3&&(Kt&130023424)===Kt&&500>xt()-Mm?Za(e,0):Am|=n),In(e,t)}function c2(e,t){t===0&&(e.mode&1?(t=Ul,Ul<<=1,!(Ul&130023424)&&(Ul=4194304)):t=1);var n=yn();e=No(e,t),e!==null&&(fl(e,t,n),In(e,n))}function LN(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),c2(e,n)}function BN(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(t),c2(e,n)}var d2;d2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nn.current)kn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return kn=!1,SN(e,t,n);kn=!!(e.flags&131072)}else kn=!1,lt&&t.flags&1048576&&vb(t,Jc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ic(e,t),e=t.pendingProps;var o=bs(t,ln.current);Qi(t,n),o=Rm(null,t,r,e,o,n);var a=Nm();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dn(r)?(a=!0,Xc(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Cm(t),o.updater=Jd,t.stateNode=o,o._reactInternals=t,Lp(t,r,e,n),t=Wp(null,t,r,!0,a,n)):(t.tag=0,lt&&a&&vm(t),hn(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ic(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=WN(r),e=pr(r,e),o){case 0:t=jp(null,t,r,e,n);break e;case 1:t=R0(null,t,r,e,n);break e;case 11:t=S0(null,t,r,e,n);break e;case 14:t=k0(null,t,r,pr(r.type,e),n);break e}throw Error(ne(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:pr(r,o),jp(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:pr(r,o),R0(e,t,r,o,n);case 3:e:{if(Kb(t),e===null)throw Error(ne(387));r=t.pendingProps,a=t.memoizedState,o=a.element,bb(e,t),td(t,r,null,n);var i=t.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Ss(Error(ne(423)),t),t=N0(e,t,r,n,o);break e}else if(r!==o){o=Ss(Error(ne(424)),t),t=N0(e,t,r,n,o);break e}else for($n=ha(t.stateNode.containerInfo.firstChild),Gn=t,lt=!0,yr=null,n=xb(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Cs(),r===o){t=Do(e,t,n);break e}hn(e,t,r,n)}t=t.child}return t;case 5:return Cb(t),e===null&&Mp(t),r=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,i=o.children,Dp(r,o)?i=null:a!==null&&Dp(r,a)&&(t.flags|=32),qb(e,t),hn(e,t,i,n),t.child;case 6:return e===null&&Mp(t),null;case 13:return Yb(e,t,n);case 4:return Em(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Es(t,null,r,n):hn(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:pr(r,o),S0(e,t,r,o,n);case 7:return hn(e,t,t.pendingProps,n),t.child;case 8:return hn(e,t,t.pendingProps.children,n),t.child;case 12:return hn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,i=o.value,Ze(Zc,r._currentValue),r._currentValue=i,a!==null)if(kr(a.value,i)){if(a.children===o.children&&!Nn.current){t=Do(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){i=a.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(a.tag===1){u=So(-1,n&-n),u.tag=2;var l=a.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Fp(a.return,n,t),s.lanes|=n;break}u=u.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ne(341));i.lanes|=n,s=i.alternate,s!==null&&(s.lanes|=n),Fp(i,n,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}hn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Qi(t,n),o=ur(o),r=r(o),t.flags|=1,hn(e,t,r,n),t.child;case 14:return r=t.type,o=pr(r,t.pendingProps),o=pr(r.type,o),k0(e,t,r,o,n);case 15:return Hb(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:pr(r,o),Ic(e,t),t.tag=1,Dn(r)?(e=!0,Xc(t)):e=!1,Qi(t,n),$b(t,r,o),Lp(t,r,o,n),Wp(null,t,r,!0,e,n);case 19:return Xb(e,t,n);case 22:return Gb(e,t,n)}throw Error(ne(156,t.tag))};function f2(e,t){return jw(e,t)}function jN(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ar(e,t,n,r){return new jN(e,t,n,r)}function Bm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function WN(e){if(typeof e=="function")return Bm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rm)return 11;if(e===om)return 14}return 2}function ga(e,t){var n=e.alternate;return n===null?(n=ar(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ac(e,t,n,r,o,a){var i=2;if(r=e,typeof e=="function")Bm(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Fi:return ei(n.children,o,a,t);case nm:i=8,o|=8;break;case sp:return e=ar(12,n,t,o|2),e.elementType=sp,e.lanes=a,e;case up:return e=ar(13,n,t,o),e.elementType=up,e.lanes=a,e;case lp:return e=ar(19,n,t,o),e.elementType=lp,e.lanes=a,e;case Cw:return tf(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ww:i=10;break e;case bw:i=9;break e;case rm:i=11;break e;case om:i=14;break e;case qo:i=16,r=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return t=ar(i,n,t,o),t.elementType=e,t.type=r,t.lanes=a,t}function ei(e,t,n,r){return e=ar(7,e,r,t),e.lanes=n,e}function tf(e,t,n,r){return e=ar(22,e,r,t),e.elementType=Cw,e.lanes=n,e.stateNode={isHidden:!1},e}function fh(e,t,n){return e=ar(6,e,null,t),e.lanes=n,e}function hh(e,t,n){return t=ar(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zN(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qf(0),this.expirationTimes=qf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qf(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function jm(e,t,n,r,o,a,i,s,u){return e=new zN(e,t,n,s,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ar(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cm(a),e}function $N(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function h2(e){if(!e)return Ca;e=e._reactInternals;e:{if(hi(e)!==e||e.tag!==1)throw Error(ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ne(171))}if(e.tag===1){var n=e.type;if(Dn(n))return hb(e,n,t)}return t}function p2(e,t,n,r,o,a,i,s,u){return e=jm(n,r,!0,e,o,a,i,s,u),e.context=h2(null),n=e.current,r=yn(),o=ma(n),a=So(r,o),a.callback=t??null,pa(n,a,o),e.current.lanes=o,fl(e,o,r),In(e,r),e}function nf(e,t,n,r){var o=t.current,a=yn(),i=ma(o);return n=h2(n),t.context===null?t.context=n:t.pendingContext=n,t=So(a,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=pa(o,t,i),e!==null&&(_r(e,o,i,a),Rc(e,o,i)),i}function ld(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function B0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Wm(e,t){B0(e,t),(e=e.alternate)&&B0(e,t)}function UN(){return null}var v2=typeof reportError=="function"?reportError:function(e){console.error(e)};function zm(e){this._internalRoot=e}rf.prototype.render=zm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));nf(e,t,null,null)};rf.prototype.unmount=zm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;si(function(){nf(null,e,null,null)}),t[Ro]=null}};function rf(e){this._internalRoot=e}rf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Gw();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Yo.length&&t!==0&&t<Yo[n].priority;n++);Yo.splice(n,0,e),n===0&&Kw(e)}};function $m(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function of(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function j0(){}function VN(e,t,n,r,o){if(o){if(typeof r=="function"){var a=r;r=function(){var l=ld(i);a.call(l)}}var i=p2(t,r,e,0,null,!1,!1,"",j0);return e._reactRootContainer=i,e[Ro]=i.current,Bu(e.nodeType===8?e.parentNode:e),si(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=ld(u);s.call(l)}}var u=jm(e,0,!1,null,null,!1,!1,"",j0);return e._reactRootContainer=u,e[Ro]=u.current,Bu(e.nodeType===8?e.parentNode:e),si(function(){nf(t,u,n,r)}),u}function af(e,t,n,r,o){var a=n._reactRootContainer;if(a){var i=a;if(typeof o=="function"){var s=o;o=function(){var u=ld(i);s.call(u)}}nf(t,i,e,o)}else i=VN(n,t,e,o,r);return ld(i)}Vw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=du(t.pendingLanes);n!==0&&(sm(t,n|1),In(t,xt()),!($e&6)&&(ks=xt()+500,Pa()))}break;case 13:si(function(){var r=No(e,1);if(r!==null){var o=yn();_r(r,e,1,o)}}),Wm(e,1)}};um=function(e){if(e.tag===13){var t=No(e,134217728);if(t!==null){var n=yn();_r(t,e,134217728,n)}Wm(e,134217728)}};Hw=function(e){if(e.tag===13){var t=ma(e),n=No(e,t);if(n!==null){var r=yn();_r(n,e,t,r)}Wm(e,t)}};Gw=function(){return Xe};qw=function(e,t){var n=Xe;try{return Xe=e,t()}finally{Xe=n}};xp=function(e,t,n){switch(t){case"input":if(fp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Yd(r);if(!o)throw Error(ne(90));_w(r),fp(r,o)}}}break;case"textarea":kw(e,n);break;case"select":t=n.value,t!=null&&qi(e,!!n.multiple,t,!1)}};Aw=Fm;Mw=si;var HN={usingClientEntryPoint:!1,Events:[pl,ji,Yd,Tw,Pw,Fm]},Qs={findFiberByHostInstance:Ua,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GN={bundleType:Qs.bundleType,version:Qs.version,rendererPackageName:Qs.rendererPackageName,rendererConfig:Qs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Po.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Lw(e),e===null?null:e.stateNode},findFiberByHostInstance:Qs.findFiberByHostInstance||UN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ec=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ec.isDisabled&&ec.supportsFiber)try{Hd=ec.inject(GN),Jr=ec}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HN;Jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$m(t))throw Error(ne(200));return $N(e,t,null,n)};Jn.createRoot=function(e,t){if(!$m(e))throw Error(ne(299));var n=!1,r="",o=v2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=jm(e,1,!1,null,null,n,!1,r,o),e[Ro]=t.current,Bu(e.nodeType===8?e.parentNode:e),new zm(t)};Jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Lw(t),e=e===null?null:e.stateNode,e};Jn.flushSync=function(e){return si(e)};Jn.hydrate=function(e,t,n){if(!of(t))throw Error(ne(200));return af(null,e,t,!0,n)};Jn.hydrateRoot=function(e,t,n){if(!$m(e))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,o=!1,a="",i=v2;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=p2(t,null,e,1,n??null,o,!1,a,i),e[Ro]=t.current,Bu(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new rf(t)};Jn.render=function(e,t,n){if(!of(t))throw Error(ne(200));return af(null,e,t,!1,n)};Jn.unmountComponentAtNode=function(e){if(!of(e))throw Error(ne(40));return e._reactRootContainer?(si(function(){af(null,null,e,!1,function(){e._reactRootContainer=null,e[Ro]=null})}),!0):!1};Jn.unstable_batchedUpdates=Fm;Jn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!of(n))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return af(e,t,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function m2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m2)}catch(e){console.error(e)}}m2(),mw.exports=Jn;var ml=mw.exports;const g2=rw(ml);var y2,W0=ml;y2=W0.createRoot,W0.hydrateRoot;const qN=1,KN=1e6;let ph=0;function YN(){return ph=(ph+1)%Number.MAX_SAFE_INTEGER,ph.toString()}const vh=new Map,z0=e=>{if(vh.has(e))return;const t=setTimeout(()=>{vh.delete(e),Eu({type:"REMOVE_TOAST",toastId:e})},KN);vh.set(e,t)},XN=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,qN)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?z0(n):e.toasts.forEach(r=>{z0(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Mc=[];let Fc={toasts:[]};function Eu(e){Fc=XN(Fc,e),Mc.forEach(t=>{t(Fc)})}function QN({...e}){const t=YN(),n=o=>Eu({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>Eu({type:"DISMISS_TOAST",toastId:t});return Eu({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:n}}function gl(){const[e,t]=R.useState(Fc);return R.useEffect(()=>(Mc.push(t),()=>{const n=Mc.indexOf(t);n>-1&&Mc.splice(n,1)}),[e]),{...e,toast:QN,dismiss:n=>Eu({type:"DISMISS_TOAST",toastId:n})}}function Qe(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function JN(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function x2(...e){return t=>e.forEach(n=>JN(n,t))}function cr(...e){return R.useCallback(x2(...e),e)}function ZN(e,t=[]){let n=[];function r(a,i){const s=R.createContext(i),u=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...p}=d,m=(f==null?void 0:f[e][u])||s,g=R.useMemo(()=>p,Object.values(p));return C.jsx(m.Provider,{value:g,children:h})}function c(d,f){const h=(f==null?void 0:f[e][u])||s,p=R.useContext(h);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,c]}const o=()=>{const a=n.map(i=>R.createContext(i));return function(s){const u=(s==null?void 0:s[e])||a;return R.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,eD(o,...t)]}function eD(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(a){const i=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(a)[`__scope${l}`];return{...s,...d}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var qu=R.forwardRef((e,t)=>{const{children:n,...r}=e,o=R.Children.toArray(n),a=o.find(tD);if(a){const i=a.props.children,s=o.map(u=>u===a?R.Children.count(i)>1?R.Children.only(null):R.isValidElement(i)?i.props.children:null:u);return C.jsx(Jp,{...r,ref:t,children:R.isValidElement(i)?R.cloneElement(i,void 0,s):null})}return C.jsx(Jp,{...r,ref:t,children:n})});qu.displayName="Slot";var Jp=R.forwardRef((e,t)=>{const{children:n,...r}=e;if(R.isValidElement(n)){const o=rD(n);return R.cloneElement(n,{...nD(r,n.props),ref:t?x2(t,o):o})}return R.Children.count(n)>1?R.Children.only(null):null});Jp.displayName="SlotClone";var w2=({children:e})=>C.jsx(C.Fragment,{children:e});function tD(e){return R.isValidElement(e)&&e.type===w2}function nD(e,t){const n={...t};for(const r in t){const o=e[r],a=t[r];/^on[A-Z]/.test(r)?o&&a?n[r]=(...s)=>{a(...s),o(...s)}:o&&(n[r]=o):r==="style"?n[r]={...o,...a}:r==="className"&&(n[r]=[o,a].filter(Boolean).join(" "))}return{...e,...n}}function rD(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function b2(e){const t=e+"CollectionProvider",[n,r]=ZN(t),[o,a]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=h=>{const{scope:p,children:m}=h,g=te.useRef(null),v=te.useRef(new Map).current;return C.jsx(o,{scope:p,itemMap:v,collectionRef:g,children:m})};i.displayName=t;const s=e+"CollectionSlot",u=te.forwardRef((h,p)=>{const{scope:m,children:g}=h,v=a(s,m),y=cr(p,v.collectionRef);return C.jsx(qu,{ref:y,children:g})});u.displayName=s;const l=e+"CollectionItemSlot",c="data-radix-collection-item",d=te.forwardRef((h,p)=>{const{scope:m,children:g,...v}=h,y=te.useRef(null),x=cr(p,y),w=a(l,m);return te.useEffect(()=>(w.itemMap.set(y,{ref:y,...v}),()=>void w.itemMap.delete(y))),C.jsx(qu,{[c]:"",ref:x,children:g})});d.displayName=l;function f(h){const p=a(e+"CollectionConsumer",h);return te.useCallback(()=>{const g=p.collectionRef.current;if(!g)return[];const v=Array.from(g.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((w,b)=>v.indexOf(w.ref.current)-v.indexOf(b.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:i,Slot:u,ItemSlot:d},f,r]}function Um(e,t=[]){let n=[];function r(a,i){const s=R.createContext(i),u=n.length;n=[...n,i];const l=d=>{var v;const{scope:f,children:h,...p}=d,m=((v=f==null?void 0:f[e])==null?void 0:v[u])||s,g=R.useMemo(()=>p,Object.values(p));return C.jsx(m.Provider,{value:g,children:h})};l.displayName=a+"Provider";function c(d,f){var m;const h=((m=f==null?void 0:f[e])==null?void 0:m[u])||s,p=R.useContext(h);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return[l,c]}const o=()=>{const a=n.map(i=>R.createContext(i));return function(s){const u=(s==null?void 0:s[e])||a;return R.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,oD(o,...t)]}function oD(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(a){const i=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(a)[`__scope${l}`];return{...s,...d}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var aD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Nt=aD.reduce((e,t)=>{const n=R.forwardRef((r,o)=>{const{asChild:a,...i}=r,s=a?qu:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),C.jsx(s,{...i,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function C2(e,t){e&&ml.flushSync(()=>e.dispatchEvent(t))}function Rr(e){const t=R.useRef(e);return R.useEffect(()=>{t.current=e}),R.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function iD(e,t=globalThis==null?void 0:globalThis.document){const n=Rr(e);R.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var sD="DismissableLayer",Zp="dismissableLayer.update",uD="dismissableLayer.pointerDownOutside",lD="dismissableLayer.focusOutside",$0,E2=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vm=R.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:a,onInteractOutside:i,onDismiss:s,...u}=e,l=R.useContext(E2),[c,d]=R.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=R.useState({}),p=cr(t,S=>d(S)),m=Array.from(l.layers),[g]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),v=m.indexOf(g),y=c?m.indexOf(c):-1,x=l.layersWithOutsidePointerEventsDisabled.size>0,w=y>=v,b=dD(S=>{const _=S.target,k=[...l.branches].some(N=>N.contains(_));!w||k||(o==null||o(S),i==null||i(S),S.defaultPrevented||s==null||s())},f),E=fD(S=>{const _=S.target;[...l.branches].some(N=>N.contains(_))||(a==null||a(S),i==null||i(S),S.defaultPrevented||s==null||s())},f);return iD(S=>{y===l.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&s&&(S.preventDefault(),s()))},f),R.useEffect(()=>{if(c)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&($0=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(c)),l.layers.add(c),U0(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=$0)}},[c,f,n,l]),R.useEffect(()=>()=>{c&&(l.layers.delete(c),l.layersWithOutsidePointerEventsDisabled.delete(c),U0())},[c,l]),R.useEffect(()=>{const S=()=>h({});return document.addEventListener(Zp,S),()=>document.removeEventListener(Zp,S)},[]),C.jsx(Nt.div,{...u,ref:p,style:{pointerEvents:x?w?"auto":"none":void 0,...e.style},onFocusCapture:Qe(e.onFocusCapture,E.onFocusCapture),onBlurCapture:Qe(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Qe(e.onPointerDownCapture,b.onPointerDownCapture)})});Vm.displayName=sD;var cD="DismissableLayerBranch",_2=R.forwardRef((e,t)=>{const n=R.useContext(E2),r=R.useRef(null),o=cr(t,r);return R.useEffect(()=>{const a=r.current;if(a)return n.branches.add(a),()=>{n.branches.delete(a)}},[n.branches]),C.jsx(Nt.div,{...e,ref:o})});_2.displayName=cD;function dD(e,t=globalThis==null?void 0:globalThis.document){const n=Rr(e),r=R.useRef(!1),o=R.useRef(()=>{});return R.useEffect(()=>{const a=s=>{if(s.target&&!r.current){let u=function(){S2(uD,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=u,t.addEventListener("click",o.current,{once:!0})):u()}else t.removeEventListener("click",o.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function fD(e,t=globalThis==null?void 0:globalThis.document){const n=Rr(e),r=R.useRef(!1);return R.useEffect(()=>{const o=a=>{a.target&&!r.current&&S2(lD,n,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function U0(){const e=new CustomEvent(Zp);document.dispatchEvent(e)}function S2(e,t,n,{discrete:r}){const o=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?C2(o,a):o.dispatchEvent(a)}var hD=Vm,pD=_2,Ea=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},vD="Portal",k2=R.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[o,a]=R.useState(!1);Ea(()=>a(!0),[]);const i=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?g2.createPortal(C.jsx(Nt.div,{...r,ref:t}),i):null});k2.displayName=vD;function mD(e,t){return R.useReducer((n,r)=>t[n][r]??n,e)}var sf=e=>{const{present:t,children:n}=e,r=gD(t),o=typeof n=="function"?n({present:r.isPresent}):R.Children.only(n),a=cr(r.ref,yD(o));return typeof n=="function"||r.isPresent?R.cloneElement(o,{ref:a}):null};sf.displayName="Presence";function gD(e){const[t,n]=R.useState(),r=R.useRef({}),o=R.useRef(e),a=R.useRef("none"),i=e?"mounted":"unmounted",[s,u]=mD(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const l=tc(r.current);a.current=s==="mounted"?l:"none"},[s]),Ea(()=>{const l=r.current,c=o.current;if(c!==e){const f=a.current,h=tc(l);e?u("MOUNT"):h==="none"||(l==null?void 0:l.display)==="none"?u("UNMOUNT"):u(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),Ea(()=>{if(t){let l;const c=t.ownerDocument.defaultView??window,d=h=>{const m=tc(r.current).includes(h.animationName);if(h.target===t&&m&&(u("ANIMATION_END"),!o.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",l=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=h=>{h.target===t&&(a.current=tc(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{c.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:R.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function tc(e){return(e==null?void 0:e.animationName)||"none"}function yD(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Hm({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,o]=xD({defaultProp:t,onChange:n}),a=e!==void 0,i=a?e:r,s=Rr(n),u=R.useCallback(l=>{if(a){const d=typeof l=="function"?l(e):l;d!==e&&s(d)}else o(l)},[a,e,o,s]);return[i,u]}function xD({defaultProp:e,onChange:t}){const n=R.useState(e),[r]=n,o=R.useRef(r),a=Rr(t);return R.useEffect(()=>{o.current!==r&&(a(r),o.current=r)},[r,o,a]),n}var wD="VisuallyHidden",uf=R.forwardRef((e,t)=>C.jsx(Nt.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));uf.displayName=wD;var bD=uf,Gm="ToastProvider",[qm,CD,ED]=b2("Toast"),[R2,$$]=Um("Toast",[ED]),[_D,lf]=R2(Gm),N2=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:a=50,children:i}=e,[s,u]=R.useState(null),[l,c]=R.useState(0),d=R.useRef(!1),f=R.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Gm}\`. Expected non-empty \`string\`.`),C.jsx(qm.Provider,{scope:t,children:C.jsx(_D,{scope:t,label:n,duration:r,swipeDirection:o,swipeThreshold:a,toastCount:l,viewport:s,onViewportChange:u,onToastAdd:R.useCallback(()=>c(h=>h+1),[]),onToastRemove:R.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:i})})};N2.displayName=Gm;var D2="ToastViewport",SD=["F8"],ev="toast.viewportPause",tv="toast.viewportResume",I2=R.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=SD,label:o="Notifications ({hotkey})",...a}=e,i=lf(D2,n),s=CD(n),u=R.useRef(null),l=R.useRef(null),c=R.useRef(null),d=R.useRef(null),f=cr(t,d,i.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;R.useEffect(()=>{const g=v=>{var x;r.length!==0&&r.every(w=>v[w]||v.code===w)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),R.useEffect(()=>{const g=u.current,v=d.current;if(p&&g&&v){const y=()=>{if(!i.isClosePausedRef.current){const E=new CustomEvent(ev);v.dispatchEvent(E),i.isClosePausedRef.current=!0}},x=()=>{if(i.isClosePausedRef.current){const E=new CustomEvent(tv);v.dispatchEvent(E),i.isClosePausedRef.current=!1}},w=E=>{!g.contains(E.relatedTarget)&&x()},b=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",y),g.addEventListener("focusout",w),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",b),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",w),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",b),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[p,i.isClosePausedRef]);const m=R.useCallback(({tabbingDirection:g})=>{const y=s().map(x=>{const w=x.ref.current,b=[w,...BD(w)];return g==="forwards"?b:b.reverse()});return(g==="forwards"?y.reverse():y).flat()},[s]);return R.useEffect(()=>{const g=d.current;if(g){const v=y=>{var b,E,S;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const _=document.activeElement,k=y.shiftKey;if(y.target===g&&k){(b=l.current)==null||b.focus();return}const T=m({tabbingDirection:k?"backwards":"forwards"}),L=T.findIndex(M=>M===_);mh(T.slice(L+1))?y.preventDefault():k?(E=l.current)==null||E.focus():(S=c.current)==null||S.focus()}};return g.addEventListener("keydown",v),()=>g.removeEventListener("keydown",v)}},[s,m]),C.jsxs(pD,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&C.jsx(nv,{ref:l,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});mh(g)}}),C.jsx(qm.Slot,{scope:n,children:C.jsx(Nt.ol,{tabIndex:-1,...a,ref:f})}),p&&C.jsx(nv,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});mh(g)}})]})});I2.displayName=D2;var T2="ToastFocusProxy",nv=R.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=e,a=lf(T2,n);return C.jsx(uf,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{var l;const s=i.relatedTarget;!((l=a.viewport)!=null&&l.contains(s))&&r()}})});nv.displayName=T2;var cf="Toast",kD="toast.swipeStart",RD="toast.swipeMove",ND="toast.swipeCancel",DD="toast.swipeEnd",P2=R.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:a,...i}=e,[s=!0,u]=Hm({prop:r,defaultProp:o,onChange:a});return C.jsx(sf,{present:n||s,children:C.jsx(PD,{open:s,...i,ref:t,onClose:()=>u(!1),onPause:Rr(e.onPause),onResume:Rr(e.onResume),onSwipeStart:Qe(e.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Qe(e.onSwipeMove,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Qe(e.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Qe(e.onSwipeEnd,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});P2.displayName=cf;var[ID,TD]=R2(cf,{onClose(){}}),PD=R.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:a,onClose:i,onEscapeKeyDown:s,onPause:u,onResume:l,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...p}=e,m=lf(cf,n),[g,v]=R.useState(null),y=cr(t,M=>v(M)),x=R.useRef(null),w=R.useRef(null),b=o||m.duration,E=R.useRef(0),S=R.useRef(b),_=R.useRef(0),{onToastAdd:k,onToastRemove:N}=m,A=Rr(()=>{var $;(g==null?void 0:g.contains(document.activeElement))&&(($=m.viewport)==null||$.focus()),i()}),T=R.useCallback(M=>{!M||M===1/0||(window.clearTimeout(_.current),E.current=new Date().getTime(),_.current=window.setTimeout(A,M))},[A]);R.useEffect(()=>{const M=m.viewport;if(M){const $=()=>{T(S.current),l==null||l()},U=()=>{const j=new Date().getTime()-E.current;S.current=S.current-j,window.clearTimeout(_.current),u==null||u()};return M.addEventListener(ev,U),M.addEventListener(tv,$),()=>{M.removeEventListener(ev,U),M.removeEventListener(tv,$)}}},[m.viewport,b,u,l,T]),R.useEffect(()=>{a&&!m.isClosePausedRef.current&&T(b)},[a,b,m.isClosePausedRef,T]),R.useEffect(()=>(k(),()=>N()),[k,N]);const L=R.useMemo(()=>g?j2(g):null,[g]);return m.viewport?C.jsxs(C.Fragment,{children:[L&&C.jsx(AD,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:L}),C.jsx(ID,{scope:n,onClose:A,children:ml.createPortal(C.jsx(qm.ItemSlot,{scope:n,children:C.jsx(hD,{asChild:!0,onEscapeKeyDown:Qe(s,()=>{m.isFocusedToastEscapeKeyDownRef.current||A(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:C.jsx(Nt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Qe(e.onKeyDown,M=>{M.key==="Escape"&&(s==null||s(M.nativeEvent),M.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:Qe(e.onPointerDown,M=>{M.button===0&&(x.current={x:M.clientX,y:M.clientY})}),onPointerMove:Qe(e.onPointerMove,M=>{if(!x.current)return;const $=M.clientX-x.current.x,U=M.clientY-x.current.y,j=!!w.current,D=["left","right"].includes(m.swipeDirection),F=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,z=D?F(0,$):0,H=D?0:F(0,U),X=M.pointerType==="touch"?10:2,ee={x:z,y:H},le={originalEvent:M,delta:ee};j?(w.current=ee,nc(RD,d,le,{discrete:!1})):V0(ee,m.swipeDirection,X)?(w.current=ee,nc(kD,c,le,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs($)>X||Math.abs(U)>X)&&(x.current=null)}),onPointerUp:Qe(e.onPointerUp,M=>{const $=w.current,U=M.target;if(U.hasPointerCapture(M.pointerId)&&U.releasePointerCapture(M.pointerId),w.current=null,x.current=null,$){const j=M.currentTarget,D={originalEvent:M,delta:$};V0($,m.swipeDirection,m.swipeThreshold)?nc(DD,h,D,{discrete:!0}):nc(ND,f,D,{discrete:!0}),j.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),AD=e=>{const{__scopeToast:t,children:n,...r}=e,o=lf(cf,t),[a,i]=R.useState(!1),[s,u]=R.useState(!1);return OD(()=>i(!0)),R.useEffect(()=>{const l=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(l)},[]),s?null:C.jsx(k2,{asChild:!0,children:C.jsx(uf,{...r,children:a&&C.jsxs(C.Fragment,{children:[o.label," ",n]})})})},MD="ToastTitle",A2=R.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return C.jsx(Nt.div,{...r,ref:t})});A2.displayName=MD;var FD="ToastDescription",M2=R.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return C.jsx(Nt.div,{...r,ref:t})});M2.displayName=FD;var F2="ToastAction",O2=R.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?C.jsx(B2,{altText:n,asChild:!0,children:C.jsx(Km,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${F2}\`. Expected non-empty \`string\`.`),null)});O2.displayName=F2;var L2="ToastClose",Km=R.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,o=TD(L2,n);return C.jsx(B2,{asChild:!0,children:C.jsx(Nt.button,{type:"button",...r,ref:t,onClick:Qe(e.onClick,o.onClose)})})});Km.displayName=L2;var B2=R.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...o}=e;return C.jsx(Nt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function j2(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),LD(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",a=r.dataset.radixToastAnnounceExclude==="";if(!o)if(a){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...j2(r))}}),t}function nc(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?C2(o,a):o.dispatchEvent(a)}var V0=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),a=r>o;return t==="left"||t==="right"?a&&r>n:!a&&o>n};function OD(e=()=>{}){const t=Rr(e);Ea(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function LD(e){return e.nodeType===e.ELEMENT_NODE}function BD(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function mh(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var jD=N2,W2=I2,z2=P2,$2=A2,U2=M2,V2=O2,H2=Km;function G2(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=G2(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function q2(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=G2(e))&&(r&&(r+=" "),r+=t);return r}const H0=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,G0=q2,K2=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return G0(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:a}=t,i=Object.keys(o).map(l=>{const c=n==null?void 0:n[l],d=a==null?void 0:a[l];if(c===null)return null;const f=H0(c)||H0(d);return o[l][f]}),s=n&&Object.entries(n).reduce((l,c)=>{let[d,f]=c;return f===void 0||(l[d]=f),l},{}),u=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((l,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...a,...s}[m]):{...a,...s}[m]===g})?[...l,d,f]:l},[]);return G0(e,i,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Y2=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=R.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:a,iconNode:i,...s},u)=>R.createElement("svg",{ref:u,...zD,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Y2("lucide",o),...s},[...i.map(([l,c])=>R.createElement(l,c)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=(e,t)=>{const n=R.forwardRef(({className:r,...o},a)=>R.createElement($D,{ref:a,iconNode:t,className:Y2(`lucide-${WD(e)}`,r),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=ao("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=ao("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=ao("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=ao("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=ao("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=ao("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=ao("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=ao("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=ao("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=ao("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Xm="-",qD=e=>{const t=YD(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const s=i.split(Xm);return s[0]===""&&s.length!==1&&s.shift(),Q2(s,t)||KD(i)},getConflictingClassGroupIds:(i,s)=>{const u=n[i]||[];return s&&r[i]?[...u,...r[i]]:u}}},Q2=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?Q2(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const a=e.join(Xm);return(i=t.validators.find(({validator:s})=>s(a)))==null?void 0:i.classGroupId},K0=/^\[(.+)\]$/,KD=e=>{if(K0.test(e)){const t=K0.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},YD=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return QD(Object.entries(e.classGroups),n).forEach(([a,i])=>{av(i,r,a,t)}),r},av=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const a=o===""?t:Y0(t,o);a.classGroupId=n;return}if(typeof o=="function"){if(XD(o)){av(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([a,i])=>{av(i,Y0(t,a),n,r)})})},Y0=(e,t)=>{let n=e;return t.split(Xm).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},XD=e=>e.isThemeGetter,QD=(e,t)=>t?e.map(([n,r])=>{const o=r.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([i,s])=>[t+i,s])):a);return[n,o]}):e,JD=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(a,i)=>{n.set(a,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(a){let i=n.get(a);if(i!==void 0)return i;if((i=r.get(a))!==void 0)return o(a,i),i},set(a,i){n.has(a)?n.set(a,i):o(a,i)}}},J2="!",ZD=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,o=t[0],a=t.length,i=s=>{const u=[];let l=0,c=0,d;for(let g=0;g<s.length;g++){let v=s[g];if(l===0){if(v===o&&(r||s.slice(g,g+a)===t)){u.push(s.slice(c,g)),c=g+a;continue}if(v==="/"){d=g;continue}}v==="["?l++:v==="]"&&l--}const f=u.length===0?s:s.substring(c),h=f.startsWith(J2),p=h?f.substring(1):f,m=d&&d>c?d-c:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:m}};return n?s=>n({className:s,parseClassName:i}):i},eI=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},tI=e=>({cache:JD(e.cacheSize),parseClassName:ZD(e),...qD(e)}),nI=/\s+/,rI=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=t,a=[],i=e.trim().split(nI);let s="";for(let u=i.length-1;u>=0;u-=1){const l=i[u],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(l);let p=!!h,m=r(p?f.substring(0,h):f);if(!m){if(!p){s=l+(s.length>0?" "+s:s);continue}if(m=r(f),!m){s=l+(s.length>0?" "+s:s);continue}p=!1}const g=eI(c).join(":"),v=d?g+J2:g,y=v+m;if(a.includes(y))continue;a.push(y);const x=o(m,p);for(let w=0;w<x.length;++w){const b=x[w];a.push(v+b)}s=l+(s.length>0?" "+s:s)}return s};function oI(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Z2(t))&&(r&&(r+=" "),r+=n);return r}const Z2=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Z2(e[r]))&&(n&&(n+=" "),n+=t);return n};function aI(e,...t){let n,r,o,a=i;function i(u){const l=t.reduce((c,d)=>d(c),e());return n=tI(l),r=n.cache.get,o=n.cache.set,a=s,s(u)}function s(u){const l=r(u);if(l)return l;const c=rI(u,n);return o(u,c),c}return function(){return a(oI.apply(null,arguments))}}const ot=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},eC=/^\[(?:([a-z-]+):)?(.+)\]$/i,iI=/^\d+\/\d+$/,sI=new Set(["px","full","screen"]),uI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,cI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,dI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,po=e=>Zi(e)||sI.has(e)||iI.test(e),Wo=e=>Bs(e,"length",wI),Zi=e=>!!e&&!Number.isNaN(Number(e)),gh=e=>Bs(e,"number",Zi),Js=e=>!!e&&Number.isInteger(Number(e)),hI=e=>e.endsWith("%")&&Zi(e.slice(0,-1)),Ie=e=>eC.test(e),zo=e=>uI.test(e),pI=new Set(["length","size","percentage"]),vI=e=>Bs(e,pI,tC),mI=e=>Bs(e,"position",tC),gI=new Set(["image","url"]),yI=e=>Bs(e,gI,CI),xI=e=>Bs(e,"",bI),Zs=()=>!0,Bs=(e,t,n)=>{const r=eC.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},wI=e=>lI.test(e)&&!cI.test(e),tC=()=>!1,bI=e=>dI.test(e),CI=e=>fI.test(e),EI=()=>{const e=ot("colors"),t=ot("spacing"),n=ot("blur"),r=ot("brightness"),o=ot("borderColor"),a=ot("borderRadius"),i=ot("borderSpacing"),s=ot("borderWidth"),u=ot("contrast"),l=ot("grayscale"),c=ot("hueRotate"),d=ot("invert"),f=ot("gap"),h=ot("gradientColorStops"),p=ot("gradientColorStopPositions"),m=ot("inset"),g=ot("margin"),v=ot("opacity"),y=ot("padding"),x=ot("saturate"),w=ot("scale"),b=ot("sepia"),E=ot("skew"),S=ot("space"),_=ot("translate"),k=()=>["auto","contain","none"],N=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto",Ie,t],T=()=>[Ie,t],L=()=>["",po,Wo],M=()=>["auto",Zi,Ie],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],j=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Ie],z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[Zi,Ie];return{cacheSize:500,separator:":",theme:{colors:[Zs],spacing:[po,Wo],blur:["none","",zo,Ie],brightness:H(),borderColor:[e],borderRadius:["none","","full",zo,Ie],borderSpacing:T(),borderWidth:L(),contrast:H(),grayscale:F(),hueRotate:H(),invert:F(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[hI,Wo],inset:A(),margin:A(),opacity:H(),padding:T(),saturate:H(),scale:H(),sepia:F(),skew:H(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",Ie]}],container:["container"],columns:[{columns:[zo]}],"break-after":[{"break-after":z()}],"break-before":[{"break-before":z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),Ie]}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Js,Ie]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ie]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Js,Ie]}],"grid-cols":[{"grid-cols":[Zs]}],"col-start-end":[{col:["auto",{span:["full",Js,Ie]},Ie]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Zs]}],"row-start-end":[{row:["auto",{span:[Js,Ie]},Ie]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ie]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ie]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...D()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...D(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...D(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ie,t]}],"min-w":[{"min-w":[Ie,t,"min","max","fit"]}],"max-w":[{"max-w":[Ie,t,"none","full","min","max","fit","prose",{screen:[zo]},zo]}],h:[{h:[Ie,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ie,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ie,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ie,t,"auto","min","max","fit"]}],"font-size":[{text:["base",zo,Wo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gh]}],"font-family":[{font:[Zs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ie]}],"line-clamp":[{"line-clamp":["none",Zi,gh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",po,Ie]}],"list-image":[{"list-image":["none",Ie]}],"list-style-type":[{list:["none","disc","decimal",Ie]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",po,Wo]}],"underline-offset":[{"underline-offset":["auto",po,Ie]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ie]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ie]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),mI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",vI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},yI]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:U()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[po,Ie]}],"outline-w":[{outline:[po,Wo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[po,Wo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",zo,xI]}],"shadow-color":[{shadow:[Zs]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...j(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":j()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",zo,Ie]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ie]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",Ie]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ie]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Js,Ie]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ie]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ie]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ie]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[po,Wo,gh]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},_I=aI(EI);function wt(...e){return _I(q2(e))}const SI=jD,nC=R.forwardRef(({className:e,...t},n)=>C.jsx(W2,{ref:n,className:wt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));nC.displayName=W2.displayName;const kI=K2("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),rC=R.forwardRef(({className:e,variant:t,...n},r)=>C.jsx(z2,{ref:r,className:wt(kI({variant:t}),e),...n}));rC.displayName=z2.displayName;const RI=R.forwardRef(({className:e,...t},n)=>C.jsx(V2,{ref:n,className:wt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));RI.displayName=V2.displayName;const oC=R.forwardRef(({className:e,...t},n)=>C.jsx(H2,{ref:n,className:wt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:C.jsx(ov,{className:"h-4 w-4"})}));oC.displayName=H2.displayName;const aC=R.forwardRef(({className:e,...t},n)=>C.jsx($2,{ref:n,className:wt("text-sm font-semibold",e),...t}));aC.displayName=$2.displayName;const iC=R.forwardRef(({className:e,...t},n)=>C.jsx(U2,{ref:n,className:wt("text-sm opacity-90",e),...t}));iC.displayName=U2.displayName;function NI(){const{toasts:e}=gl();return C.jsxs(SI,{children:[e.map(function({id:t,title:n,description:r,action:o,...a}){return C.jsxs(rC,{...a,children:[C.jsxs("div",{className:"grid gap-1",children:[n&&C.jsx(aC,{children:n}),r&&C.jsx(iC,{children:r})]}),o,C.jsx(oC,{})]},t)}),C.jsx(nC,{})]})}var X0=["light","dark"],DI="(prefers-color-scheme: dark)",II=R.createContext(void 0),TI={setTheme:e=>{},themes:[]},PI=()=>{var e;return(e=R.useContext(II))!=null?e:TI};R.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:a,value:i,attrs:s,nonce:u})=>{let l=a==="system",c=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(p=>`'${p}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?X0.includes(a)&&a?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${a}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(p,m=!1,g=!0)=>{let v=i?i[p]:p,y=m?p+"|| ''":`'${v}'`,x="";return o&&g&&!m&&X0.includes(p)&&(x+=`d.style.colorScheme = '${p}';`),n==="class"?m||v?x+=`c.add(${y})`:x+="null":v&&(x+=`d[s](n,${y})`),x},h=e?`!function(){${c}${f(e)}}()`:r?`!function(){try{${c}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${l})){var t='${DI}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${f(i?"x[e]":"e",!0)}}${l?"":"else{"+f(a,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${f(i?"x[e]":"e",!0)}}else{${f(a,!1,!1)};}${d}}catch(t){}}();`;return R.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:h}})});var AI=e=>{switch(e){case"success":return OI;case"info":return BI;case"warning":return LI;case"error":return jI;default:return null}},MI=Array(12).fill(0),FI=({visible:e})=>te.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},te.createElement("div",{className:"sonner-spinner"},MI.map((t,n)=>te.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),OI=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),LI=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),BI=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),jI=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),WI=()=>{let[e,t]=te.useState(document.hidden);return te.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},iv=1,zI=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...o}=t,a=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:iv++,i=this.toasts.find(u=>u.id===a),s=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(u=>u.id===a?(this.publish({...u,...t,id:a,title:r}),{...u,...t,id:a,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:a}),a},this.dismiss=t=>(t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=t instanceof Promise?t:t(),a=r!==void 0;return o.then(async i=>{if(UI(i)&&!i.ok){a=!1;let s=typeof n.error=="function"?await n.error(`HTTP error! status: ${i.status}`):n.error,u=typeof n.description=="function"?await n.description(`HTTP error! status: ${i.status}`):n.description;this.create({id:r,type:"error",message:s,description:u})}else if(n.success!==void 0){a=!1;let s=typeof n.success=="function"?await n.success(i):n.success,u=typeof n.description=="function"?await n.description(i):n.description;this.create({id:r,type:"success",message:s,description:u})}}).catch(async i=>{if(n.error!==void 0){a=!1;let s=typeof n.error=="function"?await n.error(i):n.error,u=typeof n.description=="function"?await n.description(i):n.description;this.create({id:r,type:"error",message:s,description:u})}}).finally(()=>{var i;a&&(this.dismiss(r),r=void 0),(i=n.finally)==null||i.call(n)}),r},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||iv++;return this.create({jsx:t(r),id:r,...n}),r},this.subscribers=[],this.toasts=[]}},Ln=new zI,$I=(e,t)=>{let n=(t==null?void 0:t.id)||iv++;return Ln.addToast({title:e,...t,id:n}),n},UI=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",VI=$I,HI=()=>Ln.toasts;Object.assign(VI,{success:Ln.success,info:Ln.info,warning:Ln.warning,error:Ln.error,custom:Ln.custom,message:Ln.message,promise:Ln.promise,dismiss:Ln.dismiss,loading:Ln.loading},{getHistory:HI});function GI(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}GI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function rc(e){return e.label!==void 0}var qI=3,KI="32px",YI=4e3,XI=356,QI=14,JI=20,ZI=200;function eT(...e){return e.filter(Boolean).join(" ")}var tT=e=>{var t,n,r,o,a,i,s,u,l,c;let{invert:d,toast:f,unstyled:h,interacting:p,setHeights:m,visibleToasts:g,heights:v,index:y,toasts:x,expanded:w,removeToast:b,defaultRichColors:E,closeButton:S,style:_,cancelButtonStyle:k,actionButtonStyle:N,className:A="",descriptionClassName:T="",duration:L,position:M,gap:$,loadingIcon:U,expandByDefault:j,classNames:D,icons:F,closeButtonAriaLabel:z="Close toast",pauseWhenPageIsHidden:H,cn:X}=e,[ee,le]=te.useState(!1),[ye,se]=te.useState(!1),[xe,Ee]=te.useState(!1),[be,We]=te.useState(!1),[Se,Ae]=te.useState(0),[De,Ue]=te.useState(0),Ge=te.useRef(null),Be=te.useRef(null),Ut=y===0,Xt=y+1<=g,ze=f.type,bn=f.dismissible!==!1,Cn=f.className||"",O=f.descriptionClassName||"",V=te.useMemo(()=>v.findIndex(ke=>ke.toastId===f.id)||0,[v,f.id]),K=te.useMemo(()=>{var ke;return(ke=f.closeButton)!=null?ke:S},[f.closeButton,S]),oe=te.useMemo(()=>f.duration||L||YI,[f.duration,L]),re=te.useRef(0),Z=te.useRef(0),ae=te.useRef(0),Ne=te.useRef(null),[nt,Et]=M.split("-"),bi=te.useMemo(()=>v.reduce((ke,rt,Je)=>Je>=V?ke:ke+rt.height,0),[v,V]),Mr=WI(),fo=f.invert||d,ho=ze==="loading";Z.current=te.useMemo(()=>V*$+bi,[V,bi]),te.useEffect(()=>{le(!0)},[]),te.useLayoutEffect(()=>{if(!ee)return;let ke=Be.current,rt=ke.style.height;ke.style.height="auto";let Je=ke.getBoundingClientRect().height;ke.style.height=rt,Ue(Je),m(Fr=>Fr.find(Or=>Or.toastId===f.id)?Fr.map(Or=>Or.toastId===f.id?{...Or,height:Je}:Or):[{toastId:f.id,height:Je,position:f.position},...Fr])},[ee,f.title,f.description,m,f.id]);let fr=te.useCallback(()=>{se(!0),Ae(Z.current),m(ke=>ke.filter(rt=>rt.toastId!==f.id)),setTimeout(()=>{b(f)},ZI)},[f,b,m,Z]);te.useEffect(()=>{if(f.promise&&ze==="loading"||f.duration===1/0||f.type==="loading")return;let ke,rt=oe;return w||p||H&&Mr?(()=>{if(ae.current<re.current){let Je=new Date().getTime()-re.current;rt=rt-Je}ae.current=new Date().getTime()})():rt!==1/0&&(re.current=new Date().getTime(),ke=setTimeout(()=>{var Je;(Je=f.onAutoClose)==null||Je.call(f,f),fr()},rt)),()=>clearTimeout(ke)},[w,p,j,f,oe,fr,f.promise,ze,H,Mr]),te.useEffect(()=>{let ke=Be.current;if(ke){let rt=ke.getBoundingClientRect().height;return Ue(rt),m(Je=>[{toastId:f.id,height:rt,position:f.position},...Je]),()=>m(Je=>Je.filter(Fr=>Fr.toastId!==f.id))}},[m,f.id]),te.useEffect(()=>{f.delete&&fr()},[fr,f.delete]);function Wf(){return F!=null&&F.loading?te.createElement("div",{className:"sonner-loader","data-visible":ze==="loading"},F.loading):U?te.createElement("div",{className:"sonner-loader","data-visible":ze==="loading"},U):te.createElement(FI,{visible:ze==="loading"})}return te.createElement("li",{"aria-live":f.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Be,className:X(A,Cn,D==null?void 0:D.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,D==null?void 0:D.default,D==null?void 0:D[ze],(n=f==null?void 0:f.classNames)==null?void 0:n[ze]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:E,"data-styled":!(f.jsx||f.unstyled||h),"data-mounted":ee,"data-promise":!!f.promise,"data-removed":ye,"data-visible":Xt,"data-y-position":nt,"data-x-position":Et,"data-index":y,"data-front":Ut,"data-swiping":xe,"data-dismissible":bn,"data-type":ze,"data-invert":fo,"data-swipe-out":be,"data-expanded":!!(w||j&&ee),style:{"--index":y,"--toasts-before":y,"--z-index":x.length-y,"--offset":`${ye?Se:Z.current}px`,"--initial-height":j?"auto":`${De}px`,..._,...f.style},onPointerDown:ke=>{ho||!bn||(Ge.current=new Date,Ae(Z.current),ke.target.setPointerCapture(ke.pointerId),ke.target.tagName!=="BUTTON"&&(Ee(!0),Ne.current={x:ke.clientX,y:ke.clientY}))},onPointerUp:()=>{var ke,rt,Je,Fr;if(be||!bn)return;Ne.current=null;let Or=Number(((ke=Be.current)==null?void 0:ke.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Ol=new Date().getTime()-((rt=Ge.current)==null?void 0:rt.getTime()),wk=Math.abs(Or)/Ol;if(Math.abs(Or)>=JI||wk>.11){Ae(Z.current),(Je=f.onDismiss)==null||Je.call(f,f),fr(),We(!0);return}(Fr=Be.current)==null||Fr.style.setProperty("--swipe-amount","0px"),Ee(!1)},onPointerMove:ke=>{var rt;if(!Ne.current||!bn)return;let Je=ke.clientY-Ne.current.y,Fr=ke.clientX-Ne.current.x,Or=(nt==="top"?Math.min:Math.max)(0,Je),Ol=ke.pointerType==="touch"?10:2;Math.abs(Or)>Ol?(rt=Be.current)==null||rt.style.setProperty("--swipe-amount",`${Je}px`):Math.abs(Fr)>Ol&&(Ne.current=null)}},K&&!f.jsx?te.createElement("button",{"aria-label":z,"data-disabled":ho,"data-close-button":!0,onClick:ho||!bn?()=>{}:()=>{var ke;fr(),(ke=f.onDismiss)==null||ke.call(f,f)},className:X(D==null?void 0:D.closeButton,(o=f==null?void 0:f.classNames)==null?void 0:o.closeButton)},te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},te.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),te.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,f.jsx||te.isValidElement(f.title)?f.jsx||f.title:te.createElement(te.Fragment,null,ze||f.icon||f.promise?te.createElement("div",{"data-icon":"",className:X(D==null?void 0:D.icon,(a=f==null?void 0:f.classNames)==null?void 0:a.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||Wf():null,f.type!=="loading"?f.icon||(F==null?void 0:F[ze])||AI(ze):null):null,te.createElement("div",{"data-content":"",className:X(D==null?void 0:D.content,(i=f==null?void 0:f.classNames)==null?void 0:i.content)},te.createElement("div",{"data-title":"",className:X(D==null?void 0:D.title,(s=f==null?void 0:f.classNames)==null?void 0:s.title)},f.title),f.description?te.createElement("div",{"data-description":"",className:X(T,O,D==null?void 0:D.description,(u=f==null?void 0:f.classNames)==null?void 0:u.description)},f.description):null),te.isValidElement(f.cancel)?f.cancel:f.cancel&&rc(f.cancel)?te.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||k,onClick:ke=>{var rt,Je;rc(f.cancel)&&bn&&((Je=(rt=f.cancel).onClick)==null||Je.call(rt,ke),fr())},className:X(D==null?void 0:D.cancelButton,(l=f==null?void 0:f.classNames)==null?void 0:l.cancelButton)},f.cancel.label):null,te.isValidElement(f.action)?f.action:f.action&&rc(f.action)?te.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||N,onClick:ke=>{var rt,Je;rc(f.action)&&(ke.defaultPrevented||((Je=(rt=f.action).onClick)==null||Je.call(rt,ke),fr()))},className:X(D==null?void 0:D.actionButton,(c=f==null?void 0:f.classNames)==null?void 0:c.actionButton)},f.action.label):null))};function Q0(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var nT=e=>{let{invert:t,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:a,className:i,offset:s,theme:u="light",richColors:l,duration:c,style:d,visibleToasts:f=qI,toastOptions:h,dir:p=Q0(),gap:m=QI,loadingIcon:g,icons:v,containerAriaLabel:y="Notifications",pauseWhenPageIsHidden:x,cn:w=eT}=e,[b,E]=te.useState([]),S=te.useMemo(()=>Array.from(new Set([n].concat(b.filter(H=>H.position).map(H=>H.position)))),[b,n]),[_,k]=te.useState([]),[N,A]=te.useState(!1),[T,L]=te.useState(!1),[M,$]=te.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=te.useRef(null),j=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=te.useRef(null),F=te.useRef(!1),z=te.useCallback(H=>{var X;(X=b.find(ee=>ee.id===H.id))!=null&&X.delete||Ln.dismiss(H.id),E(ee=>ee.filter(({id:le})=>le!==H.id))},[b]);return te.useEffect(()=>Ln.subscribe(H=>{if(H.dismiss){E(X=>X.map(ee=>ee.id===H.id?{...ee,delete:!0}:ee));return}setTimeout(()=>{g2.flushSync(()=>{E(X=>{let ee=X.findIndex(le=>le.id===H.id);return ee!==-1?[...X.slice(0,ee),{...X[ee],...H},...X.slice(ee+1)]:[H,...X]})})})}),[]),te.useEffect(()=>{if(u!=="system"){$(u);return}u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?$("dark"):$("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:H})=>{$(H?"dark":"light")})},[u]),te.useEffect(()=>{b.length<=1&&A(!1)},[b]),te.useEffect(()=>{let H=X=>{var ee,le;r.every(ye=>X[ye]||X.code===ye)&&(A(!0),(ee=U.current)==null||ee.focus()),X.code==="Escape"&&(document.activeElement===U.current||(le=U.current)!=null&&le.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",H),()=>document.removeEventListener("keydown",H)},[r]),te.useEffect(()=>{if(U.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,F.current=!1)}},[U.current]),b.length?te.createElement("section",{"aria-label":`${y} ${j}`,tabIndex:-1},S.map((H,X)=>{var ee;let[le,ye]=H.split("-");return te.createElement("ol",{key:H,dir:p==="auto"?Q0():p,tabIndex:-1,ref:U,className:i,"data-sonner-toaster":!0,"data-theme":M,"data-y-position":le,"data-x-position":ye,style:{"--front-toast-height":`${((ee=_[0])==null?void 0:ee.height)||0}px`,"--offset":typeof s=="number"?`${s}px`:s||KI,"--width":`${XI}px`,"--gap":`${m}px`,...d},onBlur:se=>{F.current&&!se.currentTarget.contains(se.relatedTarget)&&(F.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||F.current||(F.current=!0,D.current=se.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{T||A(!1)},onPointerDown:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||L(!0)},onPointerUp:()=>L(!1)},b.filter(se=>!se.position&&X===0||se.position===H).map((se,xe)=>{var Ee,be;return te.createElement(tT,{key:se.id,icons:v,index:xe,toast:se,defaultRichColors:l,duration:(Ee=h==null?void 0:h.duration)!=null?Ee:c,className:h==null?void 0:h.className,descriptionClassName:h==null?void 0:h.descriptionClassName,invert:t,visibleToasts:f,closeButton:(be=h==null?void 0:h.closeButton)!=null?be:a,interacting:T,position:H,style:h==null?void 0:h.style,unstyled:h==null?void 0:h.unstyled,classNames:h==null?void 0:h.classNames,cancelButtonStyle:h==null?void 0:h.cancelButtonStyle,actionButtonStyle:h==null?void 0:h.actionButtonStyle,removeToast:z,toasts:b.filter(We=>We.position==se.position),heights:_.filter(We=>We.position==se.position),setHeights:k,expandByDefault:o,gap:m,loadingIcon:g,expanded:N,pauseWhenPageIsHidden:x,cn:w})}))})):null};const rT=({...e})=>{const{theme:t="system"}=PI();return C.jsx(nT,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var oT=pw.useId||(()=>{}),aT=0;function sC(e){const[t,n]=R.useState(oT());return Ea(()=>{e||n(r=>r??String(aT++))},[e]),e||(t?`radix-${t}`:"")}const iT=["top","right","bottom","left"],_a=Math.min,Wn=Math.max,cd=Math.round,oc=Math.floor,Sa=e=>({x:e,y:e}),sT={left:"right",right:"left",bottom:"top",top:"bottom"},uT={start:"end",end:"start"};function sv(e,t,n){return Wn(e,_a(t,n))}function Io(e,t){return typeof e=="function"?e(t):e}function To(e){return e.split("-")[0]}function js(e){return e.split("-")[1]}function Qm(e){return e==="x"?"y":"x"}function Jm(e){return e==="y"?"height":"width"}function ka(e){return["top","bottom"].includes(To(e))?"y":"x"}function Zm(e){return Qm(ka(e))}function lT(e,t,n){n===void 0&&(n=!1);const r=js(e),o=Zm(e),a=Jm(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=dd(i)),[i,dd(i)]}function cT(e){const t=dd(e);return[uv(e),t,uv(t)]}function uv(e){return e.replace(/start|end/g,t=>uT[t])}function dT(e,t,n){const r=["left","right"],o=["right","left"],a=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?a:i;default:return[]}}function fT(e,t,n,r){const o=js(e);let a=dT(To(e),n==="start",r);return o&&(a=a.map(i=>i+"-"+o),t&&(a=a.concat(a.map(uv)))),a}function dd(e){return e.replace(/left|right|bottom|top/g,t=>sT[t])}function hT(e){return{top:0,right:0,bottom:0,left:0,...e}}function uC(e){return typeof e!="number"?hT(e):{top:e,right:e,bottom:e,left:e}}function fd(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function J0(e,t,n){let{reference:r,floating:o}=e;const a=ka(t),i=Zm(t),s=Jm(i),u=To(t),l=a==="y",c=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:c,y:r.y-o.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(js(t)){case"start":h[i]-=f*(n&&l?-1:1);break;case"end":h[i]+=f*(n&&l?-1:1);break}return h}const pT=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:a=[],platform:i}=n,s=a.filter(Boolean),u=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:c,y:d}=J0(l,r,u),f=r,h={},p=0;for(let m=0;m<s.length;m++){const{name:g,fn:v}=s[m],{x:y,y:x,data:w,reset:b}=await v({x:c,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:l,platform:i,elements:{reference:e,floating:t}});c=y??c,d=x??d,h={...h,[g]:{...h[g],...w}},b&&p<=50&&(p++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(l=b.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):b.rects),{x:c,y:d}=J0(l,f,u)),m=-1)}return{x:c,y:d,placement:f,strategy:o,middlewareData:h}};async function Yu(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:a,rects:i,elements:s,strategy:u}=e,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Io(t,e),p=uC(h),g=s[f?d==="floating"?"reference":"floating":d],v=fd(await a.getClippingRect({element:(n=await(a.isElement==null?void 0:a.isElement(g)))==null||n?g:g.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,x=await(a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating)),w=await(a.isElement==null?void 0:a.isElement(x))?await(a.getScale==null?void 0:a.getScale(x))||{x:1,y:1}:{x:1,y:1},b=fd(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(v.top-b.top+p.top)/w.y,bottom:(b.bottom-v.bottom+p.bottom)/w.y,left:(v.left-b.left+p.left)/w.x,right:(b.right-v.right+p.right)/w.x}}const vT=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:a,platform:i,elements:s,middlewareData:u}=t,{element:l,padding:c=0}=Io(e,t)||{};if(l==null)return{};const d=uC(c),f={x:n,y:r},h=Zm(o),p=Jm(h),m=await i.getDimensions(l),g=h==="y",v=g?"top":"left",y=g?"bottom":"right",x=g?"clientHeight":"clientWidth",w=a.reference[p]+a.reference[h]-f[h]-a.floating[p],b=f[h]-a.reference[h],E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let S=E?E[x]:0;(!S||!await(i.isElement==null?void 0:i.isElement(E)))&&(S=s.floating[x]||a.floating[p]);const _=w/2-b/2,k=S/2-m[p]/2-1,N=_a(d[v],k),A=_a(d[y],k),T=N,L=S-m[p]-A,M=S/2-m[p]/2+_,$=sv(T,M,L),U=!u.arrow&&js(o)!=null&&M!==$&&a.reference[p]/2-(M<T?N:A)-m[p]/2<0,j=U?M<T?M-T:M-L:0;return{[h]:f[h]+j,data:{[h]:$,centerOffset:M-$-j,...U&&{alignmentOffset:j}},reset:U}}}),mT=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:a,rects:i,initialPlacement:s,platform:u,elements:l}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Io(e,t);if((n=a.arrow)!=null&&n.alignmentOffset)return{};const v=To(o),y=ka(s),x=To(s)===s,w=await(u.isRTL==null?void 0:u.isRTL(l.floating)),b=f||(x||!m?[dd(s)]:cT(s)),E=p!=="none";!f&&E&&b.push(...fT(s,m,p,w));const S=[s,...b],_=await Yu(t,g),k=[];let N=((r=a.flip)==null?void 0:r.overflows)||[];if(c&&k.push(_[v]),d){const M=lT(o,i,w);k.push(_[M[0]],_[M[1]])}if(N=[...N,{placement:o,overflows:k}],!k.every(M=>M<=0)){var A,T;const M=(((A=a.flip)==null?void 0:A.index)||0)+1,$=S[M];if($)return{data:{index:M,overflows:N},reset:{placement:$}};let U=(T=N.filter(j=>j.overflows[0]<=0).sort((j,D)=>j.overflows[1]-D.overflows[1])[0])==null?void 0:T.placement;if(!U)switch(h){case"bestFit":{var L;const j=(L=N.filter(D=>{if(E){const F=ka(D.placement);return F===y||F==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(F=>F>0).reduce((F,z)=>F+z,0)]).sort((D,F)=>D[1]-F[1])[0])==null?void 0:L[0];j&&(U=j);break}case"initialPlacement":U=s;break}if(o!==U)return{reset:{placement:U}}}return{}}}};function Z0(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ex(e){return iT.some(t=>e[t]>=0)}const gT=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=Io(e,t);switch(r){case"referenceHidden":{const a=await Yu(t,{...o,elementContext:"reference"}),i=Z0(a,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:ex(i)}}}case"escaped":{const a=await Yu(t,{...o,altBoundary:!0}),i=Z0(a,n.floating);return{data:{escapedOffsets:i,escaped:ex(i)}}}default:return{}}}}};async function yT(e,t){const{placement:n,platform:r,elements:o}=e,a=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=To(n),s=js(n),u=ka(n)==="y",l=["left","top"].includes(i)?-1:1,c=a&&u?-1:1,d=Io(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof p=="number"&&(h=s==="end"?p*-1:p),u?{x:h*c,y:f*l}:{x:f*l,y:h*c}}const xT=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:a,placement:i,middlewareData:s}=t,u=await yT(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:a+u.y,data:{...u,placement:i}}}}},wT=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:s={fn:g=>{let{x:v,y}=g;return{x:v,y}}},...u}=Io(e,t),l={x:n,y:r},c=await Yu(t,u),d=ka(To(o)),f=Qm(d);let h=l[f],p=l[d];if(a){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=h+c[g],x=h-c[v];h=sv(y,h,x)}if(i){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=p+c[g],x=p-c[v];p=sv(y,p,x)}const m=s.fn({...t,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[f]:a,[d]:i}}}}}},bT=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:a,middlewareData:i}=t,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=Io(e,t),c={x:n,y:r},d=ka(o),f=Qm(d);let h=c[f],p=c[d];const m=Io(s,t),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(u){const x=f==="y"?"height":"width",w=a.reference[f]-a.floating[x]+g.mainAxis,b=a.reference[f]+a.reference[x]-g.mainAxis;h<w?h=w:h>b&&(h=b)}if(l){var v,y;const x=f==="y"?"width":"height",w=["top","left"].includes(To(o)),b=a.reference[d]-a.floating[x]+(w&&((v=i.offset)==null?void 0:v[d])||0)+(w?0:g.crossAxis),E=a.reference[d]+a.reference[x]+(w?0:((y=i.offset)==null?void 0:y[d])||0)-(w?g.crossAxis:0);p<b?p=b:p>E&&(p=E)}return{[f]:h,[d]:p}}}},CT=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:a,platform:i,elements:s}=t,{apply:u=()=>{},...l}=Io(e,t),c=await Yu(t,l),d=To(o),f=js(o),h=ka(o)==="y",{width:p,height:m}=a.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=f===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(v=d,g=f==="end"?"top":"bottom");const y=m-c.top-c.bottom,x=p-c.left-c.right,w=_a(m-c[g],y),b=_a(p-c[v],x),E=!t.middlewareData.shift;let S=w,_=b;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(_=x),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(S=y),E&&!f){const N=Wn(c.left,0),A=Wn(c.right,0),T=Wn(c.top,0),L=Wn(c.bottom,0);h?_=p-2*(N!==0||A!==0?N+A:Wn(c.left,c.right)):S=m-2*(T!==0||L!==0?T+L:Wn(c.top,c.bottom))}await u({...t,availableWidth:_,availableHeight:S});const k=await i.getDimensions(s.floating);return p!==k.width||m!==k.height?{reset:{rects:!0}}:{}}}};function df(){return typeof window<"u"}function Ws(e){return lC(e)?(e.nodeName||"").toLowerCase():"#document"}function qn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function io(e){var t;return(t=(lC(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function lC(e){return df()?e instanceof Node||e instanceof qn(e).Node:!1}function Nr(e){return df()?e instanceof Element||e instanceof qn(e).Element:!1}function ro(e){return df()?e instanceof HTMLElement||e instanceof qn(e).HTMLElement:!1}function tx(e){return!df()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof qn(e).ShadowRoot}function yl(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=Dr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function ET(e){return["table","td","th"].includes(Ws(e))}function ff(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function eg(e){const t=tg(),n=Nr(e)?Dr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function _T(e){let t=Ra(e);for(;ro(t)&&!Rs(t);){if(eg(t))return t;if(ff(t))return null;t=Ra(t)}return null}function tg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Rs(e){return["html","body","#document"].includes(Ws(e))}function Dr(e){return qn(e).getComputedStyle(e)}function hf(e){return Nr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ra(e){if(Ws(e)==="html")return e;const t=e.assignedSlot||e.parentNode||tx(e)&&e.host||io(e);return tx(t)?t.host:t}function cC(e){const t=Ra(e);return Rs(t)?e.ownerDocument?e.ownerDocument.body:e.body:ro(t)&&yl(t)?t:cC(t)}function Xu(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=cC(e),a=o===((r=e.ownerDocument)==null?void 0:r.body),i=qn(o);if(a){const s=lv(i);return t.concat(i,i.visualViewport||[],yl(o)?o:[],s&&n?Xu(s):[])}return t.concat(o,Xu(o,[],n))}function lv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function dC(e){const t=Dr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=ro(e),a=o?e.offsetWidth:n,i=o?e.offsetHeight:r,s=cd(n)!==a||cd(r)!==i;return s&&(n=a,r=i),{width:n,height:r,$:s}}function ng(e){return Nr(e)?e:e.contextElement}function es(e){const t=ng(e);if(!ro(t))return Sa(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:a}=dC(t);let i=(a?cd(n.width):n.width)/r,s=(a?cd(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const ST=Sa(0);function fC(e){const t=qn(e);return!tg()||!t.visualViewport?ST:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function kT(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==qn(e)?!1:t}function ui(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),a=ng(e);let i=Sa(1);t&&(r?Nr(r)&&(i=es(r)):i=es(e));const s=kT(a,n,r)?fC(a):Sa(0);let u=(o.left+s.x)/i.x,l=(o.top+s.y)/i.y,c=o.width/i.x,d=o.height/i.y;if(a){const f=qn(a),h=r&&Nr(r)?qn(r):r;let p=f,m=lv(p);for(;m&&r&&h!==p;){const g=es(m),v=m.getBoundingClientRect(),y=Dr(m),x=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,w=v.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,l*=g.y,c*=g.x,d*=g.y,u+=x,l+=w,p=qn(m),m=lv(p)}}return fd({width:c,height:d,x:u,y:l})}function RT(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const a=o==="fixed",i=io(r),s=t?ff(t.floating):!1;if(r===i||s&&a)return n;let u={scrollLeft:0,scrollTop:0},l=Sa(1);const c=Sa(0),d=ro(r);if((d||!d&&!a)&&((Ws(r)!=="body"||yl(i))&&(u=hf(r)),ro(r))){const f=ui(r);l=es(r),c.x=f.x+r.clientLeft,c.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-u.scrollLeft*l.x+c.x,y:n.y*l.y-u.scrollTop*l.y+c.y}}function NT(e){return Array.from(e.getClientRects())}function cv(e,t){const n=hf(e).scrollLeft;return t?t.left+n:ui(io(e)).left+n}function DT(e){const t=io(e),n=hf(e),r=e.ownerDocument.body,o=Wn(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=Wn(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+cv(e);const s=-n.scrollTop;return Dr(r).direction==="rtl"&&(i+=Wn(t.clientWidth,r.clientWidth)-o),{width:o,height:a,x:i,y:s}}function IT(e,t){const n=qn(e),r=io(e),o=n.visualViewport;let a=r.clientWidth,i=r.clientHeight,s=0,u=0;if(o){a=o.width,i=o.height;const l=tg();(!l||l&&t==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:a,height:i,x:s,y:u}}function TT(e,t){const n=ui(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,a=ro(e)?es(e):Sa(1),i=e.clientWidth*a.x,s=e.clientHeight*a.y,u=o*a.x,l=r*a.y;return{width:i,height:s,x:u,y:l}}function nx(e,t,n){let r;if(t==="viewport")r=IT(e,n);else if(t==="document")r=DT(io(e));else if(Nr(t))r=TT(t,n);else{const o=fC(e);r={...t,x:t.x-o.x,y:t.y-o.y}}return fd(r)}function hC(e,t){const n=Ra(e);return n===t||!Nr(n)||Rs(n)?!1:Dr(n).position==="fixed"||hC(n,t)}function PT(e,t){const n=t.get(e);if(n)return n;let r=Xu(e,[],!1).filter(s=>Nr(s)&&Ws(s)!=="body"),o=null;const a=Dr(e).position==="fixed";let i=a?Ra(e):e;for(;Nr(i)&&!Rs(i);){const s=Dr(i),u=eg(i);!u&&s.position==="fixed"&&(o=null),(a?!u&&!o:!u&&s.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||yl(i)&&!u&&hC(e,i))?r=r.filter(c=>c!==i):o=s,i=Ra(i)}return t.set(e,r),r}function AT(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[...n==="clippingAncestors"?ff(t)?[]:PT(t,this._c):[].concat(n),r],s=i[0],u=i.reduce((l,c)=>{const d=nx(t,c,o);return l.top=Wn(d.top,l.top),l.right=_a(d.right,l.right),l.bottom=_a(d.bottom,l.bottom),l.left=Wn(d.left,l.left),l},nx(t,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function MT(e){const{width:t,height:n}=dC(e);return{width:t,height:n}}function FT(e,t,n){const r=ro(t),o=io(t),a=n==="fixed",i=ui(e,!0,a,t);let s={scrollLeft:0,scrollTop:0};const u=Sa(0);if(r||!r&&!a)if((Ws(t)!=="body"||yl(o))&&(s=hf(t)),r){const h=ui(t,!0,a,t);u.x=h.x+t.clientLeft,u.y=h.y+t.clientTop}else o&&(u.x=cv(o));let l=0,c=0;if(o&&!r&&!a){const h=o.getBoundingClientRect();c=h.top+s.scrollTop,l=h.left+s.scrollLeft-cv(o,h)}const d=i.left+s.scrollLeft-u.x-l,f=i.top+s.scrollTop-u.y-c;return{x:d,y:f,width:i.width,height:i.height}}function yh(e){return Dr(e).position==="static"}function rx(e,t){if(!ro(e)||Dr(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return io(e)===n&&(n=n.ownerDocument.body),n}function pC(e,t){const n=qn(e);if(ff(e))return n;if(!ro(e)){let o=Ra(e);for(;o&&!Rs(o);){if(Nr(o)&&!yh(o))return o;o=Ra(o)}return n}let r=rx(e,t);for(;r&&ET(r)&&yh(r);)r=rx(r,t);return r&&Rs(r)&&yh(r)&&!eg(r)?n:r||_T(e)||n}const OT=async function(e){const t=this.getOffsetParent||pC,n=this.getDimensions,r=await n(e.floating);return{reference:FT(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function LT(e){return Dr(e).direction==="rtl"}const BT={convertOffsetParentRelativeRectToViewportRelativeRect:RT,getDocumentElement:io,getClippingRect:AT,getOffsetParent:pC,getElementRects:OT,getClientRects:NT,getDimensions:MT,getScale:es,isElement:Nr,isRTL:LT};function jT(e,t){let n=null,r;const o=io(e);function a(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),a();const{left:l,top:c,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const h=oc(c),p=oc(o.clientWidth-(l+d)),m=oc(o.clientHeight-(c+f)),g=oc(l),y={rootMargin:-h+"px "+-p+"px "+-m+"px "+-g+"px",threshold:Wn(0,_a(1,u))||1};let x=!0;function w(b){const E=b[0].intersectionRatio;if(E!==u){if(!x)return i();E?i(!1,E):r=setTimeout(()=>{i(!1,1e-7)},1e3)}x=!1}try{n=new IntersectionObserver(w,{...y,root:o.ownerDocument})}catch{n=new IntersectionObserver(w,y)}n.observe(e)}return i(!0),a}function WT(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=ng(e),c=o||a?[...l?Xu(l):[],...Xu(t)]:[];c.forEach(v=>{o&&v.addEventListener("scroll",n,{passive:!0}),a&&v.addEventListener("resize",n)});const d=l&&s?jT(l,n):null;let f=-1,h=null;i&&(h=new ResizeObserver(v=>{let[y]=v;y&&y.target===l&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(t)})),n()}),l&&!u&&h.observe(l),h.observe(t));let p,m=u?ui(e):null;u&&g();function g(){const v=ui(e);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&n(),m=v,p=requestAnimationFrame(g)}return n(),()=>{var v;c.forEach(y=>{o&&y.removeEventListener("scroll",n),a&&y.removeEventListener("resize",n)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,u&&cancelAnimationFrame(p)}}const zT=xT,$T=wT,UT=mT,VT=CT,HT=gT,ox=vT,GT=bT,qT=(e,t,n)=>{const r=new Map,o={platform:BT,...n},a={...o.platform,_c:r};return pT(e,t,{...o,platform:a})};var Oc=typeof document<"u"?R.useLayoutEffect:R.useEffect;function hd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!hd(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const a=o[r];if(!(a==="_owner"&&e.$$typeof)&&!hd(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function vC(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ax(e,t){const n=vC(e);return Math.round(t*n)/n}function xh(e){const t=R.useRef(e);return Oc(()=>{t.current=e}),t}function KT(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:a,floating:i}={},transform:s=!0,whileElementsMounted:u,open:l}=e,[c,d]=R.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=R.useState(r);hd(f,r)||h(r);const[p,m]=R.useState(null),[g,v]=R.useState(null),y=R.useCallback(D=>{D!==E.current&&(E.current=D,m(D))},[]),x=R.useCallback(D=>{D!==S.current&&(S.current=D,v(D))},[]),w=a||p,b=i||g,E=R.useRef(null),S=R.useRef(null),_=R.useRef(c),k=u!=null,N=xh(u),A=xh(o),T=xh(l),L=R.useCallback(()=>{if(!E.current||!S.current)return;const D={placement:t,strategy:n,middleware:f};A.current&&(D.platform=A.current),qT(E.current,S.current,D).then(F=>{const z={...F,isPositioned:T.current!==!1};M.current&&!hd(_.current,z)&&(_.current=z,ml.flushSync(()=>{d(z)}))})},[f,t,n,A,T]);Oc(()=>{l===!1&&_.current.isPositioned&&(_.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const M=R.useRef(!1);Oc(()=>(M.current=!0,()=>{M.current=!1}),[]),Oc(()=>{if(w&&(E.current=w),b&&(S.current=b),w&&b){if(N.current)return N.current(w,b,L);L()}},[w,b,L,N,k]);const $=R.useMemo(()=>({reference:E,floating:S,setReference:y,setFloating:x}),[y,x]),U=R.useMemo(()=>({reference:w,floating:b}),[w,b]),j=R.useMemo(()=>{const D={position:n,left:0,top:0};if(!U.floating)return D;const F=ax(U.floating,c.x),z=ax(U.floating,c.y);return s?{...D,transform:"translate("+F+"px, "+z+"px)",...vC(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:F,top:z}},[n,s,U.floating,c.x,c.y]);return R.useMemo(()=>({...c,update:L,refs:$,elements:U,floatingStyles:j}),[c,L,$,U,j])}const YT=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?ox({element:r.current,padding:o}).fn(n):{}:r?ox({element:r,padding:o}).fn(n):{}}}},XT=(e,t)=>({...zT(e),options:[e,t]}),QT=(e,t)=>({...$T(e),options:[e,t]}),JT=(e,t)=>({...GT(e),options:[e,t]}),ZT=(e,t)=>({...UT(e),options:[e,t]}),eP=(e,t)=>({...VT(e),options:[e,t]}),tP=(e,t)=>({...HT(e),options:[e,t]}),nP=(e,t)=>({...YT(e),options:[e,t]});var rP="Arrow",mC=R.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...a}=e;return C.jsx(Nt.svg,{...a,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:C.jsx("polygon",{points:"0,0 30,0 15,10"})})});mC.displayName=rP;var oP=mC;function aP(e,t=[]){let n=[];function r(a,i){const s=R.createContext(i),u=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...p}=d,m=(f==null?void 0:f[e][u])||s,g=R.useMemo(()=>p,Object.values(p));return C.jsx(m.Provider,{value:g,children:h})}function c(d,f){const h=(f==null?void 0:f[e][u])||s,p=R.useContext(h);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,c]}const o=()=>{const a=n.map(i=>R.createContext(i));return function(s){const u=(s==null?void 0:s[e])||a;return R.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,iP(o,...t)]}function iP(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(a){const i=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(a)[`__scope${l}`];return{...s,...d}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function sP(e){const[t,n]=R.useState(void 0);return Ea(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const a=o[0];let i,s;if("borderBoxSize"in a){const u=a.borderBoxSize,l=Array.isArray(u)?u[0]:u;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var gC="Popper",[yC,xC]=aP(gC),[V$,wC]=yC(gC),bC="PopperAnchor",CC=R.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,a=wC(bC,n),i=R.useRef(null),s=cr(t,i);return R.useEffect(()=>{a.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:C.jsx(Nt.div,{...o,ref:s})});CC.displayName=bC;var rg="PopperContent",[uP,lP]=yC(rg),EC=R.forwardRef((e,t)=>{var xe,Ee,be,We,Se,Ae;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:a="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:l=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:p,...m}=e,g=wC(rg,n),[v,y]=R.useState(null),x=cr(t,De=>y(De)),[w,b]=R.useState(null),E=sP(w),S=(E==null?void 0:E.width)??0,_=(E==null?void 0:E.height)??0,k=r+(a!=="center"?"-"+a:""),N=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},A=Array.isArray(l)?l:[l],T=A.length>0,L={padding:N,boundary:A.filter(dP),altBoundary:T},{refs:M,floatingStyles:$,placement:U,isPositioned:j,middlewareData:D}=KT({strategy:"fixed",placement:k,whileElementsMounted:(...De)=>WT(...De,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[XT({mainAxis:o+_,alignmentAxis:i}),u&&QT({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?JT():void 0,...L}),u&&ZT({...L}),eP({...L,apply:({elements:De,rects:Ue,availableWidth:Ge,availableHeight:Be})=>{const{width:Ut,height:Xt}=Ue.reference,ze=De.floating.style;ze.setProperty("--radix-popper-available-width",`${Ge}px`),ze.setProperty("--radix-popper-available-height",`${Be}px`),ze.setProperty("--radix-popper-anchor-width",`${Ut}px`),ze.setProperty("--radix-popper-anchor-height",`${Xt}px`)}}),w&&nP({element:w,padding:s}),fP({arrowWidth:S,arrowHeight:_}),f&&tP({strategy:"referenceHidden",...L})]}),[F,z]=kC(U),H=Rr(p);Ea(()=>{j&&(H==null||H())},[j,H]);const X=(xe=D.arrow)==null?void 0:xe.x,ee=(Ee=D.arrow)==null?void 0:Ee.y,le=((be=D.arrow)==null?void 0:be.centerOffset)!==0,[ye,se]=R.useState();return Ea(()=>{v&&se(window.getComputedStyle(v).zIndex)},[v]),C.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:j?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ye,"--radix-popper-transform-origin":[(We=D.transformOrigin)==null?void 0:We.x,(Se=D.transformOrigin)==null?void 0:Se.y].join(" "),...((Ae=D.hide)==null?void 0:Ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:C.jsx(uP,{scope:n,placedSide:F,onArrowChange:b,arrowX:X,arrowY:ee,shouldHideArrow:le,children:C.jsx(Nt.div,{"data-side":F,"data-align":z,...m,ref:x,style:{...m.style,animation:j?void 0:"none"}})})})});EC.displayName=rg;var _C="PopperArrow",cP={top:"bottom",right:"left",bottom:"top",left:"right"},SC=R.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,a=lP(_C,r),i=cP[a.placedSide];return C.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:C.jsx(oP,{...o,ref:n,style:{...o.style,display:"block"}})})});SC.displayName=_C;function dP(e){return e!==null}var fP=e=>({name:"transformOrigin",options:e,fn(t){var g,v,y;const{placement:n,rects:r,middlewareData:o}=t,i=((g=o.arrow)==null?void 0:g.centerOffset)!==0,s=i?0:e.arrowWidth,u=i?0:e.arrowHeight,[l,c]=kC(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(((v=o.arrow)==null?void 0:v.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let p="",m="";return l==="bottom"?(p=i?d:`${f}px`,m=`${-u}px`):l==="top"?(p=i?d:`${f}px`,m=`${r.floating.height+u}px`):l==="right"?(p=`${-u}px`,m=i?d:`${h}px`):l==="left"&&(p=`${r.floating.width+u}px`,m=i?d:`${h}px`),{data:{x:p,y:m}}}});function kC(e){const[t,n="center"]=e.split("-");return[t,n]}var hP=CC,pP=EC,vP=SC,[pf,H$]=Um("Tooltip",[xC]),og=xC(),RC="TooltipProvider",mP=700,ix="tooltip.open",[gP,NC]=pf(RC),DC=e=>{const{__scopeTooltip:t,delayDuration:n=mP,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:a}=e,[i,s]=R.useState(!0),u=R.useRef(!1),l=R.useRef(0);return R.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),C.jsx(gP,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:R.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:R.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:R.useCallback(c=>{u.current=c},[]),disableHoverableContent:o,children:a})};DC.displayName=RC;var IC="Tooltip",[G$,vf]=pf(IC),dv="TooltipTrigger",yP=R.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=vf(dv,n),a=NC(dv,n),i=og(n),s=R.useRef(null),u=cr(t,s,o.onTriggerChange),l=R.useRef(!1),c=R.useRef(!1),d=R.useCallback(()=>l.current=!1,[]);return R.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),C.jsx(hP,{asChild:!0,...i,children:C.jsx(Nt.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:Qe(e.onPointerMove,f=>{f.pointerType!=="touch"&&!c.current&&!a.isPointerInTransitRef.current&&(o.onTriggerEnter(),c.current=!0)}),onPointerLeave:Qe(e.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:Qe(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Qe(e.onFocus,()=>{l.current||o.onOpen()}),onBlur:Qe(e.onBlur,o.onClose),onClick:Qe(e.onClick,o.onClose)})})});yP.displayName=dv;var xP="TooltipPortal",[q$,wP]=pf(xP,{forceMount:void 0}),Ns="TooltipContent",TC=R.forwardRef((e,t)=>{const n=wP(Ns,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...a}=e,i=vf(Ns,e.__scopeTooltip);return C.jsx(sf,{present:r||i.open,children:i.disableHoverableContent?C.jsx(PC,{side:o,...a,ref:t}):C.jsx(bP,{side:o,...a,ref:t})})}),bP=R.forwardRef((e,t)=>{const n=vf(Ns,e.__scopeTooltip),r=NC(Ns,e.__scopeTooltip),o=R.useRef(null),a=cr(t,o),[i,s]=R.useState(null),{trigger:u,onClose:l}=n,c=o.current,{onPointerInTransitChange:d}=r,f=R.useCallback(()=>{s(null),d(!1)},[d]),h=R.useCallback((p,m)=>{const g=p.currentTarget,v={x:p.clientX,y:p.clientY},y=SP(v,g.getBoundingClientRect()),x=kP(v,y),w=RP(m.getBoundingClientRect()),b=DP([...x,...w]);s(b),d(!0)},[d]);return R.useEffect(()=>()=>f(),[f]),R.useEffect(()=>{if(u&&c){const p=g=>h(g,c),m=g=>h(g,u);return u.addEventListener("pointerleave",p),c.addEventListener("pointerleave",m),()=>{u.removeEventListener("pointerleave",p),c.removeEventListener("pointerleave",m)}}},[u,c,h,f]),R.useEffect(()=>{if(i){const p=m=>{const g=m.target,v={x:m.clientX,y:m.clientY},y=(u==null?void 0:u.contains(g))||(c==null?void 0:c.contains(g)),x=!NP(v,i);y?f():x&&(f(),l())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[u,c,i,l,f]),C.jsx(PC,{...e,ref:a})}),[CP,EP]=pf(IC,{isInside:!1}),PC=R.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:i,...s}=e,u=vf(Ns,n),l=og(n),{onClose:c}=u;return R.useEffect(()=>(document.addEventListener(ix,c),()=>document.removeEventListener(ix,c)),[c]),R.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,c]),C.jsx(Vm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:C.jsxs(pP,{"data-state":u.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[C.jsx(w2,{children:r}),C.jsx(CP,{scope:n,isInside:!0,children:C.jsx(bD,{id:u.contentId,role:"tooltip",children:o||r})})]})})});TC.displayName=Ns;var AC="TooltipArrow",_P=R.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=og(n);return EP(AC,n).isInside?null:C.jsx(vP,{...o,...r,ref:t})});_P.displayName=AC;function SP(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(n,r,o,a)){case a:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function kP(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function RP(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function NP(e,t){const{x:n,y:r}=e;let o=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const s=t[a].x,u=t[a].y,l=t[i].x,c=t[i].y;u>r!=c>r&&n<(l-s)*(r-u)/(c-u)+s&&(o=!o)}return o}function DP(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),IP(t)}function IP(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const a=t[t.length-1],i=t[t.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const a=n[n.length-1],i=n[n.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var TP=DC,MC=TC;const PP=TP,AP=R.forwardRef(({className:e,sideOffset:t=4,...n},r)=>C.jsx(MC,{ref:r,sideOffset:t,className:wt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));AP.displayName=MC.displayName;var mf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},gf=typeof window>"u"||"Deno"in globalThis;function vr(){}function MP(e,t){return typeof e=="function"?e(t):e}function FP(e){return typeof e=="number"&&e>=0&&e!==1/0}function OP(e,t){return Math.max(e+(t||0)-Date.now(),0)}function sx(e,t){return typeof e=="function"?e(t):e}function LP(e,t){return typeof e=="function"?e(t):e}function ux(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:a,queryKey:i,stale:s}=e;if(i){if(r){if(t.queryHash!==ag(i,t.options))return!1}else if(!Ju(t.queryKey,i))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||o&&o!==t.state.fetchStatus||a&&!a(t))}function lx(e,t){const{exact:n,status:r,predicate:o,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(n){if(Qu(t.options.mutationKey)!==Qu(a))return!1}else if(!Ju(t.options.mutationKey,a))return!1}return!(r&&t.state.status!==r||o&&!o(t))}function ag(e,t){return((t==null?void 0:t.queryKeyHashFn)||Qu)(e)}function Qu(e){return JSON.stringify(e,(t,n)=>fv(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function Ju(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!Ju(e[n],t[n])):!1}function FC(e,t){if(e===t)return e;const n=cx(e)&&cx(t);if(n||fv(e)&&fv(t)){const r=n?e:Object.keys(e),o=r.length,a=n?t:Object.keys(t),i=a.length,s=n?[]:{};let u=0;for(let l=0;l<i;l++){const c=n?l:a[l];(!n&&r.includes(c)||n)&&e[c]===void 0&&t[c]===void 0?(s[c]=void 0,u++):(s[c]=FC(e[c],t[c]),s[c]===e[c]&&e[c]!==void 0&&u++)}return o===i&&u===o?e:s}return t}function cx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function fv(e){if(!dx(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!dx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function dx(e){return Object.prototype.toString.call(e)==="[object Object]"}function BP(e){return new Promise(t=>{setTimeout(t,e)})}function jP(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?FC(e,t):t}function WP(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function zP(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var ig=Symbol();function OC(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ig?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Ya,Jo,ds,Y1,$P=(Y1=class extends mf{constructor(){super();qe(this,Ya);qe(this,Jo);qe(this,ds);Pe(this,ds,t=>{if(!gf&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Q(this,Jo)||this.setEventListener(Q(this,ds))}onUnsubscribe(){var t;this.hasListeners()||((t=Q(this,Jo))==null||t.call(this),Pe(this,Jo,void 0))}setEventListener(t){var n;Pe(this,ds,t),(n=Q(this,Jo))==null||n.call(this),Pe(this,Jo,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){Q(this,Ya)!==t&&(Pe(this,Ya,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Q(this,Ya)=="boolean"?Q(this,Ya):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ya=new WeakMap,Jo=new WeakMap,ds=new WeakMap,Y1),LC=new $P,fs,Zo,hs,X1,UP=(X1=class extends mf{constructor(){super();qe(this,fs,!0);qe(this,Zo);qe(this,hs);Pe(this,hs,t=>{if(!gf&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Q(this,Zo)||this.setEventListener(Q(this,hs))}onUnsubscribe(){var t;this.hasListeners()||((t=Q(this,Zo))==null||t.call(this),Pe(this,Zo,void 0))}setEventListener(t){var n;Pe(this,hs,t),(n=Q(this,Zo))==null||n.call(this),Pe(this,Zo,t(this.setOnline.bind(this)))}setOnline(t){Q(this,fs)!==t&&(Pe(this,fs,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return Q(this,fs)}},fs=new WeakMap,Zo=new WeakMap,hs=new WeakMap,X1),pd=new UP;function VP(){let e,t;const n=new Promise((o,a)=>{e=o,t=a});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),e(o)},n.reject=o=>{r({status:"rejected",reason:o}),t(o)},n}function HP(e){return Math.min(1e3*2**e,3e4)}function BC(e){return(e??"online")==="online"?pd.isOnline():!0}var jC=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function wh(e){return e instanceof jC}function WC(e){let t=!1,n=0,r=!1,o;const a=VP(),i=m=>{var g;r||(f(new jC(m)),(g=e.abort)==null||g.call(e))},s=()=>{t=!0},u=()=>{t=!1},l=()=>LC.isFocused()&&(e.networkMode==="always"||pd.isOnline())&&e.canRun(),c=()=>BC(e.networkMode)&&e.canRun(),d=m=>{var g;r||(r=!0,(g=e.onSuccess)==null||g.call(e,m),o==null||o(),a.resolve(m))},f=m=>{var g;r||(r=!0,(g=e.onError)==null||g.call(e,m),o==null||o(),a.reject(m))},h=()=>new Promise(m=>{var g;o=v=>{(r||l())&&m(v)},(g=e.onPause)==null||g.call(e)}).then(()=>{var m;o=void 0,r||(m=e.onContinue)==null||m.call(e)}),p=()=>{if(r)return;let m;const g=n===0?e.initialPromise:void 0;try{m=g??e.fn()}catch(v){m=Promise.reject(v)}Promise.resolve(m).then(d).catch(v=>{var E;if(r)return;const y=e.retry??(gf?0:3),x=e.retryDelay??HP,w=typeof x=="function"?x(n,v):x,b=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,v);if(t||!b){f(v);return}n++,(E=e.onFail)==null||E.call(e,n,v),BP(w).then(()=>l()?void 0:h()).then(()=>{t?f(v):p()})})};return{promise:a,cancel:i,continue:()=>(o==null||o(),a),cancelRetry:s,continueRetry:u,canStart:c,start:()=>(c()?p():h().then(p),a)}}function GP(){let e=[],t=0,n=s=>{s()},r=s=>{s()},o=s=>setTimeout(s,0);const a=s=>{t?e.push(s):o(()=>{n(s)})},i=()=>{const s=e;e=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;t++;try{u=s()}finally{t--,t||i()}return u},batchCalls:s=>(...u)=>{a(()=>{s(...u)})},schedule:a,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var mn=GP(),Xa,Q1,zC=(Q1=class{constructor(){qe(this,Xa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),FP(this.gcTime)&&Pe(this,Xa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(gf?1/0:5*60*1e3))}clearGcTimeout(){Q(this,Xa)&&(clearTimeout(Q(this,Xa)),Pe(this,Xa,void 0))}},Xa=new WeakMap,Q1),ps,vs,er,tn,ll,Qa,mr,yo,J1,qP=(J1=class extends zC{constructor(t){super();qe(this,mr);qe(this,ps);qe(this,vs);qe(this,er);qe(this,tn);qe(this,ll);qe(this,Qa);Pe(this,Qa,!1),Pe(this,ll,t.defaultOptions),this.setOptions(t.options),this.observers=[],Pe(this,er,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Pe(this,ps,YP(this.options)),this.state=t.state??Q(this,ps),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Q(this,tn))==null?void 0:t.promise}setOptions(t){this.options={...Q(this,ll),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Q(this,er).remove(this)}setData(t,n){const r=jP(this.state.data,t,this.options);return Qt(this,mr,yo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Qt(this,mr,yo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,o;const n=(r=Q(this,tn))==null?void 0:r.promise;return(o=Q(this,tn))==null||o.cancel(t),n?n.then(vr).catch(vr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Q(this,ps))}isActive(){return this.observers.some(t=>LP(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ig||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!OP(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Q(this,tn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Q(this,tn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Q(this,er).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Q(this,tn)&&(Q(this,Qa)?Q(this,tn).cancel({revert:!0}):Q(this,tn).cancelRetry()),this.scheduleGc()),Q(this,er).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Qt(this,mr,yo).call(this,{type:"invalidate"})}fetch(t,n){var u,l,c;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Q(this,tn))return Q(this,tn).continueRetry(),Q(this,tn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(f=>f.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,o=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(Pe(this,Qa,!0),r.signal)})},a=()=>{const d=OC(this.options,n),f={queryKey:this.queryKey,meta:this.meta};return o(f),Pe(this,Qa,!1),this.options.persister?this.options.persister(d,f,this):d(f)},i={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};o(i),(u=this.options.behavior)==null||u.onFetch(i,this),Pe(this,vs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((l=i.fetchOptions)==null?void 0:l.meta))&&Qt(this,mr,yo).call(this,{type:"fetch",meta:(c=i.fetchOptions)==null?void 0:c.meta});const s=d=>{var f,h,p,m;wh(d)&&d.silent||Qt(this,mr,yo).call(this,{type:"error",error:d}),wh(d)||((h=(f=Q(this,er).config).onError)==null||h.call(f,d,this),(m=(p=Q(this,er).config).onSettled)==null||m.call(p,this.state.data,d,this)),this.scheduleGc()};return Pe(this,tn,WC({initialPromise:n==null?void 0:n.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var f,h,p,m;if(d===void 0){s(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(g){s(g);return}(h=(f=Q(this,er).config).onSuccess)==null||h.call(f,d,this),(m=(p=Q(this,er).config).onSettled)==null||m.call(p,d,this.state.error,this),this.scheduleGc()},onError:s,onFail:(d,f)=>{Qt(this,mr,yo).call(this,{type:"failed",failureCount:d,error:f})},onPause:()=>{Qt(this,mr,yo).call(this,{type:"pause"})},onContinue:()=>{Qt(this,mr,yo).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),Q(this,tn).start()}},ps=new WeakMap,vs=new WeakMap,er=new WeakMap,tn=new WeakMap,ll=new WeakMap,Qa=new WeakMap,mr=new WeakSet,yo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...KP(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return wh(o)&&o.revert&&Q(this,vs)?{...Q(this,vs),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),mn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),Q(this,er).notify({query:this,type:"updated",action:t})})},J1);function KP(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:BC(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function YP(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var $r,Z1,XP=(Z1=class extends mf{constructor(t={}){super();qe(this,$r);this.config=t,Pe(this,$r,new Map)}build(t,n,r){const o=n.queryKey,a=n.queryHash??ag(o,n);let i=this.get(a);return i||(i=new qP({cache:this,queryKey:o,queryHash:a,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(o)}),this.add(i)),i}add(t){Q(this,$r).has(t.queryHash)||(Q(this,$r).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Q(this,$r).get(t.queryHash);n&&(t.destroy(),n===t&&Q(this,$r).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){mn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Q(this,$r).get(t)}getAll(){return[...Q(this,$r).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>ux(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>ux(t,r)):n}notify(t){mn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){mn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){mn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},$r=new WeakMap,Z1),Ur,dn,Ja,Vr,Ho,ew,QP=(ew=class extends zC{constructor(t){super();qe(this,Vr);qe(this,Ur);qe(this,dn);qe(this,Ja);this.mutationId=t.mutationId,Pe(this,dn,t.mutationCache),Pe(this,Ur,[]),this.state=t.state||JP(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Q(this,Ur).includes(t)||(Q(this,Ur).push(t),this.clearGcTimeout(),Q(this,dn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Pe(this,Ur,Q(this,Ur).filter(n=>n!==t)),this.scheduleGc(),Q(this,dn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Q(this,Ur).length||(this.state.status==="pending"?this.scheduleGc():Q(this,dn).remove(this))}continue(){var t;return((t=Q(this,Ja))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S;Pe(this,Ja,WC({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(_,k)=>{Qt(this,Vr,Ho).call(this,{type:"failed",failureCount:_,error:k})},onPause:()=>{Qt(this,Vr,Ho).call(this,{type:"pause"})},onContinue:()=>{Qt(this,Vr,Ho).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Q(this,dn).canRun(this)}));const n=this.state.status==="pending",r=!Q(this,Ja).canStart();try{if(!n){Qt(this,Vr,Ho).call(this,{type:"pending",variables:t,isPaused:r}),await((a=(o=Q(this,dn).config).onMutate)==null?void 0:a.call(o,t,this));const k=await((s=(i=this.options).onMutate)==null?void 0:s.call(i,t));k!==this.state.context&&Qt(this,Vr,Ho).call(this,{type:"pending",context:k,variables:t,isPaused:r})}const _=await Q(this,Ja).start();return await((l=(u=Q(this,dn).config).onSuccess)==null?void 0:l.call(u,_,t,this.state.context,this)),await((d=(c=this.options).onSuccess)==null?void 0:d.call(c,_,t,this.state.context)),await((h=(f=Q(this,dn).config).onSettled)==null?void 0:h.call(f,_,null,this.state.variables,this.state.context,this)),await((m=(p=this.options).onSettled)==null?void 0:m.call(p,_,null,t,this.state.context)),Qt(this,Vr,Ho).call(this,{type:"success",data:_}),_}catch(_){try{throw await((v=(g=Q(this,dn).config).onError)==null?void 0:v.call(g,_,t,this.state.context,this)),await((x=(y=this.options).onError)==null?void 0:x.call(y,_,t,this.state.context)),await((b=(w=Q(this,dn).config).onSettled)==null?void 0:b.call(w,void 0,_,this.state.variables,this.state.context,this)),await((S=(E=this.options).onSettled)==null?void 0:S.call(E,void 0,_,t,this.state.context)),_}finally{Qt(this,Vr,Ho).call(this,{type:"error",error:_})}}finally{Q(this,dn).runNext(this)}}},Ur=new WeakMap,dn=new WeakMap,Ja=new WeakMap,Vr=new WeakSet,Ho=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),mn.batch(()=>{Q(this,Ur).forEach(r=>{r.onMutationUpdate(t)}),Q(this,dn).notify({mutation:this,type:"updated",action:t})})},ew);function JP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var On,cl,tw,ZP=(tw=class extends mf{constructor(t={}){super();qe(this,On);qe(this,cl);this.config=t,Pe(this,On,new Map),Pe(this,cl,Date.now())}build(t,n,r){const o=new QP({mutationCache:this,mutationId:++Ll(this,cl)._,options:t.defaultMutationOptions(n),state:r});return this.add(o),o}add(t){const n=ac(t),r=Q(this,On).get(n)??[];r.push(t),Q(this,On).set(n,r),this.notify({type:"added",mutation:t})}remove(t){var r;const n=ac(t);if(Q(this,On).has(n)){const o=(r=Q(this,On).get(n))==null?void 0:r.filter(a=>a!==t);o&&(o.length===0?Q(this,On).delete(n):Q(this,On).set(n,o))}this.notify({type:"removed",mutation:t})}canRun(t){var r;const n=(r=Q(this,On).get(ac(t)))==null?void 0:r.find(o=>o.state.status==="pending");return!n||n===t}runNext(t){var r;const n=(r=Q(this,On).get(ac(t)))==null?void 0:r.find(o=>o!==t&&o.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){mn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...Q(this,On).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>lx(n,r))}findAll(t={}){return this.getAll().filter(n=>lx(t,n))}notify(t){mn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return mn.batch(()=>Promise.all(t.map(n=>n.continue().catch(vr))))}},On=new WeakMap,cl=new WeakMap,tw);function ac(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function fx(e){return{onFetch:(t,n)=>{var c,d,f,h,p;const r=t.options,o=(f=(d=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,a=((h=t.state.data)==null?void 0:h.pages)||[],i=((p=t.state.data)==null?void 0:p.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const l=async()=>{let m=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},v=OC(t.options,t.fetchOptions),y=async(x,w,b)=>{if(m)return Promise.reject();if(w==null&&x.pages.length)return Promise.resolve(x);const E={queryKey:t.queryKey,pageParam:w,direction:b?"backward":"forward",meta:t.options.meta};g(E);const S=await v(E),{maxPages:_}=t.options,k=b?zP:WP;return{pages:k(x.pages,S,_),pageParams:k(x.pageParams,w,_)}};if(o&&a.length){const x=o==="backward",w=x?eA:hx,b={pages:a,pageParams:i},E=w(r,b);s=await y(b,E,x)}else{const x=e??a.length;do{const w=u===0?i[0]??r.initialPageParam:hx(r,s);if(u>0&&w==null)break;s=await y(s,w),u++}while(u<x)}return s};t.options.persister?t.fetchFn=()=>{var m,g;return(g=(m=t.options).persister)==null?void 0:g.call(m,l,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=l}}}function hx(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function eA(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var gt,ea,ta,ms,gs,na,ys,xs,nw,tA=(nw=class{constructor(e={}){qe(this,gt);qe(this,ea);qe(this,ta);qe(this,ms);qe(this,gs);qe(this,na);qe(this,ys);qe(this,xs);Pe(this,gt,e.queryCache||new XP),Pe(this,ea,e.mutationCache||new ZP),Pe(this,ta,e.defaultOptions||{}),Pe(this,ms,new Map),Pe(this,gs,new Map),Pe(this,na,0)}mount(){Ll(this,na)._++,Q(this,na)===1&&(Pe(this,ys,LC.subscribe(async e=>{e&&(await this.resumePausedMutations(),Q(this,gt).onFocus())})),Pe(this,xs,pd.subscribe(async e=>{e&&(await this.resumePausedMutations(),Q(this,gt).onOnline())})))}unmount(){var e,t;Ll(this,na)._--,Q(this,na)===0&&((e=Q(this,ys))==null||e.call(this),Pe(this,ys,void 0),(t=Q(this,xs))==null||t.call(this),Pe(this,xs,void 0))}isFetching(e){return Q(this,gt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Q(this,ea).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Q(this,gt).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=Q(this,gt).build(this,n);return e.revalidateIfStale&&r.isStaleByTime(sx(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return Q(this,gt).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=Q(this,gt).get(r.queryHash),a=o==null?void 0:o.state.data,i=MP(t,a);if(i!==void 0)return Q(this,gt).build(this,r).setData(i,{...n,manual:!0})}setQueriesData(e,t,n){return mn.batch(()=>Q(this,gt).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Q(this,gt).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Q(this,gt);mn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Q(this,gt),r={type:"active",...e};return mn.batch(()=>(n.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries(r,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=mn.batch(()=>Q(this,gt).findAll(e).map(o=>o.cancel(n)));return Promise.all(r).then(vr).catch(vr)}invalidateQueries(e={},t={}){return mn.batch(()=>{if(Q(this,gt).findAll(e).forEach(r=>{r.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},r=mn.batch(()=>Q(this,gt).findAll(e).filter(o=>!o.isDisabled()).map(o=>{let a=o.fetch(void 0,n);return n.throwOnError||(a=a.catch(vr)),o.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(r).then(vr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Q(this,gt).build(this,t);return n.isStaleByTime(sx(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(vr).catch(vr)}fetchInfiniteQuery(e){return e.behavior=fx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(vr).catch(vr)}ensureInfiniteQueryData(e){return e.behavior=fx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return pd.isOnline()?Q(this,ea).resumePausedMutations():Promise.resolve()}getQueryCache(){return Q(this,gt)}getMutationCache(){return Q(this,ea)}getDefaultOptions(){return Q(this,ta)}setDefaultOptions(e){Pe(this,ta,e)}setQueryDefaults(e,t){Q(this,ms).set(Qu(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Q(this,ms).values()];let n={};return t.forEach(r=>{Ju(e,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(e,t){Q(this,gs).set(Qu(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Q(this,gs).values()];let n={};return t.forEach(r=>{Ju(e,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Q(this,ta).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ag(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===ig&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Q(this,ta).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Q(this,gt).clear(),Q(this,ea).clear()}},gt=new WeakMap,ea=new WeakMap,ta=new WeakMap,ms=new WeakMap,gs=new WeakMap,na=new WeakMap,ys=new WeakMap,xs=new WeakMap,nw),nA=R.createContext(void 0),rA=({client:e,children:t})=>(R.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),C.jsx(nA.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zu(){return Zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zu.apply(this,arguments)}var aa;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(aa||(aa={}));const px="popstate";function oA(e){e===void 0&&(e={});function t(r,o){let{pathname:a,search:i,hash:s}=r.location;return hv("",{pathname:a,search:i,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:UC(o)}return iA(t,n,null,e)}function Rt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $C(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aA(){return Math.random().toString(36).substr(2,8)}function vx(e,t){return{usr:e.state,key:e.key,idx:t}}function hv(e,t,n,r){return n===void 0&&(n=null),Zu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?zs(t):t,{state:n,key:t&&t.key||r||aA()})}function UC(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function zs(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function iA(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:a=!1}=r,i=o.history,s=aa.Pop,u=null,l=c();l==null&&(l=0,i.replaceState(Zu({},i.state,{idx:l}),""));function c(){return(i.state||{idx:null}).idx}function d(){s=aa.Pop;let g=c(),v=g==null?null:g-l;l=g,u&&u({action:s,location:m.location,delta:v})}function f(g,v){s=aa.Push;let y=hv(m.location,g,v);l=c()+1;let x=vx(y,l),w=m.createHref(y);try{i.pushState(x,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;o.location.assign(w)}a&&u&&u({action:s,location:m.location,delta:1})}function h(g,v){s=aa.Replace;let y=hv(m.location,g,v);l=c();let x=vx(y,l),w=m.createHref(y);i.replaceState(x,"",w),a&&u&&u({action:s,location:m.location,delta:0})}function p(g){let v=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:UC(g);return y=y.replace(/ $/,"%20"),Rt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return s},get location(){return e(o,i)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(px,d),u=g,()=>{o.removeEventListener(px,d),u=null}},createHref(g){return t(o,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(g){return i.go(g)}};return m}var mx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mx||(mx={}));function sA(e,t,n){return n===void 0&&(n="/"),uA(e,t,n,!1)}function uA(e,t,n,r){let o=typeof t=="string"?zs(t):t,a=GC(o.pathname||"/",n);if(a==null)return null;let i=VC(e);lA(i);let s=null;for(let u=0;s==null&&u<i.length;++u){let l=wA(a);s=yA(i[u],l,r)}return s}function VC(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(a,i,s)=>{let u={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};u.relativePath.startsWith("/")&&(Rt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=ti([r,u.relativePath]),c=n.concat(u);a.children&&a.children.length>0&&(Rt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),VC(a.children,t,c,l)),!(a.path==null&&!a.index)&&t.push({path:l,score:mA(l,a.index),routesMeta:c})};return e.forEach((a,i)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))o(a,i);else for(let u of HC(a.path))o(a,i,u)}),t}function HC(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return o?[a,""]:[a];let i=HC(r.join("/")),s=[];return s.push(...i.map(u=>u===""?a:[a,u].join("/"))),o&&s.push(...i),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function lA(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:gA(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const cA=/^:[\w-]+$/,dA=3,fA=2,hA=1,pA=10,vA=-2,gx=e=>e==="*";function mA(e,t){let n=e.split("/"),r=n.length;return n.some(gx)&&(r+=vA),t&&(r+=fA),n.filter(o=>!gx(o)).reduce((o,a)=>o+(cA.test(a)?dA:a===""?hA:pA),r)}function gA(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function yA(e,t,n){let{routesMeta:r}=e,o={},a="/",i=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=a==="/"?t:t.slice(a.length)||"/",d=yx({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=yx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),i.push({params:o,pathname:ti([a,d.pathname]),pathnameBase:_A(ti([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=ti([a,d.pathnameBase]))}return i}function yx(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=xA(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],i=a.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let m=s[d]||"";i=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const p=s[d];return h&&!p?l[f]=void 0:l[f]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:a,pathnameBase:i,pattern:e}}function xA(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),$C(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function wA(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return $C(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function GC(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function bA(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:o=""}=typeof e=="string"?zs(e):e;return{pathname:n?n.startsWith("/")?n:CA(n,t):t,search:SA(r),hash:kA(o)}}function CA(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function bh(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function EA(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function qC(e,t){let n=EA(e);return t?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function KC(e,t,n,r){r===void 0&&(r=!1);let o;typeof e=="string"?o=zs(e):(o=Zu({},e),Rt(!o.pathname||!o.pathname.includes("?"),bh("?","pathname","search",o)),Rt(!o.pathname||!o.pathname.includes("#"),bh("#","pathname","hash",o)),Rt(!o.search||!o.search.includes("#"),bh("#","search","hash",o)));let a=e===""||o.pathname==="",i=a?"/":o.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?t[d]:"/"}let u=bA(o,s),l=i&&i!=="/"&&i.endsWith("/"),c=(a||i===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const ti=e=>e.join("/").replace(/\/\/+/g,"/"),_A=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function RA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const YC=["post","put","patch","delete"];new Set(YC);const NA=["get",...YC];new Set(NA);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function el(){return el=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},el.apply(this,arguments)}const sg=R.createContext(null),DA=R.createContext(null),xl=R.createContext(null),yf=R.createContext(null),pi=R.createContext({outlet:null,matches:[],isDataRoute:!1}),XC=R.createContext(null);function wl(){return R.useContext(yf)!=null}function xf(){return wl()||Rt(!1),R.useContext(yf).location}function QC(e){R.useContext(xl).static||R.useLayoutEffect(e)}function vi(){let{isDataRoute:e}=R.useContext(pi);return e?$A():IA()}function IA(){wl()||Rt(!1);let e=R.useContext(sg),{basename:t,future:n,navigator:r}=R.useContext(xl),{matches:o}=R.useContext(pi),{pathname:a}=xf(),i=JSON.stringify(qC(o,n.v7_relativeSplatPath)),s=R.useRef(!1);return QC(()=>{s.current=!0}),R.useCallback(function(l,c){if(c===void 0&&(c={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let d=KC(l,JSON.parse(i),a,c.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ti([t,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[t,r,i,a,e])}function TA(e,t){return PA(e,t)}function PA(e,t,n,r){wl()||Rt(!1);let{navigator:o}=R.useContext(xl),{matches:a}=R.useContext(pi),i=a[a.length-1],s=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let l=xf(),c;if(t){var d;let g=typeof t=="string"?zs(t):t;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||Rt(!1),c=g}else c=l;let f=c.pathname||"/",h=f;if(u!=="/"){let g=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=sA(e,{pathname:h}),m=LA(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:ti([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:ti([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,n,r);return t&&m?R.createElement(yf.Provider,{value:{location:el({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:aa.Pop}},m):m}function AA(){let e=zA(),t=RA(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},t),n?R.createElement("pre",{style:o},n):null,null)}const MA=R.createElement(AA,null);class FA extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?R.createElement(pi.Provider,{value:this.props.routeContext},R.createElement(XC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function OA(e){let{routeContext:t,match:n,children:r}=e,o=R.useContext(sg);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(pi.Provider,{value:t},r)}function LA(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=i.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);c>=0||Rt(!1),i=i.slice(0,Math.min(i.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){u=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}return i.reduceRight((c,d,f)=>{let h,p=!1,m=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,m=d.route.errorElement||MA,u&&(l<0&&f===0?(p=!0,g=null):l===f&&(p=!0,g=d.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,f+1)),y=()=>{let x;return h?x=m:p?x=g:d.route.Component?x=R.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=c,R.createElement(OA,{match:d,routeContext:{outlet:c,matches:v,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?R.createElement(FA,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var JC=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(JC||{}),vd=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(vd||{});function BA(e){let t=R.useContext(sg);return t||Rt(!1),t}function jA(e){let t=R.useContext(DA);return t||Rt(!1),t}function WA(e){let t=R.useContext(pi);return t||Rt(!1),t}function ZC(e){let t=WA(),n=t.matches[t.matches.length-1];return n.route.id||Rt(!1),n.route.id}function zA(){var e;let t=R.useContext(XC),n=jA(vd.UseRouteError),r=ZC(vd.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function $A(){let{router:e}=BA(JC.UseNavigateStable),t=ZC(vd.UseNavigateStable),n=R.useRef(!1);return QC(()=>{n.current=!0}),R.useCallback(function(o,a){a===void 0&&(a={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,el({fromRouteId:t},a)))},[e,t])}function UA(e){let{to:t,replace:n,state:r,relative:o}=e;wl()||Rt(!1);let{future:a,static:i}=R.useContext(xl),{matches:s}=R.useContext(pi),{pathname:u}=xf(),l=vi(),c=KC(t,qC(s,a.v7_relativeSplatPath),u,o==="path"),d=JSON.stringify(c);return R.useEffect(()=>l(JSON.parse(d),{replace:n,state:r,relative:o}),[l,d,o,n,r]),null}function Go(e){Rt(!1)}function VA(e){let{basename:t="/",children:n=null,location:r,navigationType:o=aa.Pop,navigator:a,static:i=!1,future:s}=e;wl()&&Rt(!1);let u=t.replace(/^\/*/,"/"),l=R.useMemo(()=>({basename:u,navigator:a,static:i,future:el({v7_relativeSplatPath:!1},s)}),[u,s,a,i]);typeof r=="string"&&(r=zs(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=R.useMemo(()=>{let g=GC(c,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:p},navigationType:o}},[u,c,d,f,h,p,o]);return m==null?null:R.createElement(xl.Provider,{value:l},R.createElement(yf.Provider,{children:n,value:m}))}function HA(e){let{children:t,location:n}=e;return TA(pv(t),n)}new Promise(()=>{});function pv(e,t){t===void 0&&(t=[]);let n=[];return R.Children.forEach(e,(r,o)=>{if(!R.isValidElement(r))return;let a=[...t,o];if(r.type===R.Fragment){n.push.apply(n,pv(r.props.children,a));return}r.type!==Go&&Rt(!1),!r.props.index||!r.props.children||Rt(!1);let i={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=pv(r.props.children,a)),n.push(i)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const GA="6";try{window.__reactRouterVersion=GA}catch{}const qA="startTransition",xx=pw[qA];function KA(e){let{basename:t,children:n,future:r,window:o}=e,a=R.useRef();a.current==null&&(a.current=oA({window:o,v5Compat:!0}));let i=a.current,[s,u]=R.useState({action:i.action,location:i.location}),{v7_startTransition:l}=r||{},c=R.useCallback(d=>{l&&xx?xx(()=>u(d)):u(d)},[u,l]);return R.useLayoutEffect(()=>i.listen(c),[i,c]),R.createElement(VA,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:i,future:r})}var wx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wx||(wx={}));var bx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(bx||(bx={}));const eE=R.createContext(void 0),YA=({children:e})=>{const[t,n]=R.useState(null),[r,o]=R.useState(!1);R.useEffect(()=>{const u=localStorage.getItem("auth");if(u){const l=JSON.parse(u);n(l.user),o(!0)}},[]);const s={user:t,isAuthenticated:r,login:async(u,l)=>{if(u&&l){const c={id:"123456",name:"John Doe",email:u};return n(c),o(!0),localStorage.setItem("auth",JSON.stringify({user:c})),!0}return!1},logout:()=>{n(null),o(!1),localStorage.removeItem("auth")}};return C.jsx(eE.Provider,{value:s,children:e})},ug=()=>{const e=R.useContext(eE);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},XA=()=>{const e=vi(),{isAuthenticated:t}=ug(),[n,r]=R.useState(!0);return R.useEffect(()=>{const o=setTimeout(()=>{e(t?"/permissions-check":"/login"),r(!1)},500);return()=>clearTimeout(o)},[t,e]),C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-teal-600 to-teal-800 transition-all duration-300 ease-in-out",children:C.jsxs("div",{className:"text-center p-4",children:[C.jsx("h1",{className:"text-4xl font-bold text-white mb-6",children:"AttendNow"}),n&&C.jsxs("div",{className:"flex flex-col items-center",children:[C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white mb-4"}),C.jsx("p",{className:"text-xl text-white",children:"Loading..."})]})]})})},QA=()=>{const e=xf();return R.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:C.jsxs("div",{className:"text-center",children:[C.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),C.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),C.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},vv=K2("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Tn=R.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},a)=>{const i=r?qu:"button";return C.jsx(i,{className:wt(vv({variant:t,size:n,className:e})),ref:a,...o})});Tn.displayName="Button";const mv=R.forwardRef(({className:e,type:t,...n},r)=>C.jsx("input",{type:t,className:wt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));mv.displayName="Input";const ia=R.forwardRef(({className:e,...t},n)=>C.jsx("div",{ref:n,className:wt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));ia.displayName="Card";const gv=R.forwardRef(({className:e,...t},n)=>C.jsx("div",{ref:n,className:wt("flex flex-col space-y-1.5 p-6",e),...t}));gv.displayName="CardHeader";const yv=R.forwardRef(({className:e,...t},n)=>C.jsx("h3",{ref:n,className:wt("text-2xl font-semibold leading-none tracking-tight",e),...t}));yv.displayName="CardTitle";const JA=R.forwardRef(({className:e,...t},n)=>C.jsx("p",{ref:n,className:wt("text-sm text-muted-foreground",e),...t}));JA.displayName="CardDescription";const hu=R.forwardRef(({className:e,...t},n)=>C.jsx("div",{ref:n,className:wt("p-6 pt-0",e),...t}));hu.displayName="CardContent";const ZA=R.forwardRef(({className:e,...t},n)=>C.jsx("div",{ref:n,className:wt("flex items-center p-6 pt-0",e),...t}));ZA.displayName="CardFooter";var bl=e=>e.type==="checkbox",Ga=e=>e instanceof Date,pn=e=>e==null;const tE=e=>typeof e=="object";var bt=e=>!pn(e)&&!Array.isArray(e)&&tE(e)&&!Ga(e),eM=e=>bt(e)&&e.target?bl(e.target)?e.target.checked:e.target.value:e,tM=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,nM=(e,t)=>e.has(tM(t)),rM=e=>{const t=e.constructor&&e.constructor.prototype;return bt(t)&&t.hasOwnProperty("isPrototypeOf")},lg=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function en(e){let t;const n=Array.isArray(e),r=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(lg&&(e instanceof Blob||r))&&(n||bt(e)))if(t=n?[]:{},!n&&!rM(e))t=e;else for(const o in e)e.hasOwnProperty(o)&&(t[o]=en(e[o]));else return e;return t}var wf=e=>Array.isArray(e)?e.filter(Boolean):[],_t=e=>e===void 0,he=(e,t,n)=>{if(!t||!bt(e))return n;const r=wf(t.split(/[,[\].]+?/)).reduce((o,a)=>pn(o)?o:o[a],e);return _t(r)||r===e?_t(e[t])?n:e[t]:r},zr=e=>typeof e=="boolean",cg=e=>/^\w*$/.test(e),nE=e=>wf(e.replace(/["|']|\]/g,"").split(/\.|\[/)),it=(e,t,n)=>{let r=-1;const o=cg(t)?[t]:nE(t),a=o.length,i=a-1;for(;++r<a;){const s=o[r];let u=n;if(r!==i){const l=e[s];u=bt(l)||Array.isArray(l)?l:isNaN(+o[r+1])?{}:[]}if(s==="__proto__"||s==="constructor"||s==="prototype")return;e[s]=u,e=e[s]}};const Cx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},wr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},vo={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};te.createContext(null);var oM=(e,t,n,r=!0)=>{const o={defaultValues:t._defaultValues};for(const a in e)Object.defineProperty(o,a,{get:()=>{const i=a;return t._proxyFormState[i]!==wr.all&&(t._proxyFormState[i]=!r||wr.all),e[i]}});return o},xv=e=>pn(e)||!tE(e);function Qo(e,t){if(xv(e)||xv(t))return e===t;if(Ga(e)&&Ga(t))return e.getTime()===t.getTime();const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n){const a=e[o];if(!r.includes(o))return!1;if(o!=="ref"){const i=t[o];if(Ga(a)&&Ga(i)||bt(a)&&bt(i)||Array.isArray(a)&&Array.isArray(i)?!Qo(a,i):a!==i)return!1}}return!0}var Yr=e=>typeof e=="string",aM=(e,t,n,r,o)=>Yr(e)?(r&&t.watch.add(e),he(n,e,o)):Array.isArray(e)?e.map(a=>(r&&t.watch.add(a),he(n,a))):(r&&(t.watchAll=!0),n),iM=(e,t,n,r,o)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:o||!0}}:{},_u=e=>Array.isArray(e)?e:[e],Ex=()=>{let e=[];return{get observers(){return e},next:o=>{for(const a of e)a.next&&a.next(o)},subscribe:o=>(e.push(o),{unsubscribe:()=>{e=e.filter(a=>a!==o)}}),unsubscribe:()=>{e=[]}}},fn=e=>bt(e)&&!Object.keys(e).length,dg=e=>e.type==="file",br=e=>typeof e=="function",md=e=>{if(!lg)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},rE=e=>e.type==="select-multiple",fg=e=>e.type==="radio",sM=e=>fg(e)||bl(e),Ch=e=>md(e)&&e.isConnected;function uM(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=_t(e)?r++:e[t[r++]];return e}function lM(e){for(const t in e)if(e.hasOwnProperty(t)&&!_t(e[t]))return!1;return!0}function Dt(e,t){const n=Array.isArray(t)?t:cg(t)?[t]:nE(t),r=n.length===1?e:uM(e,n),o=n.length-1,a=n[o];return r&&delete r[a],o!==0&&(bt(r)&&fn(r)||Array.isArray(r)&&lM(r))&&Dt(e,n.slice(0,-1)),e}var oE=e=>{for(const t in e)if(br(e[t]))return!0;return!1};function gd(e,t={}){const n=Array.isArray(e);if(bt(e)||n)for(const r in e)Array.isArray(e[r])||bt(e[r])&&!oE(e[r])?(t[r]=Array.isArray(e[r])?[]:{},gd(e[r],t[r])):pn(e[r])||(t[r]=!0);return t}function aE(e,t,n){const r=Array.isArray(e);if(bt(e)||r)for(const o in e)Array.isArray(e[o])||bt(e[o])&&!oE(e[o])?_t(t)||xv(n[o])?n[o]=Array.isArray(e[o])?gd(e[o],[]):{...gd(e[o])}:aE(e[o],pn(t)?{}:t[o],n[o]):n[o]=!Qo(e[o],t[o]);return n}var eu=(e,t)=>aE(e,t,gd(t));const _x={value:!1,isValid:!1},Sx={value:!0,isValid:!0};var iE=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!_t(e[0].attributes.value)?_t(e[0].value)||e[0].value===""?Sx:{value:e[0].value,isValid:!0}:Sx:_x}return _x},sE=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>_t(e)?e:t?e===""?NaN:e&&+e:n&&Yr(e)?new Date(e):r?r(e):e;const kx={isValid:!1,value:null};var uE=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,kx):kx;function Rx(e){const t=e.ref;return dg(t)?t.files:fg(t)?uE(e.refs).value:rE(t)?[...t.selectedOptions].map(({value:n})=>n):bl(t)?iE(e.refs).value:sE(_t(t.value)?e.ref.value:t.value,e)}var cM=(e,t,n,r)=>{const o={};for(const a of e){const i=he(t,a);i&&it(o,a,i._f)}return{criteriaMode:n,names:[...e],fields:o,shouldUseNativeValidation:r}},yd=e=>e instanceof RegExp,tu=e=>_t(e)?e:yd(e)?e.source:bt(e)?yd(e.value)?e.value.source:e.value:e,Nx=e=>({isOnSubmit:!e||e===wr.onSubmit,isOnBlur:e===wr.onBlur,isOnChange:e===wr.onChange,isOnAll:e===wr.all,isOnTouch:e===wr.onTouched});const Dx="AsyncFunction";var dM=e=>!!e&&!!e.validate&&!!(br(e.validate)&&e.validate.constructor.name===Dx||bt(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===Dx)),fM=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),Ix=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const Su=(e,t,n,r)=>{for(const o of n||Object.keys(e)){const a=he(e,o);if(a){const{_f:i,...s}=a;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],o)&&!r)return!0;if(i.ref&&t(i.ref,i.name)&&!r)return!0;if(Su(s,t))break}else if(bt(s)&&Su(s,t))break}}};function Tx(e,t,n){const r=he(e,n);if(r||cg(n))return{error:r,name:n};const o=n.split(".");for(;o.length;){const a=o.join("."),i=he(t,a),s=he(e,a);if(i&&!Array.isArray(i)&&n!==a)return{name:n};if(s&&s.type)return{name:a,error:s};o.pop()}return{name:n}}var hM=(e,t,n,r)=>{n(e);const{name:o,...a}=e;return fn(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find(i=>t[i]===(!r||wr.all))},pM=(e,t,n)=>!e||!t||e===t||_u(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r))),vM=(e,t,n,r,o)=>o.isOnAll?!1:!n&&o.isOnTouch?!(t||e):(n?r.isOnBlur:o.isOnBlur)?!e:(n?r.isOnChange:o.isOnChange)?e:!0,mM=(e,t)=>!wf(he(e,t)).length&&Dt(e,t),gM=(e,t,n)=>{const r=_u(he(e,n));return it(r,"root",t[n]),it(e,n,r),e},Lc=e=>Yr(e);function Px(e,t,n="validate"){if(Lc(e)||Array.isArray(e)&&e.every(Lc)||zr(e)&&!e)return{type:n,message:Lc(e)?e:"",ref:t}}var Ei=e=>bt(e)&&!yd(e)?e:{value:e,message:""},Ax=async(e,t,n,r,o,a)=>{const{ref:i,refs:s,required:u,maxLength:l,minLength:c,min:d,max:f,pattern:h,validate:p,name:m,valueAsNumber:g,mount:v}=e._f,y=he(n,m);if(!v||t.has(m))return{};const x=s?s[0]:i,w=T=>{o&&x.reportValidity&&(x.setCustomValidity(zr(T)?"":T||""),x.reportValidity())},b={},E=fg(i),S=bl(i),_=E||S,k=(g||dg(i))&&_t(i.value)&&_t(y)||md(i)&&i.value===""||y===""||Array.isArray(y)&&!y.length,N=iM.bind(null,m,r,b),A=(T,L,M,$=vo.maxLength,U=vo.minLength)=>{const j=T?L:M;b[m]={type:T?$:U,message:j,ref:i,...N(T?$:U,j)}};if(a?!Array.isArray(y)||!y.length:u&&(!_&&(k||pn(y))||zr(y)&&!y||S&&!iE(s).isValid||E&&!uE(s).isValid)){const{value:T,message:L}=Lc(u)?{value:!!u,message:u}:Ei(u);if(T&&(b[m]={type:vo.required,message:L,ref:x,...N(vo.required,L)},!r))return w(L),b}if(!k&&(!pn(d)||!pn(f))){let T,L;const M=Ei(f),$=Ei(d);if(!pn(y)&&!isNaN(y)){const U=i.valueAsNumber||y&&+y;pn(M.value)||(T=U>M.value),pn($.value)||(L=U<$.value)}else{const U=i.valueAsDate||new Date(y),j=z=>new Date(new Date().toDateString()+" "+z),D=i.type=="time",F=i.type=="week";Yr(M.value)&&y&&(T=D?j(y)>j(M.value):F?y>M.value:U>new Date(M.value)),Yr($.value)&&y&&(L=D?j(y)<j($.value):F?y<$.value:U<new Date($.value))}if((T||L)&&(A(!!T,M.message,$.message,vo.max,vo.min),!r))return w(b[m].message),b}if((l||c)&&!k&&(Yr(y)||a&&Array.isArray(y))){const T=Ei(l),L=Ei(c),M=!pn(T.value)&&y.length>+T.value,$=!pn(L.value)&&y.length<+L.value;if((M||$)&&(A(M,T.message,L.message),!r))return w(b[m].message),b}if(h&&!k&&Yr(y)){const{value:T,message:L}=Ei(h);if(yd(T)&&!y.match(T)&&(b[m]={type:vo.pattern,message:L,ref:i,...N(vo.pattern,L)},!r))return w(L),b}if(p){if(br(p)){const T=await p(y,n),L=Px(T,x);if(L&&(b[m]={...L,...N(vo.validate,L.message)},!r))return w(L.message),b}else if(bt(p)){let T={};for(const L in p){if(!fn(T)&&!r)break;const M=Px(await p[L](y,n),x,L);M&&(T={...M,...N(L,M.message)},w(M.message),r&&(b[m]=T))}if(!fn(T)&&(b[m]={ref:x,...T},!r))return b}}return w(!0),b};const yM={mode:wr.onSubmit,reValidateMode:wr.onChange,shouldFocusError:!0};function xM(e={}){let t={...yM,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:br(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1};const r={};let o=bt(t.defaultValues)||bt(t.values)?en(t.values||t.defaultValues)||{}:{},a=t.shouldUnregister?{}:en(o),i={action:!1,mount:!1,watch:!1},s={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,l=0;const c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...c};const f={array:Ex(),state:Ex()},h=Nx(t.mode),p=Nx(t.reValidateMode),m=t.criteriaMode===wr.all,g=O=>V=>{clearTimeout(l),l=setTimeout(O,V)},v=async O=>{if(!t.disabled&&(c.isValid||d.isValid||O)){const V=t.resolver?fn((await k()).errors):await A(r,!0);V!==n.isValid&&f.state.next({isValid:V})}},y=(O,V)=>{!t.disabled&&(c.isValidating||c.validatingFields||d.isValidating||d.validatingFields)&&((O||Array.from(s.mount)).forEach(K=>{K&&(V?it(n.validatingFields,K,V):Dt(n.validatingFields,K))}),f.state.next({validatingFields:n.validatingFields,isValidating:!fn(n.validatingFields)}))},x=(O,V=[],K,oe,re=!0,Z=!0)=>{if(oe&&K&&!t.disabled){if(i.action=!0,Z&&Array.isArray(he(r,O))){const ae=K(he(r,O),oe.argA,oe.argB);re&&it(r,O,ae)}if(Z&&Array.isArray(he(n.errors,O))){const ae=K(he(n.errors,O),oe.argA,oe.argB);re&&it(n.errors,O,ae),mM(n.errors,O)}if((c.touchedFields||d.touchedFields)&&Z&&Array.isArray(he(n.touchedFields,O))){const ae=K(he(n.touchedFields,O),oe.argA,oe.argB);re&&it(n.touchedFields,O,ae)}(c.dirtyFields||d.dirtyFields)&&(n.dirtyFields=eu(o,a)),f.state.next({name:O,isDirty:L(O,V),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else it(a,O,V)},w=(O,V)=>{it(n.errors,O,V),f.state.next({errors:n.errors})},b=O=>{n.errors=O,f.state.next({errors:n.errors,isValid:!1})},E=(O,V,K,oe)=>{const re=he(r,O);if(re){const Z=he(a,O,_t(K)?he(o,O):K);_t(Z)||oe&&oe.defaultChecked||V?it(a,O,V?Z:Rx(re._f)):U(O,Z),i.mount&&v()}},S=(O,V,K,oe,re)=>{let Z=!1,ae=!1;const Ne={name:O};if(!t.disabled){if(!K||oe){(c.isDirty||d.isDirty)&&(ae=n.isDirty,n.isDirty=Ne.isDirty=L(),Z=ae!==Ne.isDirty);const nt=Qo(he(o,O),V);ae=!!he(n.dirtyFields,O),nt?Dt(n.dirtyFields,O):it(n.dirtyFields,O,!0),Ne.dirtyFields=n.dirtyFields,Z=Z||(c.dirtyFields||d.dirtyFields)&&ae!==!nt}if(K){const nt=he(n.touchedFields,O);nt||(it(n.touchedFields,O,K),Ne.touchedFields=n.touchedFields,Z=Z||(c.touchedFields||d.touchedFields)&&nt!==K)}Z&&re&&f.state.next(Ne)}return Z?Ne:{}},_=(O,V,K,oe)=>{const re=he(n.errors,O),Z=(c.isValid||d.isValid)&&zr(V)&&n.isValid!==V;if(t.delayError&&K?(u=g(()=>w(O,K)),u(t.delayError)):(clearTimeout(l),u=null,K?it(n.errors,O,K):Dt(n.errors,O)),(K?!Qo(re,K):re)||!fn(oe)||Z){const ae={...oe,...Z&&zr(V)?{isValid:V}:{},errors:n.errors,name:O};n={...n,...ae},f.state.next(ae)}},k=async O=>{y(O,!0);const V=await t.resolver(a,t.context,cM(O||s.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return y(O),V},N=async O=>{const{errors:V}=await k(O);if(O)for(const K of O){const oe=he(V,K);oe?it(n.errors,K,oe):Dt(n.errors,K)}else n.errors=V;return V},A=async(O,V,K={valid:!0})=>{for(const oe in O){const re=O[oe];if(re){const{_f:Z,...ae}=re;if(Z){const Ne=s.array.has(Z.name),nt=re._f&&dM(re._f);nt&&c.validatingFields&&y([oe],!0);const Et=await Ax(re,s.disabled,a,m,t.shouldUseNativeValidation&&!V,Ne);if(nt&&c.validatingFields&&y([oe]),Et[Z.name]&&(K.valid=!1,V))break;!V&&(he(Et,Z.name)?Ne?gM(n.errors,Et,Z.name):it(n.errors,Z.name,Et[Z.name]):Dt(n.errors,Z.name))}!fn(ae)&&await A(ae,V,K)}}return K.valid},T=()=>{for(const O of s.unMount){const V=he(r,O);V&&(V._f.refs?V._f.refs.every(K=>!Ch(K)):!Ch(V._f.ref))&&be(O)}s.unMount=new Set},L=(O,V)=>!t.disabled&&(O&&V&&it(a,O,V),!Qo(X(),o)),M=(O,V,K)=>aM(O,s,{...i.mount?a:_t(V)?o:Yr(O)?{[O]:V}:V},K,V),$=O=>wf(he(i.mount?a:o,O,t.shouldUnregister?he(o,O,[]):[])),U=(O,V,K={})=>{const oe=he(r,O);let re=V;if(oe){const Z=oe._f;Z&&(!Z.disabled&&it(a,O,sE(V,Z)),re=md(Z.ref)&&pn(V)?"":V,rE(Z.ref)?[...Z.ref.options].forEach(ae=>ae.selected=re.includes(ae.value)):Z.refs?bl(Z.ref)?Z.refs.length>1?Z.refs.forEach(ae=>(!ae.defaultChecked||!ae.disabled)&&(ae.checked=Array.isArray(re)?!!re.find(Ne=>Ne===ae.value):re===ae.value)):Z.refs[0]&&(Z.refs[0].checked=!!re):Z.refs.forEach(ae=>ae.checked=ae.value===re):dg(Z.ref)?Z.ref.value="":(Z.ref.value=re,Z.ref.type||f.state.next({name:O,values:en(a)})))}(K.shouldDirty||K.shouldTouch)&&S(O,re,K.shouldTouch,K.shouldDirty,!0),K.shouldValidate&&H(O)},j=(O,V,K)=>{for(const oe in V){const re=V[oe],Z=`${O}.${oe}`,ae=he(r,Z);(s.array.has(O)||bt(re)||ae&&!ae._f)&&!Ga(re)?j(Z,re,K):U(Z,re,K)}},D=(O,V,K={})=>{const oe=he(r,O),re=s.array.has(O),Z=en(V);it(a,O,Z),re?(f.array.next({name:O,values:en(a)}),(c.isDirty||c.dirtyFields||d.isDirty||d.dirtyFields)&&K.shouldDirty&&f.state.next({name:O,dirtyFields:eu(o,a),isDirty:L(O,Z)})):oe&&!oe._f&&!pn(Z)?j(O,Z,K):U(O,Z,K),Ix(O,s)&&f.state.next({...n}),f.state.next({name:i.mount?O:void 0,values:en(a)})},F=async O=>{i.mount=!0;const V=O.target;let K=V.name,oe=!0;const re=he(r,K),Z=ae=>{oe=Number.isNaN(ae)||Ga(ae)&&isNaN(ae.getTime())||Qo(ae,he(a,K,ae))};if(re){let ae,Ne;const nt=V.type?Rx(re._f):eM(O),Et=O.type===Cx.BLUR||O.type===Cx.FOCUS_OUT,bi=!fM(re._f)&&!t.resolver&&!he(n.errors,K)&&!re._f.deps||vM(Et,he(n.touchedFields,K),n.isSubmitted,p,h),Mr=Ix(K,s,Et);it(a,K,nt),Et?(re._f.onBlur&&re._f.onBlur(O),u&&u(0)):re._f.onChange&&re._f.onChange(O);const fo=S(K,nt,Et),ho=!fn(fo)||Mr;if(!Et&&f.state.next({name:K,type:O.type,values:en(a)}),bi)return(c.isValid||d.isValid)&&(t.mode==="onBlur"?Et&&v():Et||v()),ho&&f.state.next({name:K,...Mr?{}:fo});if(!Et&&Mr&&f.state.next({...n}),t.resolver){const{errors:fr}=await k([K]);if(Z(nt),oe){const Wf=Tx(n.errors,r,K),ke=Tx(fr,r,Wf.name||K);ae=ke.error,K=ke.name,Ne=fn(fr)}}else y([K],!0),ae=(await Ax(re,s.disabled,a,m,t.shouldUseNativeValidation))[K],y([K]),Z(nt),oe&&(ae?Ne=!1:(c.isValid||d.isValid)&&(Ne=await A(r,!0)));oe&&(re._f.deps&&H(re._f.deps),_(K,Ne,ae,fo))}},z=(O,V)=>{if(he(n.errors,V)&&O.focus)return O.focus(),1},H=async(O,V={})=>{let K,oe;const re=_u(O);if(t.resolver){const Z=await N(_t(O)?O:re);K=fn(Z),oe=O?!re.some(ae=>he(Z,ae)):K}else O?(oe=(await Promise.all(re.map(async Z=>{const ae=he(r,Z);return await A(ae&&ae._f?{[Z]:ae}:ae)}))).every(Boolean),!(!oe&&!n.isValid)&&v()):oe=K=await A(r);return f.state.next({...!Yr(O)||(c.isValid||d.isValid)&&K!==n.isValid?{}:{name:O},...t.resolver||!O?{isValid:K}:{},errors:n.errors}),V.shouldFocus&&!oe&&Su(r,z,O?re:s.mount),oe},X=O=>{const V={...i.mount?a:o};return _t(O)?V:Yr(O)?he(V,O):O.map(K=>he(V,K))},ee=(O,V)=>({invalid:!!he((V||n).errors,O),isDirty:!!he((V||n).dirtyFields,O),error:he((V||n).errors,O),isValidating:!!he(n.validatingFields,O),isTouched:!!he((V||n).touchedFields,O)}),le=O=>{O&&_u(O).forEach(V=>Dt(n.errors,V)),f.state.next({errors:O?n.errors:{}})},ye=(O,V,K)=>{const oe=(he(r,O,{_f:{}})._f||{}).ref,re=he(n.errors,O)||{},{ref:Z,message:ae,type:Ne,...nt}=re;it(n.errors,O,{...nt,...V,ref:oe}),f.state.next({name:O,errors:n.errors,isValid:!1}),K&&K.shouldFocus&&oe&&oe.focus&&oe.focus()},se=(O,V)=>br(O)?f.state.subscribe({next:K=>O(M(void 0,V),K)}):M(O,V,!0),xe=O=>f.state.subscribe({next:V=>{pM(O.name,V.name,O.exact)&&hM(V,O.formState||c,ze,O.reRenderRoot)&&O.callback({values:{...a},...n,...V})}}).unsubscribe,Ee=O=>(i.mount=!0,d={...d,...O.formState},xe({...O,formState:d})),be=(O,V={})=>{for(const K of O?_u(O):s.mount)s.mount.delete(K),s.array.delete(K),V.keepValue||(Dt(r,K),Dt(a,K)),!V.keepError&&Dt(n.errors,K),!V.keepDirty&&Dt(n.dirtyFields,K),!V.keepTouched&&Dt(n.touchedFields,K),!V.keepIsValidating&&Dt(n.validatingFields,K),!t.shouldUnregister&&!V.keepDefaultValue&&Dt(o,K);f.state.next({values:en(a)}),f.state.next({...n,...V.keepDirty?{isDirty:L()}:{}}),!V.keepIsValid&&v()},We=({disabled:O,name:V})=>{(zr(O)&&i.mount||O||s.disabled.has(V))&&(O?s.disabled.add(V):s.disabled.delete(V))},Se=(O,V={})=>{let K=he(r,O);const oe=zr(V.disabled)||zr(t.disabled);return it(r,O,{...K||{},_f:{...K&&K._f?K._f:{ref:{name:O}},name:O,mount:!0,...V}}),s.mount.add(O),K?We({disabled:zr(V.disabled)?V.disabled:t.disabled,name:O}):E(O,!0,V.value),{...oe?{disabled:V.disabled||t.disabled}:{},...t.progressive?{required:!!V.required,min:tu(V.min),max:tu(V.max),minLength:tu(V.minLength),maxLength:tu(V.maxLength),pattern:tu(V.pattern)}:{},name:O,onChange:F,onBlur:F,ref:re=>{if(re){Se(O,V),K=he(r,O);const Z=_t(re.value)&&re.querySelectorAll&&re.querySelectorAll("input,select,textarea")[0]||re,ae=sM(Z),Ne=K._f.refs||[];if(ae?Ne.find(nt=>nt===Z):Z===K._f.ref)return;it(r,O,{_f:{...K._f,...ae?{refs:[...Ne.filter(Ch),Z,...Array.isArray(he(o,O))?[{}]:[]],ref:{type:Z.type,name:O}}:{ref:Z}}}),E(O,!1,void 0,Z)}else K=he(r,O,{}),K._f&&(K._f.mount=!1),(t.shouldUnregister||V.shouldUnregister)&&!(nM(s.array,O)&&i.action)&&s.unMount.add(O)}}},Ae=()=>t.shouldFocusError&&Su(r,z,s.mount),De=O=>{zr(O)&&(f.state.next({disabled:O}),Su(r,(V,K)=>{const oe=he(r,K);oe&&(V.disabled=oe._f.disabled||O,Array.isArray(oe._f.refs)&&oe._f.refs.forEach(re=>{re.disabled=oe._f.disabled||O}))},0,!1))},Ue=(O,V)=>async K=>{let oe;K&&(K.preventDefault&&K.preventDefault(),K.persist&&K.persist());let re=en(a);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:Z,values:ae}=await k();n.errors=Z,re=ae}else await A(r);if(s.disabled.size)for(const Z of s.disabled)it(re,Z,void 0);if(Dt(n.errors,"root"),fn(n.errors)){f.state.next({errors:{}});try{await O(re,K)}catch(Z){oe=Z}}else V&&await V({...n.errors},K),Ae(),setTimeout(Ae);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:fn(n.errors)&&!oe,submitCount:n.submitCount+1,errors:n.errors}),oe)throw oe},Ge=(O,V={})=>{he(r,O)&&(_t(V.defaultValue)?D(O,en(he(o,O))):(D(O,V.defaultValue),it(o,O,en(V.defaultValue))),V.keepTouched||Dt(n.touchedFields,O),V.keepDirty||(Dt(n.dirtyFields,O),n.isDirty=V.defaultValue?L(O,en(he(o,O))):L()),V.keepError||(Dt(n.errors,O),c.isValid&&v()),f.state.next({...n}))},Be=(O,V={})=>{const K=O?en(O):o,oe=en(K),re=fn(O),Z=re?o:oe;if(V.keepDefaultValues||(o=K),!V.keepValues){if(V.keepDirtyValues){const ae=new Set([...s.mount,...Object.keys(eu(o,a))]);for(const Ne of Array.from(ae))he(n.dirtyFields,Ne)?it(Z,Ne,he(a,Ne)):D(Ne,he(Z,Ne))}else{if(lg&&_t(O))for(const ae of s.mount){const Ne=he(r,ae);if(Ne&&Ne._f){const nt=Array.isArray(Ne._f.refs)?Ne._f.refs[0]:Ne._f.ref;if(md(nt)){const Et=nt.closest("form");if(Et){Et.reset();break}}}}for(const ae of s.mount)D(ae,he(Z,ae))}a=en(Z),f.array.next({values:{...Z}}),f.state.next({values:{...Z}})}s={mount:V.keepDirtyValues?s.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!c.isValid||!!V.keepIsValid||!!V.keepDirtyValues,i.watch=!!t.shouldUnregister,f.state.next({submitCount:V.keepSubmitCount?n.submitCount:0,isDirty:re?!1:V.keepDirty?n.isDirty:!!(V.keepDefaultValues&&!Qo(O,o)),isSubmitted:V.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:re?{}:V.keepDirtyValues?V.keepDefaultValues&&a?eu(o,a):n.dirtyFields:V.keepDefaultValues&&O?eu(o,O):V.keepDirty?n.dirtyFields:{},touchedFields:V.keepTouched?n.touchedFields:{},errors:V.keepErrors?n.errors:{},isSubmitSuccessful:V.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},Ut=(O,V)=>Be(br(O)?O(a):O,V),Xt=(O,V={})=>{const K=he(r,O),oe=K&&K._f;if(oe){const re=oe.refs?oe.refs[0]:oe.ref;re.focus&&(re.focus(),V.shouldSelect&&br(re.select)&&re.select())}},ze=O=>{n={...n,...O}},Cn={control:{register:Se,unregister:be,getFieldState:ee,handleSubmit:Ue,setError:ye,_subscribe:xe,_runSchema:k,_getWatch:M,_getDirty:L,_setValid:v,_setFieldArray:x,_setDisabledField:We,_setErrors:b,_getFieldArray:$,_reset:Be,_resetDefaultValues:()=>br(t.defaultValues)&&t.defaultValues().then(O=>{Ut(O,t.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:T,_disableForm:De,_subjects:f,_proxyFormState:c,get _fields(){return r},get _formValues(){return a},get _state(){return i},set _state(O){i=O},get _defaultValues(){return o},get _names(){return s},set _names(O){s=O},get _formState(){return n},get _options(){return t},set _options(O){t={...t,...O}}},subscribe:Ee,trigger:H,register:Se,handleSubmit:Ue,watch:se,setValue:D,getValues:X,reset:Ut,resetField:Ge,clearErrors:le,unregister:be,setError:ye,setFocus:Xt,getFieldState:ee};return{...Cn,formControl:Cn}}const wM=typeof window<"u"?te.useLayoutEffect:te.useEffect;function bM(e={}){const t=te.useRef(void 0),n=te.useRef(void 0),[r,o]=te.useState({isDirty:!1,isValidating:!1,isLoading:br(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:br(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...e.formControl?e.formControl:xM(e),formState:r},e.formControl&&e.defaultValues&&!br(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions));const a=t.current.control;return a._options=e,wM(()=>{const i=a._subscribe({formState:a._proxyFormState,callback:()=>o({...a._formState}),reRenderRoot:!0});return o(s=>({...s,isReady:!0})),a._formState.isReady=!0,i},[a]),te.useEffect(()=>a._disableForm(e.disabled),[a,e.disabled]),te.useEffect(()=>{e.mode&&(a._options.mode=e.mode),e.reValidateMode&&(a._options.reValidateMode=e.reValidateMode),e.errors&&!fn(e.errors)&&a._setErrors(e.errors)},[a,e.errors,e.mode,e.reValidateMode]),te.useEffect(()=>{e.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,e.shouldUnregister]),te.useEffect(()=>{if(a._proxyFormState.isDirty){const i=a._getDirty();i!==r.isDirty&&a._subjects.state.next({isDirty:i})}},[a,r.isDirty]),te.useEffect(()=>{e.values&&!Qo(e.values,n.current)?(a._reset(e.values,a._options.resetOptions),n.current=e.values,o(i=>({...i}))):a._resetDefaultValues()},[a,e.values]),te.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),t.current.formState=oM(r,a),t.current}const CM=()=>{const{login:e}=ug(),t=vi(),[n,r]=R.useState(!1),{toast:o}=gl(),{register:a,handleSubmit:i,formState:{errors:s}}=bM({defaultValues:{email:"user@example.com",password:"password"}}),u=async l=>{r(!0);try{await e(l.email,l.password)?(o({title:"Login successful",description:"Welcome back!"}),t("/permissions-check")):o({title:"Login failed",description:"Invalid email or password",variant:"destructive"})}catch(c){console.error("Login error:",c),o({title:"Login error",description:"An unexpected error occurred",variant:"destructive"})}finally{r(!1)}};return C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-teal-600 to-teal-800 p-4",children:C.jsxs(ia,{className:"w-full max-w-md p-6",children:[C.jsxs("div",{className:"text-center mb-8",children:[C.jsx("h1",{className:"text-3xl font-bold",children:"AttendNow"}),C.jsx("p",{className:"text-muted-foreground mt-2",children:"Sign in to your account"})]}),C.jsxs("form",{onSubmit:i(u),className:"space-y-4",children:[C.jsxs("div",{className:"space-y-2",children:[C.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),C.jsx(mv,{id:"email",type:"email",placeholder:"name@company.com",...a("email",{required:"Email is required"})}),s.email&&C.jsx("p",{className:"text-sm text-red-500",children:s.email.message})]}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),C.jsx("a",{href:"#",className:"text-sm text-primary hover:underline",children:"Forgot password?"})]}),C.jsx(mv,{id:"password",type:"password",...a("password",{required:"Password is required"})}),s.password&&C.jsx("p",{className:"text-sm text-red-500",children:s.password.message})]}),C.jsx(Tn,{type:"submit",className:"w-full bg-teal-600 hover:bg-teal-700",disabled:n,children:n?"Signing in...":"Sign In"})]}),C.jsxs("div",{className:"mt-6 text-center text-sm",children:[C.jsxs("span",{className:"text-muted-foreground",children:["Don't have an account?"," "]}),C.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Contact your administrator"})]}),C.jsx("div",{className:"mt-4 p-4 bg-muted rounded-md",children:C.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:[C.jsx("strong",{children:"Demo credentials:"}),C.jsx("br",{}),"Email: user@example.com",C.jsx("br",{}),"Password: password"]})})]})})};function Le(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Qn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function vn(e,t){const n=Le(e);return isNaN(t)?Qn(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function Ir(e,t){const n=Le(e);if(isNaN(t))return Qn(e,NaN);if(!t)return n;const r=n.getDate(),o=Qn(e,n.getTime());o.setMonth(n.getMonth()+t+1,0);const a=o.getDate();return r>=a?o:(n.setFullYear(o.getFullYear(),o.getMonth(),r),n)}const hg=6048e5,EM=864e5,lE=6e4,cE=36e5;let _M={};function Cl(){return _M}function Kn(e,t){var s,u,l,c;const n=Cl(),r=(t==null?void 0:t.weekStartsOn)??((u=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((c=(l=n.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??0,o=Le(e),a=o.getDay(),i=(a<r?7:0)+a-r;return o.setDate(o.getDate()-i),o.setHours(0,0,0,0),o}function li(e){return Kn(e,{weekStartsOn:1})}function dE(e){const t=Le(e),n=t.getFullYear(),r=Qn(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const o=li(r),a=Qn(e,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const i=li(a);return t.getTime()>=o.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function Ds(e){const t=Le(e);return t.setHours(0,0,0,0),t}function xd(e){const t=Le(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Xr(e,t){const n=Ds(e),r=Ds(t),o=+n-xd(n),a=+r-xd(r);return Math.round((o-a)/EM)}function SM(e){const t=dE(e),n=Qn(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),li(n)}function wv(e,t){const n=t*7;return vn(e,n)}function kM(e,t){return Ir(e,t*12)}function RM(e){let t;return e.forEach(function(n){const r=Le(n);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function NM(e){let t;return e.forEach(n=>{const r=Le(n);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function Rn(e,t){const n=Ds(e),r=Ds(t);return+n==+r}function pg(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function DM(e){if(!pg(e)&&typeof e!="number")return!1;const t=Le(e);return!isNaN(Number(t))}function tl(e,t){const n=Le(e),r=Le(t),o=n.getFullYear()-r.getFullYear(),a=n.getMonth()-r.getMonth();return o*12+a}function IM(e,t,n){const r=Kn(e,n),o=Kn(t,n),a=+r-xd(r),i=+o-xd(o);return Math.round((a-i)/hg)}function vg(e){const t=Le(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function TM(e,t){const n=Le(e.start),r=Le(e.end);let o=+n>+r;const a=o?+n:+r,i=o?r:n;i.setHours(0,0,0,0);let s=1;const u=[];for(;+i<=a;)u.push(Le(i)),i.setDate(i.getDate()+s),i.setHours(0,0,0,0);return o?u.reverse():u}function Pn(e){const t=Le(e);return t.setDate(1),t.setHours(0,0,0,0),t}function fE(e){const t=Le(e),n=Qn(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function ts(e,t){var s,u,l,c;const n=Cl(),r=(t==null?void 0:t.weekStartsOn)??((u=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((c=(l=n.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??0,o=Le(e),a=o.getDay(),i=(a<r?-7:0)+6-(a-r);return o.setDate(o.getDate()+i),o.setHours(23,59,59,999),o}function hE(e){return ts(e,{weekStartsOn:1})}const PM={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},AM=(e,t,n)=>{let r;const o=PM[e];return typeof o=="string"?r=o:t===1?r=o.one:r=o.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Eh(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const MM={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},FM={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},OM={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},LM={date:Eh({formats:MM,defaultWidth:"full"}),time:Eh({formats:FM,defaultWidth:"full"}),dateTime:Eh({formats:OM,defaultWidth:"full"})},BM={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},jM=(e,t,n,r)=>BM[e];function nu(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let o;if(r==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,s=n!=null&&n.width?String(n.width):i;o=e.formattingValues[s]||e.formattingValues[i]}else{const i=e.defaultWidth,s=n!=null&&n.width?String(n.width):e.defaultWidth;o=e.values[s]||e.values[i]}const a=e.argumentCallback?e.argumentCallback(t):t;return o[a]}}const WM={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},zM={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},$M={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},UM={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},VM={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HM={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},GM=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},qM={ordinalNumber:GM,era:nu({values:WM,defaultWidth:"wide"}),quarter:nu({values:zM,defaultWidth:"wide",argumentCallback:e=>e-1}),month:nu({values:$M,defaultWidth:"wide"}),day:nu({values:UM,defaultWidth:"wide"}),dayPeriod:nu({values:VM,defaultWidth:"wide",formattingValues:HM,defaultFormattingWidth:"wide"})};function ru(e){return(t,n={})=>{const r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=t.match(o);if(!a)return null;const i=a[0],s=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(s)?YM(s,d=>d.test(i)):KM(s,d=>d.test(i));let l;l=e.valueCallback?e.valueCallback(u):u,l=n.valueCallback?n.valueCallback(l):l;const c=t.slice(i.length);return{value:l,rest:c}}}function KM(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function YM(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function XM(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const o=r[0],a=t.match(e.parsePattern);if(!a)return null;let i=e.valueCallback?e.valueCallback(a[0]):a[0];i=n.valueCallback?n.valueCallback(i):i;const s=t.slice(o.length);return{value:i,rest:s}}}const QM=/^(\d+)(th|st|nd|rd)?/i,JM=/\d+/i,ZM={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},e4={any:[/^b/i,/^(a|c)/i]},t4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},n4={any:[/1/i,/2/i,/3/i,/4/i]},r4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},o4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},a4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},i4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},s4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},u4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},l4={ordinalNumber:XM({matchPattern:QM,parsePattern:JM,valueCallback:e=>parseInt(e,10)}),era:ru({matchPatterns:ZM,defaultMatchWidth:"wide",parsePatterns:e4,defaultParseWidth:"any"}),quarter:ru({matchPatterns:t4,defaultMatchWidth:"wide",parsePatterns:n4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ru({matchPatterns:r4,defaultMatchWidth:"wide",parsePatterns:o4,defaultParseWidth:"any"}),day:ru({matchPatterns:a4,defaultMatchWidth:"wide",parsePatterns:i4,defaultParseWidth:"any"}),dayPeriod:ru({matchPatterns:s4,defaultMatchWidth:"any",parsePatterns:u4,defaultParseWidth:"any"})},pE={code:"en-US",formatDistance:AM,formatLong:LM,formatRelative:jM,localize:qM,match:l4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function c4(e){const t=Le(e);return Xr(t,fE(t))+1}function vE(e){const t=Le(e),n=+li(t)-+SM(t);return Math.round(n/hg)+1}function mE(e,t){var c,d,f,h;const n=Le(e),r=n.getFullYear(),o=Cl(),a=(t==null?void 0:t.firstWeekContainsDate)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??o.firstWeekContainsDate??((h=(f=o.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,i=Qn(e,0);i.setFullYear(r+1,0,a),i.setHours(0,0,0,0);const s=Kn(i,t),u=Qn(e,0);u.setFullYear(r,0,a),u.setHours(0,0,0,0);const l=Kn(u,t);return n.getTime()>=s.getTime()?r+1:n.getTime()>=l.getTime()?r:r-1}function d4(e,t){var s,u,l,c;const n=Cl(),r=(t==null?void 0:t.firstWeekContainsDate)??((u=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((c=(l=n.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??1,o=mE(e,t),a=Qn(e,0);return a.setFullYear(o,0,r),a.setHours(0,0,0,0),Kn(a,t)}function gE(e,t){const n=Le(e),r=+Kn(n,t)-+d4(n,t);return Math.round(r/hg)+1}function Ye(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const $o={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Ye(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Ye(n+1,2)},d(e,t){return Ye(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Ye(e.getHours()%12||12,t.length)},H(e,t){return Ye(e.getHours(),t.length)},m(e,t){return Ye(e.getMinutes(),t.length)},s(e,t){return Ye(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),o=Math.trunc(r*Math.pow(10,n-3));return Ye(o,t.length)}},_i={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Mx={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return $o.y(e,t)},Y:function(e,t,n,r){const o=mE(e,r),a=o>0?o:1-o;if(t==="YY"){const i=a%100;return Ye(i,2)}return t==="Yo"?n.ordinalNumber(a,{unit:"year"}):Ye(a,t.length)},R:function(e,t){const n=dE(e);return Ye(n,t.length)},u:function(e,t){const n=e.getFullYear();return Ye(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Ye(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Ye(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return $o.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Ye(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const o=gE(e,r);return t==="wo"?n.ordinalNumber(o,{unit:"week"}):Ye(o,t.length)},I:function(e,t,n){const r=vE(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Ye(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):$o.d(e,t)},D:function(e,t,n){const r=c4(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Ye(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const o=e.getDay(),a=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Ye(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const o=e.getDay(),a=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Ye(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),o=r===0?7:r;switch(t){case"i":return String(o);case"ii":return Ye(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const o=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let o;switch(r===12?o=_i.noon:r===0?o=_i.midnight:o=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let o;switch(r>=17?o=_i.evening:r>=12?o=_i.afternoon:r>=4?o=_i.morning:o=_i.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return $o.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):$o.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Ye(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Ye(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):$o.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):$o.s(e,t)},S:function(e,t){return $o.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Ox(r);case"XXXX":case"XX":return ja(r);case"XXXXX":case"XXX":default:return ja(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Ox(r);case"xxxx":case"xx":return ja(r);case"xxxxx":case"xxx":default:return ja(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Fx(r,":");case"OOOO":default:return"GMT"+ja(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Fx(r,":");case"zzzz":default:return"GMT"+ja(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return Ye(r,t.length)},T:function(e,t,n){const r=e.getTime();return Ye(r,t.length)}};function Fx(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),o=Math.trunc(r/60),a=r%60;return a===0?n+String(o):n+String(o)+t+Ye(a,2)}function Ox(e,t){return e%60===0?(e>0?"-":"+")+Ye(Math.abs(e)/60,2):ja(e,t)}function ja(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),o=Ye(Math.trunc(r/60),2),a=Ye(r%60,2);return n+o+t+a}const Lx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},yE=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},f4=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],o=n[2];if(!o)return Lx(e,t);let a;switch(r){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",Lx(r,t)).replace("{{time}}",yE(o,t))},h4={p:yE,P:f4},p4=/^D+$/,v4=/^Y+$/,m4=["D","DD","YY","YYYY"];function g4(e){return p4.test(e)}function y4(e){return v4.test(e)}function x4(e,t,n){const r=w4(e,t,n);if(console.warn(r),m4.includes(e))throw new RangeError(r)}function w4(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const b4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,C4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,E4=/^'([^]*?)'?$/,_4=/''/g,S4=/[a-zA-Z]/;function Ve(e,t,n){var c,d,f,h,p,m,g,v;const r=Cl(),o=(n==null?void 0:n.locale)??r.locale??pE,a=(n==null?void 0:n.firstWeekContainsDate)??((d=(c=n==null?void 0:n.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,i=(n==null?void 0:n.weekStartsOn)??((m=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??r.weekStartsOn??((v=(g=r.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,s=Le(e);if(!DM(s))throw new RangeError("Invalid time value");let u=t.match(C4).map(y=>{const x=y[0];if(x==="p"||x==="P"){const w=h4[x];return w(y,o.formatLong)}return y}).join("").match(b4).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const x=y[0];if(x==="'")return{isToken:!1,value:k4(y)};if(Mx[x])return{isToken:!0,value:y};if(x.match(S4))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:y}});o.localize.preprocessor&&(u=o.localize.preprocessor(s,u));const l={firstWeekContainsDate:a,weekStartsOn:i,locale:o};return u.map(y=>{if(!y.isToken)return y.value;const x=y.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&y4(x)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&g4(x))&&x4(x,t,String(e));const w=Mx[x[0]];return w(s,x,o.localize,l)}).join("")}function k4(e){const t=e.match(E4);return t?t[1].replace(_4,"'"):e}function R4(e){const t=Le(e),n=t.getFullYear(),r=t.getMonth(),o=Qn(e,0);return o.setFullYear(n,r+1,0),o.setHours(0,0,0,0),o.getDate()}function N4(e){return Math.trunc(+Le(e)/1e3)}function D4(e){const t=Le(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function I4(e,t){return IM(D4(e),Pn(e),t)+1}function bv(e,t){const n=Le(e),r=Le(t);return n.getTime()>r.getTime()}function xE(e,t){const n=Le(e),r=Le(t);return+n<+r}function mg(e,t){const n=Le(e),r=Le(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function T4(e,t){const n=Le(e),r=Le(t);return n.getFullYear()===r.getFullYear()}function sa(e,t){return vn(e,-t)}function _h(e,t){const r=F4(e);let o;if(r.date){const u=O4(r.date,2);o=L4(u.restDateString,u.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const a=o.getTime();let i=0,s;if(r.time&&(i=B4(r.time),isNaN(i)))return new Date(NaN);if(r.timezone){if(s=j4(r.timezone),isNaN(s))return new Date(NaN)}else{const u=new Date(a+i),l=new Date(0);return l.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),l.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),l}return new Date(a+i+s)}const ic={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},P4=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,A4=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,M4=/^([+-])(\d{2})(?::?(\d{2}))?$/;function F4(e){const t={},n=e.split(ic.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],ic.timeZoneDelimiter.test(t.date)&&(t.date=e.split(ic.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const o=ic.timezone.exec(r);o?(t.time=r.replace(o[1],""),t.timezone=o[1]):t.time=r}return t}function O4(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const o=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:a===null?o:a*100,restDateString:e.slice((r[1]||r[2]).length)}}function L4(e,t){if(t===null)return new Date(NaN);const n=e.match(P4);if(!n)return new Date(NaN);const r=!!n[4],o=ou(n[1]),a=ou(n[2])-1,i=ou(n[3]),s=ou(n[4]),u=ou(n[5])-1;if(r)return V4(t,s,u)?W4(t,s,u):new Date(NaN);{const l=new Date(0);return!$4(t,a,i)||!U4(t,o)?new Date(NaN):(l.setUTCFullYear(t,a,Math.max(o,i)),l)}}function ou(e){return e?parseInt(e):1}function B4(e){const t=e.match(A4);if(!t)return NaN;const n=Sh(t[1]),r=Sh(t[2]),o=Sh(t[3]);return H4(n,r,o)?n*cE+r*lE+o*1e3:NaN}function Sh(e){return e&&parseFloat(e.replace(",","."))||0}function j4(e){if(e==="Z")return 0;const t=e.match(M4);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return G4(r,o)?n*(r*cE+o*lE):NaN}function W4(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const o=r.getUTCDay()||7,a=(t-1)*7+n+1-o;return r.setUTCDate(r.getUTCDate()+a),r}const z4=[31,null,31,30,31,30,31,31,30,31,30,31];function wE(e){return e%400===0||e%4===0&&e%100!==0}function $4(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(z4[t]||(wE(e)?29:28))}function U4(e,t){return t>=1&&t<=(wE(e)?366:365)}function V4(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function H4(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function G4(e,t){return t>=0&&t<=59}function kh(e,t){const n=Le(e),r=n.getFullYear(),o=n.getDate(),a=Qn(e,0);a.setFullYear(r,t,15),a.setHours(0,0,0,0);const i=R4(a);return n.setMonth(t,Math.min(o,i)),n}function Bx(e,t){const n=Le(e);return isNaN(+n)?Qn(e,NaN):(n.setFullYear(t),n)}const bE=R.createContext(void 0),q4=()=>{const e=new Date,t=[];for(let n=0;n<30;n++){const r=sa(e,n);if(r.getDay()===0||r.getDay()===6)continue;const a=Math.floor(Math.random()*2)+8,i=Math.floor(Math.random()*60),s=`${a.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`;let u=null,l="present";if(Math.random()>.2){const c=Math.floor(Math.random()*2)+17,d=Math.floor(Math.random()*60);u=`${c.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`}else{const c=Math.random();c<.7?l="present":c<.8?l="half-day":c<.9?l="leave":l="absent"}t.push({id:`att-${n}`,date:Ve(r,"yyyy-MM-dd"),checkIn:n===0?s:"",checkOut:n===0?null:u,status:n===0?"present":l})}return t},K4=()=>{const e=new Date;return[{id:"abs-1",startDate:Ve(sa(e,-5),"yyyy-MM-dd"),endDate:Ve(sa(e,-6),"yyyy-MM-dd"),reason:"Annual leave",status:"approved"},{id:"abs-2",startDate:Ve(sa(e,-10),"yyyy-MM-dd"),endDate:Ve(sa(e,-10),"yyyy-MM-dd"),reason:"Medical appointment",status:"pending"}]},Y4=({children:e})=>{const[t,n]=R.useState(q4()),[r,o]=R.useState(K4()),[a,i]=R.useState(!1),s=async()=>{const d=Ve(new Date,"yyyy-MM-dd");return t.find(h=>h.date===d)||null},u=async(d,f)=>t.filter(h=>h.date>=d&&h.date<=f),l=async d=>{i(!0);try{await new Promise(v=>setTimeout(v,1500));const f=localStorage.getItem("locationData");let h=0,p=0;if(f){const v=JSON.parse(f);h=v.latitude,p=v.longitude}console.log("Sending attendance data:",{imageData:d.substring(0,50)+"...",latitude:h,longitude:p,timestamp:new Date().toISOString()});const m=Ve(new Date,"yyyy-MM-dd");if(t.find(v=>v.date===m)){const v=t.map(y=>y.date===m?y.checkIn&&!y.checkOut?{...y,checkOut:Ve(new Date,"HH:mm")}:{...y,checkIn:Ve(new Date,"HH:mm")}:y);n(v)}else{const v={id:`att-${t.length}`,date:m,checkIn:Ve(new Date,"HH:mm"),checkOut:null,status:"present"};n([v,...t])}return!0}catch(f){return console.error("Error marking attendance:",f),!1}finally{i(!1)}},c={todayAttendance:t.find(d=>d.date===Ve(new Date,"yyyy-MM-dd"))||null,attendanceHistory:t,absences:r,fetchTodayAttendance:s,fetchAttendanceByDateRange:u,markAttendance:l,isSubmitting:a};return C.jsx(bE.Provider,{value:c,children:e})},gg=()=>{const e=R.useContext(bE);if(e===void 0)throw new Error("useAttendance must be used within an AttendanceProvider");return e};var we=function(){return we=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},we.apply(this,arguments)};function X4(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function CE(e,t,n){for(var r=0,o=t.length,a;r<o;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function El(e){return e.mode==="multiple"}function _l(e){return e.mode==="range"}function bf(e){return e.mode==="single"}var Q4={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function J4(e,t){return Ve(e,"LLLL y",t)}function Z4(e,t){return Ve(e,"d",t)}function eF(e,t){return Ve(e,"LLLL",t)}function tF(e){return"".concat(e)}function nF(e,t){return Ve(e,"cccccc",t)}function rF(e,t){return Ve(e,"yyyy",t)}var oF=Object.freeze({__proto__:null,formatCaption:J4,formatDay:Z4,formatMonthCaption:eF,formatWeekNumber:tF,formatWeekdayName:nF,formatYearCaption:rF}),aF=function(e,t,n){return Ve(e,"do MMMM (EEEE)",n)},iF=function(){return"Month: "},sF=function(){return"Go to next month"},uF=function(){return"Go to previous month"},lF=function(e,t){return Ve(e,"cccc",t)},cF=function(e){return"Week n. ".concat(e)},dF=function(){return"Year: "},fF=Object.freeze({__proto__:null,labelDay:aF,labelMonthDropdown:iF,labelNext:sF,labelPrevious:uF,labelWeekNumber:cF,labelWeekday:lF,labelYearDropdown:dF});function hF(){var e="buttons",t=Q4,n=pE,r={},o={},a=1,i={},s=new Date;return{captionLayout:e,classNames:t,formatters:oF,labels:fF,locale:n,modifiersClassNames:r,modifiers:o,numberOfMonths:a,styles:i,today:s,mode:"default"}}function pF(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,o=e.toMonth,a=e.fromDate,i=e.toDate;return r?a=Pn(r):t&&(a=new Date(t,0,1)),o?i=vg(o):n&&(i=new Date(n,11,31)),{fromDate:a?Ds(a):void 0,toDate:i?Ds(i):void 0}}var EE=R.createContext(void 0);function vF(e){var t,n=e.initialProps,r=hF(),o=pF(n),a=o.fromDate,i=o.toDate,s=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;s!=="buttons"&&(!a||!i)&&(s="buttons");var u;(bf(n)||El(n)||_l(n))&&(u=n.onSelect);var l=we(we(we({},r),n),{captionLayout:s,classNames:we(we({},r.classNames),n.classNames),components:we({},n.components),formatters:we(we({},r.formatters),n.formatters),fromDate:a,labels:we(we({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:we(we({},r.modifiers),n.modifiers),modifiersClassNames:we(we({},r.modifiersClassNames),n.modifiersClassNames),onSelect:u,styles:we(we({},r.styles),n.styles),toDate:i});return C.jsx(EE.Provider,{value:l,children:e.children})}function tt(){var e=R.useContext(EE);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function _E(e){var t=tt(),n=t.locale,r=t.classNames,o=t.styles,a=t.formatters.formatCaption;return C.jsx("div",{className:r.caption_label,style:o.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:a(e.displayMonth,{locale:n})})}function mF(e){return C.jsx("svg",we({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:C.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function SE(e){var t,n,r=e.onChange,o=e.value,a=e.children,i=e.caption,s=e.className,u=e.style,l=tt(),c=(n=(t=l.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:mF;return C.jsxs("div",{className:s,style:u,children:[C.jsx("span",{className:l.classNames.vhidden,children:e["aria-label"]}),C.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:l.classNames.dropdown,style:l.styles.dropdown,value:o,onChange:r,children:a}),C.jsxs("div",{className:l.classNames.caption_label,style:l.styles.caption_label,"aria-hidden":"true",children:[i,C.jsx(c,{className:l.classNames.dropdown_icon,style:l.styles.dropdown_icon})]})]})}function gF(e){var t,n=tt(),r=n.fromDate,o=n.toDate,a=n.styles,i=n.locale,s=n.formatters.formatMonthCaption,u=n.classNames,l=n.components,c=n.labels.labelMonthDropdown;if(!r)return C.jsx(C.Fragment,{});if(!o)return C.jsx(C.Fragment,{});var d=[];if(T4(r,o))for(var f=Pn(r),h=r.getMonth();h<=o.getMonth();h++)d.push(kh(f,h));else for(var f=Pn(new Date),h=0;h<=11;h++)d.push(kh(f,h));var p=function(g){var v=Number(g.target.value),y=kh(Pn(e.displayMonth),v);e.onChange(y)},m=(t=l==null?void 0:l.Dropdown)!==null&&t!==void 0?t:SE;return C.jsx(m,{name:"months","aria-label":c(),className:u.dropdown_month,style:a.dropdown_month,onChange:p,value:e.displayMonth.getMonth(),caption:s(e.displayMonth,{locale:i}),children:d.map(function(g){return C.jsx("option",{value:g.getMonth(),children:s(g,{locale:i})},g.getMonth())})})}function yF(e){var t,n=e.displayMonth,r=tt(),o=r.fromDate,a=r.toDate,i=r.locale,s=r.styles,u=r.classNames,l=r.components,c=r.formatters.formatYearCaption,d=r.labels.labelYearDropdown,f=[];if(!o)return C.jsx(C.Fragment,{});if(!a)return C.jsx(C.Fragment,{});for(var h=o.getFullYear(),p=a.getFullYear(),m=h;m<=p;m++)f.push(Bx(fE(new Date),m));var g=function(y){var x=Bx(Pn(n),Number(y.target.value));e.onChange(x)},v=(t=l==null?void 0:l.Dropdown)!==null&&t!==void 0?t:SE;return C.jsx(v,{name:"years","aria-label":d(),className:u.dropdown_year,style:s.dropdown_year,onChange:g,value:n.getFullYear(),caption:c(n,{locale:i}),children:f.map(function(y){return C.jsx("option",{value:y.getFullYear(),children:c(y,{locale:i})},y.getFullYear())})})}function xF(e,t){var n=R.useState(e),r=n[0],o=n[1],a=t===void 0?r:t;return[a,o]}function wF(e){var t=e.month,n=e.defaultMonth,r=e.today,o=t||n||r||new Date,a=e.toDate,i=e.fromDate,s=e.numberOfMonths,u=s===void 0?1:s;if(a&&tl(a,o)<0){var l=-1*(u-1);o=Ir(a,l)}return i&&tl(o,i)<0&&(o=i),Pn(o)}function bF(){var e=tt(),t=wF(e),n=xF(t,e.month),r=n[0],o=n[1],a=function(i){var s;if(!e.disableNavigation){var u=Pn(i);o(u),(s=e.onMonthChange)===null||s===void 0||s.call(e,u)}};return[r,a]}function CF(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,o=Pn(e),a=Pn(Ir(o,r)),i=tl(a,o),s=[],u=0;u<i;u++){var l=Ir(o,u);s.push(l)}return n&&(s=s.reverse()),s}function EF(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,o=t.numberOfMonths,a=o===void 0?1:o,i=r?a:1,s=Pn(e);if(!n)return Ir(s,i);var u=tl(n,e);if(!(u<a))return Ir(s,i)}}function _F(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,o=t.numberOfMonths,a=o===void 0?1:o,i=r?a:1,s=Pn(e);if(!n)return Ir(s,-i);var u=tl(s,n);if(!(u<=0))return Ir(s,-i)}}var kE=R.createContext(void 0);function SF(e){var t=tt(),n=bF(),r=n[0],o=n[1],a=CF(r,t),i=EF(r,t),s=_F(r,t),u=function(d){return a.some(function(f){return mg(d,f)})},l=function(d,f){u(d)||(f&&xE(d,f)?o(Ir(d,1+t.numberOfMonths*-1)):o(d))},c={currentMonth:r,displayMonths:a,goToMonth:o,goToDate:l,previousMonth:s,nextMonth:i,isDateDisplayed:u};return C.jsx(kE.Provider,{value:c,children:e.children})}function Sl(){var e=R.useContext(kE);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function jx(e){var t,n=tt(),r=n.classNames,o=n.styles,a=n.components,i=Sl().goToMonth,s=function(c){i(Ir(c,e.displayIndex?-e.displayIndex:0))},u=(t=a==null?void 0:a.CaptionLabel)!==null&&t!==void 0?t:_E,l=C.jsx(u,{id:e.id,displayMonth:e.displayMonth});return C.jsxs("div",{className:r.caption_dropdowns,style:o.caption_dropdowns,children:[C.jsx("div",{className:r.vhidden,children:l}),C.jsx(gF,{onChange:s,displayMonth:e.displayMonth}),C.jsx(yF,{onChange:s,displayMonth:e.displayMonth})]})}function kF(e){return C.jsx("svg",we({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:C.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function RF(e){return C.jsx("svg",we({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:C.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var wd=R.forwardRef(function(e,t){var n=tt(),r=n.classNames,o=n.styles,a=[r.button_reset,r.button];e.className&&a.push(e.className);var i=a.join(" "),s=we(we({},o.button_reset),o.button);return e.style&&Object.assign(s,e.style),C.jsx("button",we({},e,{ref:t,type:"button",className:i,style:s}))});function NF(e){var t,n,r=tt(),o=r.dir,a=r.locale,i=r.classNames,s=r.styles,u=r.labels,l=u.labelPrevious,c=u.labelNext,d=r.components;if(!e.nextMonth&&!e.previousMonth)return C.jsx(C.Fragment,{});var f=l(e.previousMonth,{locale:a}),h=[i.nav_button,i.nav_button_previous].join(" "),p=c(e.nextMonth,{locale:a}),m=[i.nav_button,i.nav_button_next].join(" "),g=(t=d==null?void 0:d.IconRight)!==null&&t!==void 0?t:RF,v=(n=d==null?void 0:d.IconLeft)!==null&&n!==void 0?n:kF;return C.jsxs("div",{className:i.nav,style:s.nav,children:[!e.hidePrevious&&C.jsx(wd,{name:"previous-month","aria-label":f,className:h,style:s.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:o==="rtl"?C.jsx(g,{className:i.nav_icon,style:s.nav_icon}):C.jsx(v,{className:i.nav_icon,style:s.nav_icon})}),!e.hideNext&&C.jsx(wd,{name:"next-month","aria-label":p,className:m,style:s.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:o==="rtl"?C.jsx(v,{className:i.nav_icon,style:s.nav_icon}):C.jsx(g,{className:i.nav_icon,style:s.nav_icon})})]})}function Wx(e){var t=tt().numberOfMonths,n=Sl(),r=n.previousMonth,o=n.nextMonth,a=n.goToMonth,i=n.displayMonths,s=i.findIndex(function(p){return mg(e.displayMonth,p)}),u=s===0,l=s===i.length-1,c=t>1&&(u||!l),d=t>1&&(l||!u),f=function(){r&&a(r)},h=function(){o&&a(o)};return C.jsx(NF,{displayMonth:e.displayMonth,hideNext:c,hidePrevious:d,nextMonth:o,previousMonth:r,onPreviousClick:f,onNextClick:h})}function DF(e){var t,n=tt(),r=n.classNames,o=n.disableNavigation,a=n.styles,i=n.captionLayout,s=n.components,u=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:_E,l;return o?l=C.jsx(u,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?l=C.jsx(jx,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?l=C.jsxs(C.Fragment,{children:[C.jsx(jx,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),C.jsx(Wx,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):l=C.jsxs(C.Fragment,{children:[C.jsx(u,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),C.jsx(Wx,{displayMonth:e.displayMonth,id:e.id})]}),C.jsx("div",{className:r.caption,style:a.caption,children:l})}function IF(e){var t=tt(),n=t.footer,r=t.styles,o=t.classNames.tfoot;return n?C.jsx("tfoot",{className:o,style:r.tfoot,children:C.jsx("tr",{children:C.jsx("td",{colSpan:8,children:n})})}):C.jsx(C.Fragment,{})}function TF(e,t,n){for(var r=n?li(new Date):Kn(new Date,{locale:e,weekStartsOn:t}),o=[],a=0;a<7;a++){var i=vn(r,a);o.push(i)}return o}function PF(){var e=tt(),t=e.classNames,n=e.styles,r=e.showWeekNumber,o=e.locale,a=e.weekStartsOn,i=e.ISOWeek,s=e.formatters.formatWeekdayName,u=e.labels.labelWeekday,l=TF(o,a,i);return C.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&C.jsx("td",{style:n.head_cell,className:t.head_cell}),l.map(function(c,d){return C.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":u(c,{locale:o}),children:s(c,{locale:o})},d)})]})}function AF(){var e,t=tt(),n=t.classNames,r=t.styles,o=t.components,a=(e=o==null?void 0:o.HeadRow)!==null&&e!==void 0?e:PF;return C.jsx("thead",{style:r.head,className:n.head,children:C.jsx(a,{})})}function MF(e){var t=tt(),n=t.locale,r=t.formatters.formatDay;return C.jsx(C.Fragment,{children:r(e.date,{locale:n})})}var yg=R.createContext(void 0);function FF(e){if(!El(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return C.jsx(yg.Provider,{value:t,children:e.children})}return C.jsx(OF,{initialProps:e.initialProps,children:e.children})}function OF(e){var t=e.initialProps,n=e.children,r=t.selected,o=t.min,a=t.max,i=function(l,c,d){var f,h;(f=t.onDayClick)===null||f===void 0||f.call(t,l,c,d);var p=!!(c.selected&&o&&(r==null?void 0:r.length)===o);if(!p){var m=!!(!c.selected&&a&&(r==null?void 0:r.length)===a);if(!m){var g=r?CE([],r):[];if(c.selected){var v=g.findIndex(function(y){return Rn(l,y)});g.splice(v,1)}else g.push(l);(h=t.onSelect)===null||h===void 0||h.call(t,g,l,c,d)}}},s={disabled:[]};r&&s.disabled.push(function(l){var c=a&&r.length>a-1,d=r.some(function(f){return Rn(f,l)});return!!(c&&!d)});var u={selected:r,onDayClick:i,modifiers:s};return C.jsx(yg.Provider,{value:u,children:n})}function xg(){var e=R.useContext(yg);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function LF(e,t){var n=t||{},r=n.from,o=n.to;return r&&o?Rn(o,e)&&Rn(r,e)?void 0:Rn(o,e)?{from:o,to:void 0}:Rn(r,e)?void 0:bv(r,e)?{from:e,to:o}:{from:r,to:e}:o?bv(e,o)?{from:o,to:e}:{from:e,to:o}:r?xE(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var wg=R.createContext(void 0);function BF(e){if(!_l(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return C.jsx(wg.Provider,{value:t,children:e.children})}return C.jsx(jF,{initialProps:e.initialProps,children:e.children})}function jF(e){var t=e.initialProps,n=e.children,r=t.selected,o=r||{},a=o.from,i=o.to,s=t.min,u=t.max,l=function(h,p,m){var g,v;(g=t.onDayClick)===null||g===void 0||g.call(t,h,p,m);var y=LF(h,r);(v=t.onSelect)===null||v===void 0||v.call(t,y,h,p,m)},c={range_start:[],range_end:[],range_middle:[],disabled:[]};if(a?(c.range_start=[a],i?(c.range_end=[i],Rn(a,i)||(c.range_middle=[{after:a,before:i}])):c.range_end=[a]):i&&(c.range_start=[i],c.range_end=[i]),s&&(a&&!i&&c.disabled.push({after:sa(a,s-1),before:vn(a,s-1)}),a&&i&&c.disabled.push({after:a,before:vn(a,s-1)}),!a&&i&&c.disabled.push({after:sa(i,s-1),before:vn(i,s-1)})),u){if(a&&!i&&(c.disabled.push({before:vn(a,-u+1)}),c.disabled.push({after:vn(a,u-1)})),a&&i){var d=Xr(i,a)+1,f=u-d;c.disabled.push({before:sa(a,f)}),c.disabled.push({after:vn(i,f)})}!a&&i&&(c.disabled.push({before:vn(i,-u+1)}),c.disabled.push({after:vn(i,u-1)}))}return C.jsx(wg.Provider,{value:{selected:r,onDayClick:l,modifiers:c},children:n})}function bg(){var e=R.useContext(wg);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Bc(e){return Array.isArray(e)?CE([],e):e!==void 0?[e]:[]}function WF(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],o=n[1];t[r]=Bc(o)}),t}var Tr;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Tr||(Tr={}));var zF=Tr.Selected,mo=Tr.Disabled,$F=Tr.Hidden,UF=Tr.Today,Rh=Tr.RangeEnd,Nh=Tr.RangeMiddle,Dh=Tr.RangeStart,VF=Tr.Outside;function HF(e,t,n){var r,o=(r={},r[zF]=Bc(e.selected),r[mo]=Bc(e.disabled),r[$F]=Bc(e.hidden),r[UF]=[e.today],r[Rh]=[],r[Nh]=[],r[Dh]=[],r[VF]=[],r);return e.fromDate&&o[mo].push({before:e.fromDate}),e.toDate&&o[mo].push({after:e.toDate}),El(e)?o[mo]=o[mo].concat(t.modifiers[mo]):_l(e)&&(o[mo]=o[mo].concat(n.modifiers[mo]),o[Dh]=n.modifiers[Dh],o[Nh]=n.modifiers[Nh],o[Rh]=n.modifiers[Rh]),o}var RE=R.createContext(void 0);function GF(e){var t=tt(),n=xg(),r=bg(),o=HF(t,n,r),a=WF(t.modifiers),i=we(we({},o),a);return C.jsx(RE.Provider,{value:i,children:e.children})}function NE(){var e=R.useContext(RE);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function qF(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function KF(e){return!!(e&&typeof e=="object"&&"from"in e)}function YF(e){return!!(e&&typeof e=="object"&&"after"in e)}function XF(e){return!!(e&&typeof e=="object"&&"before"in e)}function QF(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function JF(e,t){var n,r=t.from,o=t.to;if(r&&o){var a=Xr(o,r)<0;a&&(n=[o,r],r=n[0],o=n[1]);var i=Xr(e,r)>=0&&Xr(o,e)>=0;return i}return o?Rn(o,e):r?Rn(r,e):!1}function ZF(e){return pg(e)}function e3(e){return Array.isArray(e)&&e.every(pg)}function t3(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(ZF(n))return Rn(e,n);if(e3(n))return n.includes(e);if(KF(n))return JF(e,n);if(QF(n))return n.dayOfWeek.includes(e.getDay());if(qF(n)){var r=Xr(n.before,e),o=Xr(n.after,e),a=r>0,i=o<0,s=bv(n.before,n.after);return s?i&&a:a||i}return YF(n)?Xr(e,n.after)>0:XF(n)?Xr(n.before,e)>0:typeof n=="function"?n(e):!1})}function Cg(e,t,n){var r=Object.keys(t).reduce(function(a,i){var s=t[i];return t3(e,s)&&a.push(i),a},[]),o={};return r.forEach(function(a){return o[a]=!0}),n&&!mg(e,n)&&(o.outside=!0),o}function n3(e,t){for(var n=Pn(e[0]),r=vg(e[e.length-1]),o,a,i=n;i<=r;){var s=Cg(i,t),u=!s.disabled&&!s.hidden;if(!u){i=vn(i,1);continue}if(s.selected)return i;s.today&&!a&&(a=i),o||(o=i),i=vn(i,1)}return a||o}var r3=365;function DE(e,t){var n=t.moveBy,r=t.direction,o=t.context,a=t.modifiers,i=t.retry,s=i===void 0?{count:0,lastFocused:e}:i,u=o.weekStartsOn,l=o.fromDate,c=o.toDate,d=o.locale,f={day:vn,week:wv,month:Ir,year:kM,startOfWeek:function(g){return o.ISOWeek?li(g):Kn(g,{locale:d,weekStartsOn:u})},endOfWeek:function(g){return o.ISOWeek?hE(g):ts(g,{locale:d,weekStartsOn:u})}},h=f[n](e,r==="after"?1:-1);r==="before"&&l?h=RM([l,h]):r==="after"&&c&&(h=NM([c,h]));var p=!0;if(a){var m=Cg(h,a);p=!m.disabled&&!m.hidden}return p?h:s.count>r3?s.lastFocused:DE(h,{moveBy:n,direction:r,context:o,modifiers:a,retry:we(we({},s),{count:s.count+1})})}var IE=R.createContext(void 0);function o3(e){var t=Sl(),n=NE(),r=R.useState(),o=r[0],a=r[1],i=R.useState(),s=i[0],u=i[1],l=n3(t.displayMonths,n),c=o??(s&&t.isDateDisplayed(s))?s:l,d=function(){u(o),a(void 0)},f=function(g){a(g)},h=tt(),p=function(g,v){if(o){var y=DE(o,{moveBy:g,direction:v,context:h,modifiers:n});Rn(o,y)||(t.goToDate(y,o),f(y))}},m={focusedDay:o,focusTarget:c,blur:d,focus:f,focusDayAfter:function(){return p("day","after")},focusDayBefore:function(){return p("day","before")},focusWeekAfter:function(){return p("week","after")},focusWeekBefore:function(){return p("week","before")},focusMonthBefore:function(){return p("month","before")},focusMonthAfter:function(){return p("month","after")},focusYearBefore:function(){return p("year","before")},focusYearAfter:function(){return p("year","after")},focusStartOfWeek:function(){return p("startOfWeek","before")},focusEndOfWeek:function(){return p("endOfWeek","after")}};return C.jsx(IE.Provider,{value:m,children:e.children})}function Eg(){var e=R.useContext(IE);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function a3(e,t){var n=NE(),r=Cg(e,n,t);return r}var _g=R.createContext(void 0);function i3(e){if(!bf(e.initialProps)){var t={selected:void 0};return C.jsx(_g.Provider,{value:t,children:e.children})}return C.jsx(s3,{initialProps:e.initialProps,children:e.children})}function s3(e){var t=e.initialProps,n=e.children,r=function(a,i,s){var u,l,c;if((u=t.onDayClick)===null||u===void 0||u.call(t,a,i,s),i.selected&&!t.required){(l=t.onSelect)===null||l===void 0||l.call(t,void 0,a,i,s);return}(c=t.onSelect)===null||c===void 0||c.call(t,a,a,i,s)},o={selected:t.selected,onDayClick:r};return C.jsx(_g.Provider,{value:o,children:n})}function TE(){var e=R.useContext(_g);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function u3(e,t){var n=tt(),r=TE(),o=xg(),a=bg(),i=Eg(),s=i.focusDayAfter,u=i.focusDayBefore,l=i.focusWeekAfter,c=i.focusWeekBefore,d=i.blur,f=i.focus,h=i.focusMonthBefore,p=i.focusMonthAfter,m=i.focusYearBefore,g=i.focusYearAfter,v=i.focusStartOfWeek,y=i.focusEndOfWeek,x=function(j){var D,F,z,H;bf(n)?(D=r.onDayClick)===null||D===void 0||D.call(r,e,t,j):El(n)?(F=o.onDayClick)===null||F===void 0||F.call(o,e,t,j):_l(n)?(z=a.onDayClick)===null||z===void 0||z.call(a,e,t,j):(H=n.onDayClick)===null||H===void 0||H.call(n,e,t,j)},w=function(j){var D;f(e),(D=n.onDayFocus)===null||D===void 0||D.call(n,e,t,j)},b=function(j){var D;d(),(D=n.onDayBlur)===null||D===void 0||D.call(n,e,t,j)},E=function(j){var D;(D=n.onDayMouseEnter)===null||D===void 0||D.call(n,e,t,j)},S=function(j){var D;(D=n.onDayMouseLeave)===null||D===void 0||D.call(n,e,t,j)},_=function(j){var D;(D=n.onDayPointerEnter)===null||D===void 0||D.call(n,e,t,j)},k=function(j){var D;(D=n.onDayPointerLeave)===null||D===void 0||D.call(n,e,t,j)},N=function(j){var D;(D=n.onDayTouchCancel)===null||D===void 0||D.call(n,e,t,j)},A=function(j){var D;(D=n.onDayTouchEnd)===null||D===void 0||D.call(n,e,t,j)},T=function(j){var D;(D=n.onDayTouchMove)===null||D===void 0||D.call(n,e,t,j)},L=function(j){var D;(D=n.onDayTouchStart)===null||D===void 0||D.call(n,e,t,j)},M=function(j){var D;(D=n.onDayKeyUp)===null||D===void 0||D.call(n,e,t,j)},$=function(j){var D;switch(j.key){case"ArrowLeft":j.preventDefault(),j.stopPropagation(),n.dir==="rtl"?s():u();break;case"ArrowRight":j.preventDefault(),j.stopPropagation(),n.dir==="rtl"?u():s();break;case"ArrowDown":j.preventDefault(),j.stopPropagation(),l();break;case"ArrowUp":j.preventDefault(),j.stopPropagation(),c();break;case"PageUp":j.preventDefault(),j.stopPropagation(),j.shiftKey?m():h();break;case"PageDown":j.preventDefault(),j.stopPropagation(),j.shiftKey?g():p();break;case"Home":j.preventDefault(),j.stopPropagation(),v();break;case"End":j.preventDefault(),j.stopPropagation(),y();break}(D=n.onDayKeyDown)===null||D===void 0||D.call(n,e,t,j)},U={onClick:x,onFocus:w,onBlur:b,onKeyDown:$,onKeyUp:M,onMouseEnter:E,onMouseLeave:S,onPointerEnter:_,onPointerLeave:k,onTouchCancel:N,onTouchEnd:A,onTouchMove:T,onTouchStart:L};return U}function l3(){var e=tt(),t=TE(),n=xg(),r=bg(),o=bf(e)?t.selected:El(e)?n.selected:_l(e)?r.selected:void 0;return o}function c3(e){return Object.values(Tr).includes(e)}function d3(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var o=e.modifiersClassNames[r];if(o)n.push(o);else if(c3(r)){var a=e.classNames["day_".concat(r)];a&&n.push(a)}}),n}function f3(e,t){var n=we({},e.styles.day);return Object.keys(t).forEach(function(r){var o;n=we(we({},n),(o=e.modifiersStyles)===null||o===void 0?void 0:o[r])}),n}function h3(e,t,n){var r,o,a,i=tt(),s=Eg(),u=a3(e,t),l=u3(e,u),c=l3(),d=!!(i.onDayClick||i.mode!=="default");R.useEffect(function(){var E;u.outside||s.focusedDay&&d&&Rn(s.focusedDay,e)&&((E=n.current)===null||E===void 0||E.focus())},[s.focusedDay,e,n,d,u.outside]);var f=d3(i,u).join(" "),h=f3(i,u),p=!!(u.outside&&!i.showOutsideDays||u.hidden),m=(a=(o=i.components)===null||o===void 0?void 0:o.DayContent)!==null&&a!==void 0?a:MF,g=C.jsx(m,{date:e,displayMonth:t,activeModifiers:u}),v={style:h,className:f,children:g,role:"gridcell"},y=s.focusTarget&&Rn(s.focusTarget,e)&&!u.outside,x=s.focusedDay&&Rn(s.focusedDay,e),w=we(we(we({},v),(r={disabled:u.disabled,role:"gridcell"},r["aria-selected"]=u.selected,r.tabIndex=x||y?0:-1,r)),l),b={isButton:d,isHidden:p,activeModifiers:u,selectedDays:c,buttonProps:w,divProps:v};return b}function p3(e){var t=R.useRef(null),n=h3(e.date,e.displayMonth,t);return n.isHidden?C.jsx("div",{role:"gridcell"}):n.isButton?C.jsx(wd,we({name:"day",ref:t},n.buttonProps)):C.jsx("div",we({},n.divProps))}function v3(e){var t=e.number,n=e.dates,r=tt(),o=r.onWeekNumberClick,a=r.styles,i=r.classNames,s=r.locale,u=r.labels.labelWeekNumber,l=r.formatters.formatWeekNumber,c=l(Number(t),{locale:s});if(!o)return C.jsx("span",{className:i.weeknumber,style:a.weeknumber,children:c});var d=u(Number(t),{locale:s}),f=function(h){o(t,n,h)};return C.jsx(wd,{name:"week-number","aria-label":d,className:i.weeknumber,style:a.weeknumber,onClick:f,children:c})}function m3(e){var t,n,r=tt(),o=r.styles,a=r.classNames,i=r.showWeekNumber,s=r.components,u=(t=s==null?void 0:s.Day)!==null&&t!==void 0?t:p3,l=(n=s==null?void 0:s.WeekNumber)!==null&&n!==void 0?n:v3,c;return i&&(c=C.jsx("td",{className:a.cell,style:o.cell,children:C.jsx(l,{number:e.weekNumber,dates:e.dates})})),C.jsxs("tr",{className:a.row,style:o.row,children:[c,e.dates.map(function(d){return C.jsx("td",{className:a.cell,style:o.cell,role:"presentation",children:C.jsx(u,{displayMonth:e.displayMonth,date:d})},N4(d))})]})}function zx(e,t,n){for(var r=n!=null&&n.ISOWeek?hE(t):ts(t,n),o=n!=null&&n.ISOWeek?li(e):Kn(e,n),a=Xr(r,o),i=[],s=0;s<=a;s++)i.push(vn(o,s));var u=i.reduce(function(l,c){var d=n!=null&&n.ISOWeek?vE(c):gE(c,n),f=l.find(function(h){return h.weekNumber===d});return f?(f.dates.push(c),l):(l.push({weekNumber:d,dates:[c]}),l)},[]);return u}function g3(e,t){var n=zx(Pn(e),vg(e),t);if(t!=null&&t.useFixedWeeks){var r=I4(e,t);if(r<6){var o=n[n.length-1],a=o.dates[o.dates.length-1],i=wv(a,6-r),s=zx(wv(a,1),i,t);n.push.apply(n,s)}}return n}function y3(e){var t,n,r,o=tt(),a=o.locale,i=o.classNames,s=o.styles,u=o.hideHead,l=o.fixedWeeks,c=o.components,d=o.weekStartsOn,f=o.firstWeekContainsDate,h=o.ISOWeek,p=g3(e.displayMonth,{useFixedWeeks:!!l,ISOWeek:h,locale:a,weekStartsOn:d,firstWeekContainsDate:f}),m=(t=c==null?void 0:c.Head)!==null&&t!==void 0?t:AF,g=(n=c==null?void 0:c.Row)!==null&&n!==void 0?n:m3,v=(r=c==null?void 0:c.Footer)!==null&&r!==void 0?r:IF;return C.jsxs("table",{id:e.id,className:i.table,style:s.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!u&&C.jsx(m,{}),C.jsx("tbody",{className:i.tbody,style:s.tbody,children:p.map(function(y){return C.jsx(g,{displayMonth:e.displayMonth,dates:y.dates,weekNumber:y.weekNumber},y.weekNumber)})}),C.jsx(v,{displayMonth:e.displayMonth})]})}function x3(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var w3=x3()?R.useLayoutEffect:R.useEffect,Ih=!1,b3=0;function $x(){return"react-day-picker-".concat(++b3)}function C3(e){var t,n=e??(Ih?$x():null),r=R.useState(n),o=r[0],a=r[1];return w3(function(){o===null&&a($x())},[]),R.useEffect(function(){Ih===!1&&(Ih=!0)},[]),(t=e??o)!==null&&t!==void 0?t:void 0}function E3(e){var t,n,r=tt(),o=r.dir,a=r.classNames,i=r.styles,s=r.components,u=Sl().displayMonths,l=C3(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),c=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,d=[a.month],f=i.month,h=e.displayIndex===0,p=e.displayIndex===u.length-1,m=!h&&!p;o==="rtl"&&(t=[h,p],p=t[0],h=t[1]),h&&(d.push(a.caption_start),f=we(we({},f),i.caption_start)),p&&(d.push(a.caption_end),f=we(we({},f),i.caption_end)),m&&(d.push(a.caption_between),f=we(we({},f),i.caption_between));var g=(n=s==null?void 0:s.Caption)!==null&&n!==void 0?n:DF;return C.jsxs("div",{className:d.join(" "),style:f,children:[C.jsx(g,{id:l,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),C.jsx(y3,{id:c,"aria-labelledby":l,displayMonth:e.displayMonth})]},e.displayIndex)}function _3(e){var t=tt(),n=t.classNames,r=t.styles;return C.jsx("div",{className:n.months,style:r.months,children:e.children})}function S3(e){var t,n,r=e.initialProps,o=tt(),a=Eg(),i=Sl(),s=R.useState(!1),u=s[0],l=s[1];R.useEffect(function(){o.initialFocus&&a.focusTarget&&(u||(a.focus(a.focusTarget),l(!0)))},[o.initialFocus,u,a.focus,a.focusTarget,a]);var c=[o.classNames.root,o.className];o.numberOfMonths>1&&c.push(o.classNames.multiple_months),o.showWeekNumber&&c.push(o.classNames.with_weeknumber);var d=we(we({},o.styles.root),o.style),f=Object.keys(r).filter(function(p){return p.startsWith("data-")}).reduce(function(p,m){var g;return we(we({},p),(g={},g[m]=r[m],g))},{}),h=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:_3;return C.jsx("div",we({className:c.join(" "),style:d,dir:o.dir,id:o.id,nonce:r.nonce,title:r.title,lang:r.lang},f,{children:C.jsx(h,{children:i.displayMonths.map(function(p,m){return C.jsx(E3,{displayIndex:m,displayMonth:p},m)})})}))}function k3(e){var t=e.children,n=X4(e,["children"]);return C.jsx(vF,{initialProps:n,children:C.jsx(SF,{children:C.jsx(i3,{initialProps:n,children:C.jsx(FF,{initialProps:n,children:C.jsx(BF,{initialProps:n,children:C.jsx(GF,{children:C.jsx(o3,{children:t})})})})})})})}function R3(e){return C.jsx(k3,we({},e,{children:C.jsx(S3,{initialProps:e})}))}function PE({className:e,classNames:t,showOutsideDays:n=!0,...r}){return C.jsx(R3,{showOutsideDays:n,className:wt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:wt(vv({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:wt(vv({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...o})=>C.jsx(VD,{className:"h-4 w-4"}),IconRight:({...o})=>C.jsx(HD,{className:"h-4 w-4"})},...r})}PE.displayName="Calendar";function N3(e,t=[]){let n=[];function r(a,i){const s=R.createContext(i),u=n.length;n=[...n,i];function l(d){const{scope:f,children:h,...p}=d,m=(f==null?void 0:f[e][u])||s,g=R.useMemo(()=>p,Object.values(p));return C.jsx(m.Provider,{value:g,children:h})}function c(d,f){const h=(f==null?void 0:f[e][u])||s,p=R.useContext(h);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return l.displayName=a+"Provider",[l,c]}const o=()=>{const a=n.map(i=>R.createContext(i));return function(s){const u=(s==null?void 0:s[e])||a;return R.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,D3(o,...t)]}function D3(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(a){const i=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(a)[`__scope${l}`];return{...s,...d}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var I3=R.createContext(void 0);function AE(e){const t=R.useContext(I3);return e||t||"ltr"}var Th="rovingFocusGroup.onEntryFocus",T3={bubbles:!1,cancelable:!0},Cf="RovingFocusGroup",[Cv,ME,P3]=b2(Cf),[A3,FE]=N3(Cf,[P3]),[M3,F3]=A3(Cf),OE=R.forwardRef((e,t)=>C.jsx(Cv.Provider,{scope:e.__scopeRovingFocusGroup,children:C.jsx(Cv.Slot,{scope:e.__scopeRovingFocusGroup,children:C.jsx(O3,{...e,ref:t})})}));OE.displayName=Cf;var O3=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:u,onEntryFocus:l,preventScrollOnEntryFocus:c=!1,...d}=e,f=R.useRef(null),h=cr(t,f),p=AE(a),[m=null,g]=Hm({prop:i,defaultProp:s,onChange:u}),[v,y]=R.useState(!1),x=Rr(l),w=ME(n),b=R.useRef(!1),[E,S]=R.useState(0);return R.useEffect(()=>{const _=f.current;if(_)return _.addEventListener(Th,x),()=>_.removeEventListener(Th,x)},[x]),C.jsx(M3,{scope:n,orientation:r,dir:p,loop:o,currentTabStopId:m,onItemFocus:R.useCallback(_=>g(_),[g]),onItemShiftTab:R.useCallback(()=>y(!0),[]),onFocusableItemAdd:R.useCallback(()=>S(_=>_+1),[]),onFocusableItemRemove:R.useCallback(()=>S(_=>_-1),[]),children:C.jsx(Nt.div,{tabIndex:v||E===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...e.style},onMouseDown:Qe(e.onMouseDown,()=>{b.current=!0}),onFocus:Qe(e.onFocus,_=>{const k=!b.current;if(_.target===_.currentTarget&&k&&!v){const N=new CustomEvent(Th,T3);if(_.currentTarget.dispatchEvent(N),!N.defaultPrevented){const A=w().filter(U=>U.focusable),T=A.find(U=>U.active),L=A.find(U=>U.id===m),$=[T,L,...A].filter(Boolean).map(U=>U.ref.current);jE($,c)}}b.current=!1}),onBlur:Qe(e.onBlur,()=>y(!1))})})}),LE="RovingFocusGroupItem",BE=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:a,...i}=e,s=sC(),u=a||s,l=F3(LE,n),c=l.currentTabStopId===u,d=ME(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=l;return R.useEffect(()=>{if(r)return f(),()=>h()},[r,f,h]),C.jsx(Cv.ItemSlot,{scope:n,id:u,focusable:r,active:o,children:C.jsx(Nt.span,{tabIndex:c?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:Qe(e.onMouseDown,p=>{r?l.onItemFocus(u):p.preventDefault()}),onFocus:Qe(e.onFocus,()=>l.onItemFocus(u)),onKeyDown:Qe(e.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){l.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const m=j3(p,l.orientation,l.dir);if(m!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(y=>y.focusable).map(y=>y.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const y=v.indexOf(p.currentTarget);v=l.loop?W3(v,y+1):v.slice(y+1)}setTimeout(()=>jE(v))}})})})});BE.displayName=LE;var L3={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function B3(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function j3(e,t,n){const r=B3(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return L3[r]}function jE(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function W3(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var z3=OE,$3=BE,Sg="Tabs",[U3,K$]=Um(Sg,[FE]),WE=FE(),[V3,kg]=U3(Sg),zE=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:a,orientation:i="horizontal",dir:s,activationMode:u="automatic",...l}=e,c=AE(s),[d,f]=Hm({prop:r,onChange:o,defaultProp:a});return C.jsx(V3,{scope:n,baseId:sC(),value:d,onValueChange:f,orientation:i,dir:c,activationMode:u,children:C.jsx(Nt.div,{dir:c,"data-orientation":i,...l,ref:t})})});zE.displayName=Sg;var $E="TabsList",UE=R.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...o}=e,a=kg($E,n),i=WE(n);return C.jsx(z3,{asChild:!0,...i,orientation:a.orientation,dir:a.dir,loop:r,children:C.jsx(Nt.div,{role:"tablist","aria-orientation":a.orientation,...o,ref:t})})});UE.displayName=$E;var VE="TabsTrigger",HE=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...a}=e,i=kg(VE,n),s=WE(n),u=KE(i.baseId,r),l=YE(i.baseId,r),c=r===i.value;return C.jsx($3,{asChild:!0,...s,focusable:!o,active:c,children:C.jsx(Nt.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":l,"data-state":c?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u,...a,ref:t,onMouseDown:Qe(e.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:Qe(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:Qe(e.onFocus,()=>{const d=i.activationMode!=="manual";!c&&!o&&d&&i.onValueChange(r)})})})});HE.displayName=VE;var GE="TabsContent",qE=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:o,children:a,...i}=e,s=kg(GE,n),u=KE(s.baseId,r),l=YE(s.baseId,r),c=r===s.value,d=R.useRef(c);return R.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),C.jsx(sf,{present:o||c,children:({present:f})=>C.jsx(Nt.div,{"data-state":c?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":u,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&a})})});qE.displayName=GE;function KE(e,t){return`${e}-trigger-${t}`}function YE(e,t){return`${e}-content-${t}`}var H3=zE,XE=UE,QE=HE,JE=qE;const G3=H3,ZE=R.forwardRef(({className:e,...t},n)=>C.jsx(XE,{ref:n,className:wt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));ZE.displayName=XE.displayName;const Ev=R.forwardRef(({className:e,...t},n)=>C.jsx(QE,{ref:n,className:wt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Ev.displayName=QE.displayName;const _v=R.forwardRef(({className:e,...t},n)=>C.jsx(JE,{ref:n,className:wt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));_v.displayName=JE.displayName;const q3=()=>{const e=vi(),{user:t,logout:n}=ug(),{todayAttendance:r,attendanceHistory:o,absences:a,fetchTodayAttendance:i,fetchAttendanceByDateRange:s}=gg(),[u,l]=R.useState(new Date),[c,d]=R.useState([]);R.useEffect(()=>{i()},[i]),R.useEffect(()=>{(async()=>{const v=Ve(Kn(u),"yyyy-MM-dd"),y=Ve(ts(u),"yyyy-MM-dd"),x=await s(v,y);d(x)})()},[u,s]);const f=()=>r?r.checkIn&&!r.checkOut?"Checked In":r.checkIn&&r.checkOut?"Checked Out":"Not Available":"Not Checked In",h=g=>{switch(g){case"Checked In":return"text-green-500";case"Checked Out":return"text-blue-500";default:return"text-orange-500"}},p=()=>{e("/attendance")},m=a.filter(g=>_h(g.startDate)>new Date);return C.jsxs("div",{className:"min-h-screen bg-gray-50",children:[C.jsx("header",{className:"bg-teal-600 text-white p-4",children:C.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[C.jsx("h1",{className:"text-xl font-bold",children:"AttendNow"}),C.jsxs("div",{className:"flex items-center space-x-2",children:[C.jsx("span",{children:t==null?void 0:t.name}),C.jsx(Tn,{variant:"outline",size:"sm",onClick:n,children:"Sign Out"})]})]})}),C.jsxs("main",{className:"container mx-auto p-4 space-y-6",children:[C.jsxs(ia,{className:"w-full",children:[C.jsx(gv,{className:"bg-gray-50 pb-2",children:C.jsx(yv,{className:"text-lg",children:"Today's Attendance"})}),C.jsx(hu,{className:"pt-6",children:C.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"text-xl font-semibold",children:Ve(new Date,"EEEE, MMMM d, yyyy")}),C.jsx("div",{className:"flex items-center mt-2",children:C.jsx("div",{className:`font-semibold ${h(f())}`,children:f()})}),C.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[(r==null?void 0:r.checkIn)&&C.jsxs("div",{className:"flex items-center",children:[C.jsx(q0,{className:"h-4 w-4 mr-1"}),"Check In: ",r.checkIn]}),(r==null?void 0:r.checkOut)&&C.jsxs("div",{className:"flex items-center mt-1",children:[C.jsx(q0,{className:"h-4 w-4 mr-1"}),"Check Out: ",r.checkOut]})]})]}),C.jsx(Tn,{className:"bg-teal-600 hover:bg-teal-700",onClick:p,children:r!=null&&r.checkIn?"Check Out":"Check In"})]})})]}),C.jsxs(G3,{defaultValue:"thisWeek",children:[C.jsxs(ZE,{className:"grid grid-cols-2",children:[C.jsx(Ev,{value:"thisWeek",children:"This Week"}),C.jsx(Ev,{value:"calendar",children:"Calendar"})]}),C.jsx(_v,{value:"thisWeek",children:C.jsx(ia,{children:C.jsx(hu,{className:"pt-6",children:C.jsxs("div",{className:"space-y-4",children:[C.jsxs("h3",{className:"font-medium",children:["Week of ",Ve(Kn(u),"MMM d")," - ",Ve(ts(u),"MMM d, yyyy")]}),C.jsx("div",{className:"space-y-2",children:TM({start:Kn(u),end:ts(u)}).map(g=>{const v=Ve(g,"yyyy-MM-dd"),y=c.find(w=>w.date===v),x=g.getDay()===0||g.getDay()===6;return C.jsxs("div",{className:`flex items-center justify-between p-3 rounded-md ${x?"bg-gray-100":"bg-white border border-gray-200"}`,children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-3 ${Ve(g,"yyyy-MM-dd")===Ve(new Date,"yyyy-MM-dd")?"bg-teal-600 text-white":"bg-gray-100 text-gray-700"}`,children:Ve(g,"d")}),C.jsxs("div",{children:[C.jsx("p",{className:"font-medium",children:Ve(g,"EEEE")}),C.jsx("p",{className:"text-xs text-gray-500",children:Ve(g,"MMM d, yyyy")})]})]}),x?C.jsx("span",{className:"text-sm text-gray-500",children:"Weekend"}):y?C.jsxs("div",{className:"text-right",children:[y.status==="present"&&C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"flex items-center text-sm text-green-600",children:[C.jsx(Ku,{className:"h-4 w-4 mr-1"}),C.jsx("span",{children:"Present"})]}),C.jsxs("div",{className:"text-xs text-gray-500",children:[y.checkIn&&`In: ${y.checkIn}`,y.checkOut&&` · Out: ${y.checkOut}`]})]}),y.status==="absent"&&C.jsx("span",{className:"text-sm text-red-600",children:"Absent"}),y.status==="half-day"&&C.jsx("span",{className:"text-sm text-orange-600",children:"Half Day"}),y.status==="leave"&&C.jsx("span",{className:"text-sm text-blue-600",children:"Leave"})]}):C.jsx("span",{className:"text-sm text-gray-500",children:"No Record"})]},v)})})]})})})}),C.jsx(_v,{value:"calendar",children:C.jsx(ia,{children:C.jsx(hu,{className:"pt-6",children:C.jsx("div",{className:"flex justify-center",children:C.jsx(PE,{mode:"single",selected:u,onSelect:g=>g&&l(g),className:"rounded-md border"})})})})})]}),m.length>0&&C.jsxs(ia,{children:[C.jsx(gv,{className:"bg-gray-50 pb-2",children:C.jsx(yv,{className:"text-lg",children:"Upcoming Absences"})}),C.jsx(hu,{className:"pt-4",children:C.jsx("div",{className:"space-y-3",children:m.map(g=>C.jsxs("div",{className:"flex items-center justify-between border-b pb-3",children:[C.jsxs("div",{children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx(UD,{className:"h-4 w-4 mr-2 text-teal-600"}),C.jsxs("span",{className:"font-medium",children:[Ve(_h(g.startDate),"MMM d"),g.startDate!==g.endDate&&` - ${Ve(_h(g.endDate),"MMM d")}`]})]}),C.jsx("p",{className:"text-sm text-gray-600 ml-6",children:g.reason})]}),C.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.status==="approved"?"bg-green-100 text-green-800":g.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})]},g.id))})})]})]})]})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Is;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(Is||(Is={}));class ns extends Error{constructor(t,n,r){super(t),this.message=t,this.code=n,this.data=r}}const K3=e=>{var t,n;return e!=null&&e.androidBridge?"android":!((n=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Y3=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},r=n.Plugins=n.Plugins||{},o=()=>t!==null?t.name:K3(e),a=()=>o()!=="web",i=d=>{const f=l.get(d);return!!(f!=null&&f.platforms.has(o())||s(d))},s=d=>{var f;return(f=n.PluginHeaders)===null||f===void 0?void 0:f.find(h=>h.name===d)},u=d=>e.console.error(d),l=new Map,c=(d,f={})=>{const h=l.get(d);if(h)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),h.proxy;const p=o(),m=s(d);let g;const v=async()=>(!g&&p in f?g=typeof f[p]=="function"?g=await f[p]():g=f[p]:t!==null&&!g&&"web"in f&&(g=typeof f.web=="function"?g=await f.web():g=f.web),g),y=(_,k)=>{var N,A;if(m){const T=m==null?void 0:m.methods.find(L=>k===L.name);if(T)return T.rtype==="promise"?L=>n.nativePromise(d,k.toString(),L):(L,M)=>n.nativeCallback(d,k.toString(),L,M);if(_)return(N=_[k])===null||N===void 0?void 0:N.bind(_)}else{if(_)return(A=_[k])===null||A===void 0?void 0:A.bind(_);throw new ns(`"${d}" plugin is not implemented on ${p}`,Is.Unimplemented)}},x=_=>{let k;const N=(...A)=>{const T=v().then(L=>{const M=y(L,_);if(M){const $=M(...A);return k=$==null?void 0:$.remove,$}else throw new ns(`"${d}.${_}()" is not implemented on ${p}`,Is.Unimplemented)});return _==="addListener"&&(T.remove=async()=>k()),T};return N.toString=()=>`${_.toString()}() { [capacitor code] }`,Object.defineProperty(N,"name",{value:_,writable:!1,configurable:!1}),N},w=x("addListener"),b=x("removeListener"),E=(_,k)=>{const N=w({eventName:_},k),A=async()=>{const L=await N;b({eventName:_,callbackId:L},k)},T=new Promise(L=>N.then(()=>L({remove:A})));return T.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await A()},T},S=new Proxy({},{get(_,k){switch(k){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return m?E:w;case"removeListener":return b;default:return x(k)}}});return r[d]=S,l.set(d,{name:d,proxy:S,platforms:new Set([...Object.keys(f),...m?[p]:[]])}),S};return n.convertFileSrc||(n.convertFileSrc=d=>d),n.getPlatform=o,n.handleError=u,n.isNativePlatform=a,n.isPluginAvailable=i,n.registerPlugin=c,n.Exception=ns,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},X3=e=>e.Capacitor=Y3(e),Sv=X3(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ef=Sv.registerPlugin;class Rg{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let r=!1;this.listeners[t]||(this.listeners[t]=[],r=!0),this.listeners[t].push(n);const a=this.windowListeners[t];a&&!a.registered&&this.addWindowListener(a),r&&this.sendRetainedArgumentsForEvent(t);const i=async()=>this.removeListener(t,n);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,r){const o=this.listeners[t];if(!o){if(r){let a=this.retainedEventArguments[t];a||(a=[]),a.push(n),this.retainedEventArguments[t]=a}return}o.forEach(a=>a(n))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(t="not implemented"){return new Sv.Exception(t,Is.Unimplemented)}unavailable(t="not available"){return new Sv.Exception(t,Is.Unavailable)}async removeListener(t,n){const r=this.listeners[t];if(!r)return;const o=r.indexOf(n);this.listeners[t].splice(o,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(r=>{this.notifyListeners(t,r)}))}}const Ux=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Vx=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Q3 extends Rg{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(r=>{if(r.length<=0)return;let[o,a]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=Vx(o).trim(),a=Vx(a).trim(),n[o]=a}),n}async setCookie(t){try{const n=Ux(t.key),r=Ux(t.value),o=`; expires=${(t.expires||"").replace("expires=","")}`,a=(t.path||"/").replace("path=",""),i=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${r||""}${o}; path=${a}; ${i};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Ef("CapacitorCookies",{web:()=>new Q3});const J3=async e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const o=r.result;t(o.indexOf(",")>=0?o.split(",")[1]:o)},r.onerror=o=>n(o),r.readAsDataURL(e)}),Z3=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(o=>o.toLocaleLowerCase()).reduce((o,a,i)=>(o[a]=e[t[i]],o),{})},eO=(e,t=!0)=>e?Object.entries(e).reduce((r,o)=>{const[a,i]=o;let s,u;return Array.isArray(i)?(u="",i.forEach(l=>{s=t?encodeURIComponent(l):l,u+=`${a}=${s}&`}),u.slice(0,-1)):(s=t?encodeURIComponent(i):i,u=`${a}=${s}`),`${r}&${u}`},"").substr(1):null,tO=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),o=Z3(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(o.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[i,s]of Object.entries(e.data||{}))a.set(i,s);n.body=a.toString()}else if(o.includes("multipart/form-data")||e.data instanceof FormData){const a=new FormData;if(e.data instanceof FormData)e.data.forEach((s,u)=>{a.append(u,s)});else for(const s of Object.keys(e.data))a.append(s,e.data[s]);n.body=a;const i=new Headers(n.headers);i.delete("content-type"),n.headers=i}else(o.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class nO extends Rg{async request(t){const n=tO(t,t.webFetchExtra),r=eO(t.params,t.shouldEncodeUrlParams),o=r?`${t.url}?${r}`:t.url,a=await fetch(o,n),i=a.headers.get("content-type")||"";let{responseType:s="text"}=a.ok?t:{};i.includes("application/json")&&(s="json");let u,l;switch(s){case"arraybuffer":case"blob":l=await a.blob(),u=await J3(l);break;case"json":u=await a.json();break;case"document":case"text":default:u=await a.text()}const c={};return a.headers.forEach((d,f)=>{c[f]=d}),{data:u,headers:c,status:a.status,url:a.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Ef("CapacitorHttp",{web:()=>new nO});var Gi;(function(e){e.Prompt="PROMPT",e.Camera="CAMERA",e.Photos="PHOTOS"})(Gi||(Gi={}));var ku;(function(e){e.Rear="REAR",e.Front="FRONT"})(ku||(ku={}));var Hx;(function(e){e.Uri="uri",e.Base64="base64",e.DataUrl="dataUrl"})(Hx||(Hx={}));class rO extends Rg{async getPhoto(t){return new Promise(async(n,r)=>{if(t.webUseInput||t.source===Gi.Photos)this.fileInputExperience(t,n,r);else if(t.source===Gi.Prompt){let o=document.querySelector("pwa-action-sheet");o||(o=document.createElement("pwa-action-sheet"),document.body.appendChild(o)),o.header=t.promptLabelHeader||"Photo",o.cancelable=!1,o.options=[{title:t.promptLabelPhoto||"From Photos"},{title:t.promptLabelPicture||"Take Picture"}],o.addEventListener("onSelection",async a=>{a.detail===0?this.fileInputExperience(t,n,r):this.cameraExperience(t,n,r)})}else this.cameraExperience(t,n,r)})}async pickImages(t){return new Promise(async(n,r)=>{this.multipleFileInputExperience(n,r)})}async cameraExperience(t,n,r){if(customElements.get("pwa-camera-modal")){const o=document.createElement("pwa-camera-modal");o.facingMode=t.direction===ku.Front?"user":"environment",document.body.appendChild(o);try{await o.componentOnReady(),o.addEventListener("onPhoto",async a=>{const i=a.detail;i===null?r(new ns("User cancelled photos app")):i instanceof Error?r(i):n(await this._getCameraPhoto(i,t)),o.dismiss(),document.body.removeChild(o)}),o.present()}catch{this.fileInputExperience(t,n,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(t,n,r)}fileInputExperience(t,n,r){let o=document.querySelector("#_capacitor-camera-input");const a=()=>{var i;(i=o.parentNode)===null||i===void 0||i.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input",o.type="file",o.hidden=!0,document.body.appendChild(o),o.addEventListener("change",i=>{const s=o.files[0];let u="jpeg";if(s.type==="image/png"?u="png":s.type==="image/gif"&&(u="gif"),t.resultType==="dataUrl"||t.resultType==="base64"){const l=new FileReader;l.addEventListener("load",()=>{if(t.resultType==="dataUrl")n({dataUrl:l.result,format:u});else if(t.resultType==="base64"){const c=l.result.split(",")[1];n({base64String:c,format:u})}a()}),l.readAsDataURL(s)}else n({webPath:URL.createObjectURL(s),format:u}),a()}),o.addEventListener("cancel",i=>{r(new ns("User cancelled photos app")),a()})),o.accept="image/*",o.capture=!0,t.source===Gi.Photos||t.source===Gi.Prompt?o.removeAttribute("capture"):t.direction===ku.Front?o.capture="user":t.direction===ku.Rear&&(o.capture="environment"),o.click()}multipleFileInputExperience(t,n){let r=document.querySelector("#_capacitor-camera-input-multiple");const o=()=>{var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const i=[];for(let s=0;s<r.files.length;s++){const u=r.files[s];let l="jpeg";u.type==="image/png"?l="png":u.type==="image/gif"&&(l="gif"),i.push({webPath:URL.createObjectURL(u),format:l})}t({photos:i}),o()}),r.addEventListener("cancel",a=>{n(new ns("User cancelled photos app")),o()})),r.accept="image/*",r.click()}_getCameraPhoto(t,n){return new Promise((r,o)=>{const a=new FileReader,i=t.type.split("/")[1];n.resultType==="uri"?r({webPath:URL.createObjectURL(t),format:i,saved:!1}):(a.readAsDataURL(t),a.onloadend=()=>{const s=a.result;n.resultType==="dataUrl"?r({dataUrl:s,format:i,saved:!1}):r({base64String:s.split(",")[1],format:i,saved:!1})},a.onerror=s=>{o(s)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const Gx=Ef("Camera",{web:()=>new rO}),oO="modulepreload",aO=function(e){return"/"+e},qx={},iO=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),s=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=aO(u),u in qx)return;qx[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":oO,l||(d.as="script"),d.crossOrigin="",d.href=u,s&&d.setAttribute("nonce",s),document.head.appendChild(d),l)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i}return o.then(i=>{for(const s of i||[])s.status==="rejected"&&a(s.reason);return t().catch(a)})};function sO(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,n){return new Proxy({},{get(r,o){return(a,i,s)=>{const u=e.Capacitor.Plugins[n];if(u===void 0){s(new Error(`Capacitor plugin ${n} not found`));return}if(typeof u[o]!="function"){s(new Error(`Method ${o} not found in Capacitor plugin ${n}`));return}(async()=>{try{const l=await u[o](a);i(l)}catch(l){s(l)}})()}}})}})}function uO(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,n){return e.cordova.plugins[n]}})}function lO(e=!1){window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!e?sO(window):window.cordova!==void 0&&uO(window)}const Ph=Ef("Geolocation",{web:()=>iO(()=>import("./web-DDHea3ce.js"),[]).then(e=>new e.GeolocationWeb)});lO();const e_=R.createContext(void 0),Si=typeof window<"u",cO=({children:e})=>{const[t,n]=R.useState(null),[r,o]=R.useState(null),[a,i]=R.useState(null),s=async()=>{try{if(!Si)return!1;const p=(await Ph.checkPermissions()).location==="granted";return n(p),p}catch(h){return console.error("Error checking location permission:",h),n(!1),!1}},u=async()=>{try{if(!Si)return!1;const p=(await Gx.checkPermissions()).camera==="granted";return o(p),p}catch(h){return console.error("Error checking camera permission:",h),o(!1),!1}},l=async()=>{try{if(!Si)return!1;const p=(await Ph.requestPermissions()).location==="granted";return n(p),p&&await d(),p}catch(h){return console.error("Error requesting location permission:",h),n(!1),!1}},c=async()=>{try{if(!Si)return!1;const p=(await Gx.requestPermissions()).camera==="granted";return o(p),p}catch(h){return console.error("Error requesting camera permission:",h),o(!1),!1}},d=async()=>{try{if(!Si)return null;const h=await Ph.getCurrentPosition(),p={latitude:h.coords.latitude,longitude:h.coords.longitude};return i(p),localStorage.setItem("locationData",JSON.stringify(p)),p}catch(h){return console.error("Error getting current location:",h),null}};R.useEffect(()=>{if(Si){const h=localStorage.getItem("locationData");h&&i(JSON.parse(h))}},[]);const f={locationPermission:t,cameraPermission:r,currentLocation:a,checkLocationPermission:s,checkCameraPermission:u,requestLocationPermission:l,requestCameraPermission:c,getCurrentLocation:d};return C.jsx(e_.Provider,{value:f,children:e})},t_=()=>{const e=R.useContext(e_);if(e===void 0)throw new Error("usePermissions must be used within a PermissionsProvider");return e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var n_=function(e,t){return(n_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function Pr(e,t){function n(){this.constructor=e}n_(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function de(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(i,s)}u((r=r.apply(e,[])).next())})}function fe(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){i=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(c[0]===6&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var dO=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return fO(r,i[0],i[1]),i.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(a){var i=a.split(":"),s=i[0],u=i[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function fO(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Y(){return r_}var r_=null,bd=new Map,kv=new Map;function o_(e,t){var n=i_(e,t);return bd.get(n)}function hO(e){return kv.get(e)}function Kx(e){for(var t=bd.entries(),n=[];;){var r=t.next(),o=r.done,a=r.value;if(o)break;var i=a[0],s=a[1];i.split("_")[0]===e&&n.push(s)}return n}function a_(e){var t=e.kernelName,n=e.backendName,r=i_(t,n);if(bd.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");bd.set(r,e)}function pO(e){var t=e.kernelName;kv.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),kv.set(t,e)}function i_(e,t){return t+"_"+e}function Rv(e,t,n){return Math.max(e,Math.min(t,n))}function s_(e){return e%2==0?e:e+1}function vO(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function P(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ke(e,t,n){n===void 0&&(n=""),P(zt(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function $s(e){P(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ts(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||eo(e)&&!n)for(var r=0;r<e.length;++r)Ts(e[r],t,n);else t.push(e);return t}function pe(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function zt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ct(e){return e%1==0}function mO(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Nv(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function rs(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Yx(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var a=0,i=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?o():setTimeout(i,s)}};i()})}function gO(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function Lt(e,t){var n=t.length;return P((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),P(e.every(function(r){return Ct(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function $a(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||o?null:Lt(t,e).sort(),i=0,s=0;s<e.length;++s){if(a!=null){if(a[i]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[i]==null||a[i]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[i]<=s&&i++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function nl(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Cd(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function yO(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function xO(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function wO(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function eo(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function u_(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function bO(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Ng(e){return typeof e=="string"||e instanceof String}function CO(e){return typeof e=="boolean"}function EO(e){return typeof e=="number"}function kl(e){return Array.isArray(e)?kl(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":EO(e)?"float32":Ng(e)?"string":CO(e)?"bool":"float32"}function Dv(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Iv(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function to(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function l_(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ts(e)),n&&yO(e,t),function(a,i){return a instanceof Float32Array&&i==="float32"||a instanceof Int32Array&&i==="int32"||a instanceof Uint8Array&&i==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function Xx(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,a,i){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=i[o+l];else{u=a[0];var c=a.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)s[l]=r(o+l*d,c,i)}return s}(0,e,t)}function c_(e,t){for(var n=Rl(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Rl(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Hr(){return Y().platform.now()}function d_(e){e.forEach(function(t){P(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function _O(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Y().platform.encode(e,t)}function Ed(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Y().platform.decode(e,t)}function Qx(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function SO(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var kO=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new RO)}return e.prototype.profileKernel=function(t,n,r){var o,a=this,i=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,t),i.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),RO=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,a,i){var s=typeof o=="number"?rs(o+"ms",9):o.error,u=rs(t,25),l=n.rank,c=n.size,d=rs(n.shape.toString(),14),f="";for(var h in a){var p=a[h].shape||n.shape,m=p.length;f+=h+": "+m+"D "+(m>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),Jx=20,au=3,Ah=7;function NO(e,t,n,r){var o=to(t),a=function(l,c,d,f){var h=pe(c),p=f[f.length-1],m=new Array(p).fill(0),g=c.length,v=d==="complex64"?su(l):l;if(g>1)for(var y=0;y<h/p;y++)for(var x=y*p,w=0;w<p;w++)m[w]=Math.max(m[w],iu(v[x+w],0,d).length);return m}(e,t,n,o),i=t.length,s=function l(c,d,f,h,p,m){m===void 0&&(m=!0);var g=f==="complex64"?2:1,v=d[0],y=d.length;if(y===0)return f==="complex64"?[iu(su(c)[0],0,f)]:f==="bool"?[f_(c[0])]:[c[0].toString()];if(y===1){if(v>Jx){var x=au*g,w=Array.from(c.slice(0,x)),b=Array.from(c.slice((v-au)*g,v*g));return f==="complex64"&&(w=su(w),b=su(b)),["["+w.map(function($,U){return iu($,p[U],f)}).join(", ")+", ..., "+b.map(function($,U){return iu($,p[v-au+U],f)}).join(", ")+"]"]}return["["+(f==="complex64"?su(c):Array.from(c)).map(function($,U){return iu($,p[U],f)}).join(", ")+"]"]}var E=d.slice(1),S=h.slice(1),_=h[0]*g,k=[];if(v>Jx){for(var N=0;N<au;N++){var A=(T=N*_)+_;k.push.apply(k,l(c.slice(T,A),E,f,S,p,!1))}for(k.push("..."),N=v-au;N<v;N++)A=(T=N*_)+_,k.push.apply(k,l(c.slice(T,A),E,f,S,p,N===v-1))}else for(N=0;N<v;N++){var T;A=(T=N*_)+_,k.push.apply(k,l(c.slice(T,A),E,f,S,p,N===v-1))}var L=y===2?",":"";for(k[0]="["+k[0]+L,N=1;N<k.length-1;N++)k[N]=" "+k[N]+L;var M=`,
`;for(N=2;N<y;N++)M+=`
`;return k[k.length-1]=" "+k[k.length-1]+"]"+(m?"":M),k}(e,t,n,o,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+i),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function iu(e,t,n){return rs(Array.isArray(e)?parseFloat(e[0].toFixed(Ah))+" + "+parseFloat(e[1].toFixed(Ah))+"j":Ng(e)?"'"+e+"'":n==="bool"?f_(e):parseFloat(e.toFixed(Ah)).toString(),t)}function f_(e){return e===0?"false":"true"}function su(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var rl=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=pe(t),r!=null){var a=r.length;P(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Cd(n,this.size),this.strides=to(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),P(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,a=t;o<a.length;o++){var i=a[o];if(i<0||i>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return qr().makeTensor(this.values,this.shape,this.dtype)},e}(),qr=null,q=null,h_=null,dt=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=pe(t),this.strides=to(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),P(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,a){return this.throwIfDisposed(),this.reshape([t,n,r,o,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),q.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return de(this,void 0,void 0,function(){var t;return fe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,q.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return q.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return de(this,void 0,void 0,function(){var t;return fe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Xx(this.shape,t)]}})})},e.prototype.arraySync=function(){return Xx(this.shape,this.dataSync())},e.prototype.data=function(){return de(this,void 0,void 0,function(){var t,n;return fe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=qr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return Ed(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=qr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Ed(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return de(this,void 0,void 0,function(){var t;return fe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,qr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(qr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),q.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),q.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),q.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),q.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),q.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),q.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),q.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),NO(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),q.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),q.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),q.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),q.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),q.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),q.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),q.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),q.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),q.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),q.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,a){return r===void 0&&(r=.001),h_("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,o,r)},e.prototype.batchNorm=function(t,n,r,o,a){return a===void 0&&(a=.001),this.throwIfDisposed(),q.batchNorm(this,t,n,r,o,a)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),q.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),q.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),q.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),q.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),q.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),q.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),q.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),q.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),q.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),q.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),q.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),q.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),q.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),q.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),q.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),q.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),q.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),q.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),q.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),q.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),q.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),q.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),q.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),q.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),q.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),q.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),q.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),q.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),q.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),q.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),q.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),q.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),q.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),q.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),q.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),q.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),q.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),q.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),q.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),q.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),q.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),q.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),q.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),q.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),q.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),q.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),q.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),q.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),q.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),q.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),q.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),q.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),q.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),q.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),q.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),q.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),q.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),q.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),q.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),q.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),q.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),q.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),q.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),q.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),q.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),q.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),q.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),q.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),q.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),q.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),q.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),q.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),q.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),q.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),q.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),q.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),q.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),q.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),q.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),q.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),q.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),q.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),q.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),q.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),q.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),q.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,a,i){return o===void 0&&(o="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),q.conv1d(this,t,n,r,o,a,i)},e.prototype.conv2d=function(t,n,r,o,a,i){return o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),q.conv2d(this,t,n,r,o,a,i)},e.prototype.conv2dTranspose=function(t,n,r,o,a){return this.throwIfDisposed(),q.conv2dTranspose(this,t,n,r,o,a)},e.prototype.depthwiseConv2D=function(t,n,r,o,a,i){return o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),q.depthwiseConv2d(this,t,n,r,o,a,i)},e.prototype.separableConv2d=function(t,n,r,o,a,i){return a===void 0&&(a=[1,1]),i===void 0&&(i="NHWC"),this.throwIfDisposed(),q.separableConv2d(this,t,n,r,o,a,i)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),q.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),q.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),q.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,a){return this.throwIfDisposed(),q.pool(this,t,n,r,o,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),qr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),q.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),q.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),q.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),q.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,a,i,s,u){return o===void 0&&(o=0),a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),q.stridedSlice(this,t,n,r,o,a,i,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),q.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),q.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),q.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),q.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),q.spectral.irfft(this)},e}();Object.defineProperty(dt,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var Zx,Tv,Pv,Av,Mv,Ps=function(e){function t(n,r,o,a){var i=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return i.trainable=r,i.name=o,i}return Pr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!zt(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");qr().disposeTensor(this),this.dataId=n.dataId,qr().incRef(this,null)},t.prototype.dispose=function(){qr().disposeVariable(this),this.isDisposedInternal=!0},t}(dt);Object.defineProperty(Ps,Symbol.hasInstance,{value:function(e){return e instanceof dt&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Zx||(Zx={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Tv||(Tv={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Pv||(Pv={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Av||(Av={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Mv||(Mv={}));var DO={float32:Av,int32:Tv,bool:Pv,complex64:Mv};function Gt(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return DO[e][t]}function Mh(e){return Gt(e,"int32")}function vt(e,t){if(e.dtype===t.dtype)return[e,t];var n=Gt(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function IO(e,t){P(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function p_(e){var t=[];return function n(r,o,a){if(r!=null){if(r instanceof dt)return void o.push(r);if(i=r,!(!Array.isArray(i)&&typeof i!="object")){var i,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,o,a))}}}}(e,t,new Set),t}var Fh,e1=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),TO=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new e1}return e.prototype.ready=function(){return de(this,void 0,void 0,function(){var t,n,r;return fe(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return de(this,void 0,void 0,function(){var n,r,o;return fe(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=a.sent(),[3,3];case 2:o=r,a.label=3;case 3:if(!o)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new kO(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;Kx(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;Kx(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var a=++this.pendingBackendInitId,i=o.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),a=o.success,i=o.asyncInit;if(i||a)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,a=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return o.startScope(a)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,a){return this.runKernelFunc(null,n,null,t,r,o,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-a-i;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,a,i,s){var u,l=this;i===void 0&&(i=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(c=y.map(function(x){return l.keep(l.clone(x))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=o_(o,this.backendName);return f=v!=null?function(){var y=l.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:a,backend:l.backend});var x=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x);var w=x.map(function(E){var S=E.dataId,_=E.shape,k=E.dtype;return l.makeTensorFromDataId(S,_,k)}),b=w.filter(function(E,S){return s[S]});return h((i||[]).slice().concat(b)),w}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,h)});var x=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var a=t;r==="string"&&Ng(t[0])&&(a=t.map(function(c){return _O(c)}));var i=o.write(a,n,r),s=new dt(n,r,i,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(i),l=bO(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var a=new dt(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,o),a},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var a=new Ps(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*u_(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ps||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return de(this,void 0,void 0,function(){var n,r;return fe(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,a){var i=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},u=hO(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,d){if(c==null){var f=r[d],h=Rl(f.size,f.dtype);return i.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],a)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=p_(t),o=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||o.has(i.id)||i.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var a=this;if(o===void 0&&(o=!1),P(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var i=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});P(i instanceof dt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(E=u[h]).inputs;for(var m in p){for(var g=p[m],v=!1,y=0;y<l.length;y++)if(d[g.id]){E.outputs.forEach(function(N){return d[N.id]=!0}),v=!0,f[E.id]=!0;break}if(v)break}}var x={};x[c.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(p=(E=u[h]).inputs,y=0;y<E.outputs.length;y++)if(x[E.outputs[y].id]){for(var m in p)x[p[m].id]=!0,w[E.id]=!0;break}var b=[];for(h=0;h<u.length;h++){var E;if(f[(E=u[h]).id]&&w[E.id]){var S={};for(var m in E.inputs){var _=E.inputs[m];d[_.id]&&(S[m]=_)}var k=Object.assign({},E);k.inputs=S,k.outputs=E.outputs,b.push(k)}}return b}(this.state.activeTape,n,i);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[i.id]=r??(u=i.shape,l=c_(pe(u),"float32"),W.makeTensor(l,u,"float32")),function(f,h,p){for(var m=function(v){var y=h[v],x=[];if(y.outputs.forEach(function(S){var _=f[S.id];_!=null?x.push(_):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(x),b=function(S){if(!(S in w))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(w)+".");var _=p(function(){return w[S]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+_.dtype+"'");var k=y.inputs[S];if(!zt(_.shape,k.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+S+"' has shape '"+_.shape+"', which does not match the shape of the input '"+k.shape+"'");if(f[k.id]==null)f[k.id]=_;else{var N=f[k.id];f[k.id]=N.add(_),N.dispose()}};for(var E in y.inputs)b(E)},g=h.length-1;g>=0;g--)m(g)}(c,s,function(f){return a.tidy(f)});var d=n.map(function(f){return c[f.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(f){for(var h=0,p=f.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:i,grads:d}})},e.prototype.customGrad=function(t){var n=this;return P(Dv(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];P(o.every(function(s){return s instanceof dt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var i={};return o.forEach(function(s,u){i[u]=s}),n.runKernelFunc(function(s,u){return P((r=t.apply(void 0,o.concat([u]))).value instanceof dt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),P(Dv(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},i,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];P(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),P(c.every(function(f){return f instanceof dt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return de(this,void 0,void 0,function(){var n,r;return fe(this,function(o){switch(o.label){case 0:return n=Hr(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=Hr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new e1,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),W=function(){var e=function(){if(Fh==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Fh=n}return Fh}();if(e._tfengine==null){var t=new dO(e);e._tfengine=new TO(t)}return function(n){r_=n}(e._tfengine.ENV),qr=function(){return e._tfengine},e._tfengine}();function v_(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var go=Y();go.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),go.registerFlag("IS_BROWSER",function(){return v_()}),go.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),go.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),go.registerFlag("PROD",function(){return!1}),go.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return go.getBool("DEBUG")}),go.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),go.registerFlag("IS_TEST",function(){return!1});var ol,Un,zn,Wa={},Oh={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function PO(e,t){Wa[e]=t}function so(e){e in Wa||(Wa[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Wa[n]},!1),n===1?r.getContext("webgl",Oh)||r.getContext("experimental-webgl",Oh):r.getContext("webgl2",Oh)}(e));var t=Wa[e];return t.isContextLost()?(delete Wa[e],so(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Wa[e])}function _f(e,t){return[t,e]}function Ru(e){var t=pe(e);return Nv(Math.ceil(t/4))}function Nl(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Dg(e,t){var n,r,o,a,i,s,u,l,c,d=e;return Y().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,a=d.RGBA32F,i=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,a=d.RGBA,i=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:i,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ve(e,t,n){var r=n();return t&&function(o){var a=o.getError();if(a!==o.NO_ERROR)throw new Error("WebGL Error: "+OO(o,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(ol||(ol={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Un||(Un={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(zn||(zn={}));var AO=596e-10,MO=65504;function FO(e){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||AO<Math.abs(e)&&Math.abs(e)<MO)}function OO(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function sc(e,t,n){return Ao(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function LO(e,t,n){var r=Ao(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ve(e,t,function(){return e.shaderSource(r,n)}),ve(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function BO(e,t,n){var r=Ao(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ve(e,t,function(){return e.shaderSource(r,n)}),ve(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,a){var i=jO.exec(a);if(i==null)return console.log("Couldn't parse line number in error: "+a),void console.log(o);for(var s=+i[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,v){return rs((v+1).toString(),l)+g}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),p=c.slice(s-1,s),m=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+rs(p[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Lh,Bh,jO=/ERROR: [0-9]+:([0-9]+):/g;function WO(e,t){return Ao(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function zO(e,t,n){if(ve(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function jh(e,t,n){if(ve(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function $O(e,t,n){var r=Ao(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ve(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function UO(e,t,n){var r=Ao(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ve(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ve(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function VO(e,t){return Ao(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function HO(e,t){var n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function GO(e,t){return Ao(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function t1(e,t,n,r,o,a,i,s){var u=e.getAttribLocation(n,r);return u!==-1&&(ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),ve(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,i,s)}),ve(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function qO(e,t,n,r){JO(e,r),ve(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function KO(e,t,n,r){return Ao(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function YO(e,t,n){return e.getUniformLocation(t,n)}function XO(e,t,n,r,o,a){ve(e,t,function(){return qO(e,t,r,a)}),ve(e,t,function(){return e.uniform1i(o,a)})}function Wh(e,t,n,r){ve(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ve(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function n1(e,t,n){ve(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ve(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function uc(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+QO(e,t))}function QO(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Ao(e,t,n,r){var o=ve(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function JO(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function _d(e,t){return t===void 0&&(t=2),pe(e.slice(0,e.length-t))}function Sd(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function zh(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[_d(e)].concat(Sd(e))),t}function ZO(e,t){var n;t===void 0&&(t=!1);var r=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?s_(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=$a(e);e=o.newShape}var a=pe(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var i=_d(e),s=2,u=2;return e.length&&(s=(n=Sd(e))[0],u=n[1]),Nv(a=i*(s/2)*(u/2)).map(function(l){return 2*l})}return Nv(a)}function lc(e){return e%2==0}function cc(e,t){if(zt(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||lc(n)&&lc(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&lc(e[0])&&lc(t[0])}function eL(e){if(Lh==null){var t=so(e);Lh=t.getParameter(t.MAX_TEXTURE_SIZE)}return Lh}function tL(e){if(Bh==null){var t=so(e);Bh=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Bh)}function nL(e){if(e===0)return 0;var t=so(e);return ir(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ir(t,"EXT_disjoint_timer_query")?1:0}function ir(e,t){return e.getExtension(t)!=null}function r1(e){try{if(so(e)!=null)return!0}catch{return!1}return!1}function rL(e){if(e===0)return!1;var t=so(e);if(e===1){if(!ir(t,"OES_texture_float"))return!1}else if(!ir(t,"EXT_color_buffer_float"))return!1;return Fv(t)}function oL(e){if(e===0)return!1;var t=so(e);if(e!==1){if(ir(t,"EXT_color_buffer_float"))return Fv(t);if(ir(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var a=Dg(r,o),i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(i),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!ir(t,"OES_texture_float")&&!!ir(t,"WEBGL_color_buffer_float")&&Fv(t)}function Fv(e){var t=Dg(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function aL(e){return e===2&&so(e).fenceSync!=null}var Ce=Y();function m_(e){Y().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ue(e,t){return W.tidy(e,t)}function An(e){p_(e).forEach(function(t){return t.dispose()})}function iL(e){return W.keep(e)}function kd(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Y().getBool("IS_TEST")||console.warn.apply(console,e)}function Aa(e,t){var n=e;if(eo(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||eo(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(a,i,s){if(s=s||[],!Array.isArray(a)&&!eo(a))return void P(i.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+i[0]+" elements"});P(i.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),P(a.length===i[0],function(){return"Element arr["+s.join("][")+"] should have "+i[0]+" elements, but has "+a.length+" elements"});for(var u=i.slice(1),l=0;l<a.length;++l)o(a[l],u,s.concat(l))}(e,r,[]),r}function o1(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function I(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof dt)return o1(r,e.dtype,t,n),e;var o=kl(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),o1(r,o,t,n),e==null||!eo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var i=Aa(e,o);eo(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?l_(e,o,Y().getBool("DEBUG")):Ts(e,[],!0);return W.makeTensor(s,i,o)}function Rd(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,a){return I(o,t+"["+a+"]",n)},r)}function g_(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function sL(e,t,n){for(var r=e.length+t.length,o=[],a=0,i=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[a++]):o.push(t[i++]);return o}function nn(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(a){return e[a]})]}function Mn(e,t){return sL(e,t.map(function(n){return 1}),t)}function jn(e,t,n){P(g_(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function uo(e,t){if(g_(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function Ig(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function lo(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function uL(e,t){var n=e[0].length;e.forEach(function(o,a){P(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),P(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,a){for(var i=0;i<n;i++)P(i===t||o[i]===r[i],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function As(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function B(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];W.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),W.endScope(s),s}catch(u){throw W.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Ce.registerFlag("HAS_WEBGL",function(){return Ce.getNumber("WEBGL_VERSION")>0}),Ce.registerFlag("WEBGL_VERSION",function(){return r1(2)?2:r1(1)?1:0}),Ce.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ce.get("WEBGL_VERSION")===2}),Ce.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ce.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ce.registerFlag("WEBGL_PACK",function(){return Ce.getBool("HAS_WEBGL")}),Ce.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_CLIP",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ce.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_REDUCE",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_CONV_IM2COL",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return eL(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return tL(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Ce.getNumber("WEBGL_VERSION");return e===0?0:nL(e)}),Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ce.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Ce.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return rL(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ce.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ce.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ce.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return oL(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return aL(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ce.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),h_=m_;var Ht=B({complex_:function(e,t){var n=I(e,"real","complex"),r=I(t,"imag","complex");return Ke(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),W.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),or=B({real_:function(e){var t=I(e,"input","real");return W.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Kr=B({imag_:function(e){var t=I(e,"input","imag");return W.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function qt(e,t,n){return Ma(e,t,Aa(e,n),n)}function Ma(e,t,n,r){if(r==null&&(r=kl(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!eo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){d_(t);var o=pe(t),a=pe(n);P(o===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+a});for(var i=0;i<n.length;++i){var s=n[i],u=i!==n.length-1||s!==pe(t.slice(i));P(n[i]===t[i]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return eo(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?l_(e,r,Y().getBool("DEBUG")):Ts(e,[],!0),W.makeTensor(e,t,r)}function ie(e,t){if((eo(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&eo(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ma(e,[],[],t)}function kt(e,t){$s(e);var n=Aa(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ma(e,null,n,t)}function ya(e,t,n){if($s(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Aa(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ma(e,t,r,n)}function Tg(e,t,n){if($s(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Aa(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ma(e,t,r,n)}function _n(e,t,n){if($s(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Aa(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ma(e,t,r,n)}function lL(e,t,n){if($s(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Aa(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ma(e,t,r,n)}function cL(e,t,n){if($s(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Aa(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ma(e,t=t||r,r,n)}function dL(e,t,n,r){return t===void 0&&(t=!0),W.makeVariable(e,t,n,r)}function Us(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Us(e,"float32"),r=st(e,"float32");return Ht(n,r)}var o=c_(pe(e),t);return W.makeTensor(o,e,t)}function st(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=st(e,"float32"),r=st(e,"float32");return Ht(n,r)}var o=Rl(pe(e),t);return W.makeTensor(o,e,t)}function no(e,t,n){return W.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function fL(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return W.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Nd(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return st([0],r);var o=Rl(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var a=1;a<o.length;a++)o[a]=o[a-1]+n;return kt(o,r)}var y_=B({onesLike_:function(e){var t=I(e,"x","onesLike");if(t.dtype==="complex64"){var n=y_(or(t)),r=je(Kr(t));return Ht(n,r)}return W.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,a){return{$x:function(){return je(o)}}})}}),je=B({zerosLike_:function(e){var t=I(e,"x","zerosLike");return W.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return je(n)}}})}}),At=B({concat_:function(e,t){t===void 0&&(t=0),P(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Rd(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Lt(t,n[0].shape)[0];var r=As(n.map(function(s){return s.shape}),t);if(pe(r)===0)return qt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});uL(o,t);var a=n,i={axis:t};return W.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=o.map(function(l){return l[t]});return Pg(s,u,t).map(function(l){return function(){return l}})},"Concat",i)}}),hL=B({concat1d_:function(e){return At(e,0)}}),pL=B({concat2d_:function(e,t){return At(e,t)}}),vL=B({concat3d_:function(e,t){return At(e,t)}}),mL=B({concat4d_:function(e,t){return At(e,t)}}),Pg=B({split_:function(e,t,n){n===void 0&&(n=0);var r,o=I(e,"x","split");return n=Lt(n,o.shape)[0],typeof t=="number"?(P(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(P(o.shape[n]===t.reduce(function(a,i){return a+i}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),W.runKernelFunc(function(a){return a.split(o,r,n)},{$x:o},function(a){return{$x:function(){return At(a,n)}}})}});function mi(e,t){return e(t={exports:{}},t.exports),t.exports}var gL=mi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function i(s,u){var l=new o(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.alea=i})(0,e)}),yL=mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function i(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(0,e)}),xL=mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(0,e)}),wL=mi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(0,e)}),bL=mi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[h]=c^l,u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,p,m,g=[],v=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(f^=c.charCodeAt((p+32)%c.length)),p===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,p>=0&&(m=m+1640531527|0,h=(d=g[127&p]^=f+m)==0?h+1:0);for(h>=128&&(g[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;l.w=m,l.X=g,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function i(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(0,e)}),CL=mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function i(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&a(c,l),d.state=function(){return a(l,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(0,e)}),za=mi(function(e){(function(t,n){var r,o=this,a=256,i=6,s="random",u=n.pow(a,i),l=n.pow(2,52),c=2*l,d=a-1;function f(v,y,x){var w=[],b=m(function _(k,N){var A,T=[],L=typeof k;if(N&&L=="object")for(A in k)try{T.push(_(k[A],N-1))}catch{}return T.length?T:L=="string"?k:k+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(_)),g(_)}catch{var k=o.navigator,N=k&&k.plugins;return[+new Date,o,N,o.screen,g(t)]}}(),3),w),E=new h(w),S=function(){for(var _=E.g(i),k=u,N=0;_<l;)_=(_+N)*a,k*=a,N=E.g(1);for(;_>=c;)_/=2,k/=2,N>>>=1;return(_+N)/k};return S.int32=function(){return 0|E.g(4)},S.quick=function(){return E.g(4)/4294967296},S.double=S,m(g(E.S),t),(y.pass||x||function(_,k,N,A){return A&&(A.S&&p(A,E),_.state=function(){return p(E,{})}),N?(n[s]=_,k):_})(S,b,"global"in y?y.global:this==n,y.state)}function h(v){var y,x=v.length,w=this,b=0,E=w.i=w.j=0,S=w.S=[];for(x||(v=[x++]);b<a;)S[b]=b++;for(b=0;b<a;b++)S[b]=S[E=d&E+v[b%x]+(y=S[b])],S[E]=y;(w.g=function(_){for(var k,N=0,A=w.i,T=w.j,L=w.S;_--;)k=L[A=d&A+1],N=N*a+L[d&(L[A]=L[T=d&T+k])+(L[T]=k)];return w.i=A,w.j=T,N})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function m(v,y){for(var x,w=v+"",b=0;b<w.length;)y[d&b]=d&(x^=19*y[d&b])+w.charCodeAt(b++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,m(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});za.alea=gL,za.xor128=yL,za.xorwow=xL,za.xorshift7=wL,za.xor4096=bL,za.tychei=CL;var Sf=za.alea,Ag=function(){function e(t,n,r,o,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=Sf(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var a=void 0,i=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*i*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),EL=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var a=o||Math.random();this.randu=Sf(a.toString()),this.randn=new Ag(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,a,i;;){do o=this.randn.nextValue(),i=1+this.c*o;while(i<=0);if(i*=i*i,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-i+Math.log(i)),(a=this.randu())<n||Math.log(a)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),_L=function(){function e(t,n,r,o){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Sf(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Re(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",d_(e),new rl(e,t,n)}function SL(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var x_=B({batchToSpaceND_:function(e,t,n){var r=I(e,"x","batchToSpaceND"),o=t.reduce(function(a,i){return a*i});return P(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),P(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),P(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),W.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),kL=B({broadcastTo_:function(e,t){var n=I(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var a=Array.from(t),i=t.length-1;i>=0;i--)if(n.shape[i]===t[i])a[i]=1;else if(n.shape[i]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=a.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():W.runKernelFunc(function(u){return u.tile(n,a)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),RL=B({cast_:function(e,t){var n=I(e,"x","cast");if(!xO(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return W.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),NL=B({clone_:function(e){var t=I(e,"x","clone",null);return W.runKernelFunc(function(){return W.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),DL=B({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=I(e,"x","cumsum"),a=uo([t|=0],o.rank),i=o;a!=null&&(i=o.transpose(a));var s=lo(1,o.rank)[0],u=W.runKernelFunc(function(l){return l.cumsum(i,s,n,r)},{permutedX:i},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),IL=B({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=I(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];return P(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),P(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),P(i%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+i+" for depthToSpace with input shape "+r.shape}),W.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),rr=B({expandDims_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","expandDims",null);P(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(P(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Cr(n,r)}}),w_=B({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=Re([e,t],r),a=e<=t?e:t,i=0;i<a;++i)o.set(1,i,i);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return os(rr(s,0),[n[0],1,1]);if(n.length===2)return os(rr(rr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return os(rr(rr(rr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),TL=B({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=I(e,"logits","multinomial"),a=o.size,i=o.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+i);n=n||Math.random();var s=i===1?o.as2D(1,-1):o,u=W.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return i===1?u.as1D():u}}),Ov=B({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=I(e,"indices","oneHot","int32"),a=o.shape.concat([t]);return o=o.flatten(),W.runKernelFunc(function(i){return i.oneHot(o,t,n,r)},{$indices:o},function(i){return{$indices:function(){return st(o.shape,"float32")}}}).reshape(a)}}),gi=B({pad_:function(e,t,n){n===void 0&&(n=0);var r=I(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return W.runKernelFunc(function(a){return a.pad(r,t,n)},{x:r},function(a){var i=t.map(function(s){return s[0]});return{x:function(){return a.slice(i,r.shape)}}},"PadV2",o)}}),PL=B({pad1d_:function(e,t,n){return n===void 0&&(n=0),P(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),gi(e,[t],n)}}),AL=B({pad2d_:function(e,t,n){return n===void 0&&(n=0),P(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),gi(e,t,n)}}),ML=B({pad3d_:function(e,t,n){return n===void 0&&(n=0),P(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),gi(e,t,n)}}),FL=B({pad4d_:function(e,t,n){return n===void 0&&(n=0),P(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),gi(e,t,n)}}),OL=B({rand_:function(e,t,n){var r=pe(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var a=0;a<r;a++)o[a]=t();return W.makeTensor(o,e,n)}}),LL=B({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new Ag(t,n,r,!1,o),i=Re(e,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),BL=B({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new EL(t,n,r,o),i=Re(e,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),b_=B({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Re(e,r),i=new _L(t,n,null,o),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Cr=B({reshape_:function(e,t){var n=I(e,"x","reshape",null);t=gO(t,n.size),P(n.size===pe(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return W.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),C_=B({spaceToBatchND_:function(e,t,n){var r=I(e,"x","spaceToBatchND");return P(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),P(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),P(r.shape.reduce(function(o,a,i){return i>0&&i<=t.length?o&&(a+n[i-1][0]+n[i-1][1])%t[i-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),W.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),E_=B({squeeze_:function(e,t){var n=I(e,"x","squeeze");return Cr(n,$a(n.shape,t).newShape)}}),Yn=B({stack_:function(e,t){t===void 0&&(t=0);var n=Rd(e,"tensors","stack");if(P(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,a=n[0].dtype;P(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Ke(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){P(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var i=n.map(function(s){return s.expandDims(t)});return At(i,t)}}),os=B({tile_:function(e,t){var n=I(e,"x","tile",null);P(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return W.runKernelFunc(function(a,i){var s=a.tile(n,t);return i([n]),s},{x:n},function(a,i){var s=i[0];return{x:function(){var u=je(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(a.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(a.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)u=u.add(a.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(a.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),jL=B({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new Ag(t,n,r,!0,o),i=Re(e,r),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Mt=B({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=I(e,"x","unstack");P(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return W.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return Yn(o,t)}}},"Unpack",r)}}),WL=function(e,t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s,u,l,c,d;return fe(this,function(f){switch(f.label){case 0:return n=I(e,"x","setdiff1d"),r=I(t,"y","setdiff1d"),P(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),P(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),P(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(a=f.sent(),i=new Set(a),s=0,c=0;c<o.length;c++)i.has(o[c])||s++;for(u=new rl([s],n.dtype),l=new rl([s],"int32"),c=0,d=0;c<o.length;c++)i.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function Dd(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var a=t.length,i=0;i<a;++i)o=o.concat([e[i+1]/t[i],t[i]]);o=o.concat(e.slice(a+1))}return o}function Id(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var a=[],i=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?i.push(o):a.push(o);r.push.apply(r,a),r.push(0),r.push.apply(r,i)}return r}function Td(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?o.push(t[a-1]*e[a]):o.push(e[a]/t[a-1]):o.push(e[a]);return o}function __(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function S_(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function k_(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,a=0;a<n.length-1;++a)o*=n[a];var i=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=i[a],s.push(i[a]);var l=to(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var R_=30;function $h(e){return e<=R_?e:Iv(e,Math.floor(Math.sqrt(e)))}function zL(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(a+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(a+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(a+" update.rank != "+(o+e.length-r));for(var i=0;i<o;++i)if(n.shape[i]!==t.shape[i])throw new Error(a+" updates.shape["+i+"] ("+n.shape[i]+") != indices.shape["+i+"] ("+t.shape[i]+").");for(i=0;i<n.rank-o;++i)if(n.shape[i+o]!==e[i+r])throw new Error(a+" updates.shape["+(i+o)+"] ("+n.shape[i+o]+") != shape["+(i+o)+"] ("+e[i+o]+")")}function $L(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}zL(n,t,e)}function Pd(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,a=n.length,i=1,s=o;s<a;++s)i*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:pe(t.shape)/u,sliceSize:i,strides:to(n.slice(0,o)).concat([1]),outputSize:pe(n)}}function UL(e,t,n){P(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),P(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){P(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},o=0;o<e.rank;++o)r(o)}function a1(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Mg(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function VL(e,t,n,r,o){var a=t[o],i=n[o]||1;(e&1<<o||a==null)&&(a=i>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return a<0&&(a+=s),a=Rv(0,a,s-1)}function HL(e,t,n,r,o){var a=t[o],i=n[o]||1;(e&1<<o||a==null)&&(a=i>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return a<0&&(a+=s),a=i>0?Rv(0,a,s):Rv(-1,a,s-1)}function N_(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function D_(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function GL(e,t){P(Dv(e),function(){return"The f passed in variableGrads(f) must be a function"}),P(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Ps}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],W.registeredVariables)t.push(W.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,a=t.length;P((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var i=W.gradients(e,t,null,!0),s=i.value,u=i.grads;P(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),P(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function kf(e){return W.customGrad(e)}var Mo=B({softmax_:function(e,t){t===void 0&&(t=-1);var n=I(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return W.runKernelFunc(function(r,o){var a=r.softmax(n,t);return o([a]),a},{logits:n},function(r,o){var a=o[0],i=r.mul(a);return{logits:function(){return i.sub(i.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),qL=B({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=I(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return kf(function(r,o){var a=r.max(t,!0),i=r.sub(a),s=i.toFloat().sub(i.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),I_=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),T_=function(){function e(){}return e.prototype.time=function(t){return G("time")},e.prototype.read=function(t){return G("read")},e.prototype.readSync=function(t){return G("readSync")},e.prototype.numDataIds=function(){return G("numDataIds")},e.prototype.disposeData=function(t){return G("disposeData")},e.prototype.write=function(t,n,r){return G("write")},e.prototype.move=function(t,n,r,o){return G("move")},e.prototype.memory=function(){return G("memory")},e.prototype.floatPrecision=function(){return G("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return G("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,G("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return G("slice")},e.prototype.stridedSlice=function(t,n,r,o){return G("stridedSlice")},e.prototype.unstack=function(t,n){return G("unstack")},e.prototype.reverse=function(t,n){return G("reverse")},e.prototype.concat=function(t,n){return G("concat")},e.prototype.neg=function(t){return G("neg")},e.prototype.add=function(t,n){return G("add")},e.prototype.addN=function(t){return G("addN")},e.prototype.subtract=function(t,n){return G("subtract")},e.prototype.multiply=function(t,n){return G("multiply")},e.prototype.realDivide=function(t,n){return G("realDivide")},e.prototype.floorDiv=function(t,n){return G("floorDiv")},e.prototype.sum=function(t,n){return G("sum")},e.prototype.prod=function(t,n){return G("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return G("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return G("argMin")},e.prototype.argMax=function(t,n){return G("argMax")},e.prototype.equal=function(t,n){return G("equal")},e.prototype.notEqual=function(t,n){return G("notEqual")},e.prototype.less=function(t,n){return G("less")},e.prototype.lessEqual=function(t,n){return G("lessEqual")},e.prototype.greater=function(t,n){return G("greater")},e.prototype.greaterEqual=function(t,n){return G("greaterEqual")},e.prototype.logicalNot=function(t){return G("logicalNot")},e.prototype.logicalAnd=function(t,n){return G("logicalAnd")},e.prototype.logicalOr=function(t,n){return G("logicalOr")},e.prototype.where=function(t){return G("where")},e.prototype.select=function(t,n,r){return G("select")},e.prototype.topk=function(t,n,r){return G("topk")},e.prototype.min=function(t,n){return G("min")},e.prototype.minimum=function(t,n){return G("minimum")},e.prototype.mod=function(t,n){return G("mod")},e.prototype.max=function(t,n){return G("max")},e.prototype.maximum=function(t,n){return G("maximum")},e.prototype.all=function(t,n){return G("all")},e.prototype.any=function(t,n){return G("any")},e.prototype.squaredDifference=function(t,n){return G("squaredDifference")},e.prototype.ceil=function(t){return G("ceil")},e.prototype.floor=function(t){return G("floor")},e.prototype.round=function(t){return G("round")},e.prototype.sign=function(t){return G("sign")},e.prototype.isNaN=function(t){return G("isNaN")},e.prototype.isInf=function(t){return G("isInf")},e.prototype.isFinite=function(t){return G("isFinite")},e.prototype.pow=function(t,n){return G("pow")},e.prototype.exp=function(t){return G("exp")},e.prototype.expm1=function(t){return G("expm1")},e.prototype.softmax=function(t,n){return G("softmax")},e.prototype.log=function(t){return G("log")},e.prototype.log1p=function(t){return G("log1p")},e.prototype.sqrt=function(t){return G("sqrt")},e.prototype.rsqrt=function(t){return G("rsqrt")},e.prototype.square=function(t){return G("square")},e.prototype.reciprocal=function(t){return G("reciprocal")},e.prototype.relu=function(t){return G("relu")},e.prototype.relu6=function(t){return G("relu6")},e.prototype.prelu=function(t,n){return G("prelu")},e.prototype.elu=function(t){return G("elu")},e.prototype.eluDer=function(t,n){return G("eluDer")},e.prototype.selu=function(t){return G("selu")},e.prototype.int=function(t){return G("int")},e.prototype.clip=function(t,n,r){return G("clip")},e.prototype.abs=function(t){return G("abs")},e.prototype.complexAbs=function(t){return G("complexAbs")},e.prototype.sigmoid=function(t){return G("sigmoid")},e.prototype.softplus=function(t){return G("softplus")},e.prototype.sin=function(t){return G("sin")},e.prototype.cos=function(t){return G("cos")},e.prototype.tan=function(t){return G("tan")},e.prototype.asin=function(t){return G("asin")},e.prototype.acos=function(t){return G("acos")},e.prototype.atan=function(t){return G("atan")},e.prototype.atan2=function(t,n){return G("atan2")},e.prototype.sinh=function(t){return G("sinh")},e.prototype.cosh=function(t){return G("cosh")},e.prototype.tanh=function(t){return G("tanh")},e.prototype.asinh=function(t){return G("asinh")},e.prototype.acosh=function(t){return G("acosh")},e.prototype.atanh=function(t){return G("atanh")},e.prototype.erf=function(t){return G("erf")},e.prototype.step=function(t,n){return G("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,G("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return G("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return G("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return G("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,G("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return G("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return G("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return G("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return G("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return G("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return G("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return G("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return G("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return G("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return G("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return G("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return G("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return G("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return G("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return G("reshape")},e.prototype.cast=function(t,n){return G("cast")},e.prototype.tile=function(t,n){return G("tile")},e.prototype.pad=function(t,n,r){return G("pad")},e.prototype.transpose=function(t,n){return G("transpose")},e.prototype.gather=function(t,n,r){return G("gather")},e.prototype.gatherND=function(t,n){return G("gatherND")},e.prototype.scatterND=function(t,n,r){return G("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return G("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return G("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return G("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return G("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return G("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return G("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,a,i){return G("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,a){return G("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,a,i,s){return G("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return G("multinomial")},e.prototype.oneHot=function(t,n,r,o){return G("oneHot")},e.prototype.cumsum=function(t,n,r,o){return G("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,a){return G("nonMaxSuppression")},e.prototype.fft=function(t){return G("fft")},e.prototype.ifft=function(t){return G("ifft")},e.prototype.complex=function(t,n){return G("complex")},e.prototype.real=function(t){return G("real")},e.prototype.imag=function(t){return G("imag")},e.prototype.cropAndResize=function(t,n,r,o,a,i){return G("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return G("depthToSpace")},e.prototype.split=function(t,n,r){return G("split")},e.prototype.sparseToDense=function(t,n,r,o){return G("sparseToDense")},e.prototype.diag=function(t){return G("diag")},e.prototype.fill=function(t,n,r){return G("fill")},e.prototype.onesLike=function(t){return G("onesLike")},e.prototype.zerosLike=function(t){return G("zerosLike")},e.prototype.linspace=function(t,n,r){return G("linspace")},e.prototype.dispose=function(){return G("dispose")},e}();function G(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ua(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var a=n-1-o,i=e[a]||1;(t[t.length-1-o]||1)>1&&i===1&&r.unshift(a)}return r}function Ft(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],a=t.length-r-1,i=t[a];(o==null||o===1&&i>1)&&n.unshift(a)}return n}function Fe(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var a=e[e.length-o-1];a==null&&(a=1);var i=t[t.length-o-1];if(i==null&&(i=1),a===1)n.unshift(i);else if(i===1)n.unshift(a);else{if(a!==i)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}function al(e,t,n,r,o,a,i){i===void 0&&(i="channelsLast");var s,u=Fd(t),l=u[0],c=u[1];if(i==="channelsLast")s=[l,c,e[3],e[3]];else{if(i!=="channelsFirst")throw new Error("Unknown dataFormat "+i);s=[l,c,e[1],e[1]]}return yi(e,s,n,r,o,a,!1,i)}function Ad(e,t,n,r,o,a,i){i===void 0&&(i="NDHWC");var s,u,l=Lv(t),c=l[0],d=l[1],f=l[2];if(i==="NDHWC")u="channelsLast",s=[c,d,f,e[4],e[4]];else{if(i!=="NCDHW")throw new Error("Unknown dataFormat "+i);u="channelsFirst",s=[c,d,f,e[1],e[1]]}return Md(e,s,n,r,o,!1,u,a)}function yi(e,t,n,r,o,a,i,s){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],f=e[1],c=e[2],d=e[3]}var h,p=t[0],m=t[1],g=t[3],v=Fd(n),y=v[0],x=v[1],w=Fd(r),b=w[0],E=w[1],S=as(p,b),_=as(m,E),k=function(M,$,U,j,D,F,z,H){var X,ee,le;if(typeof M=="number"){X={top:M,bottom:M,left:M,right:M,type:M===0?"VALID":"NUMBER"};var ye=function(Se,Ae,De,Ue,Ge){Ue==null&&(Ue=P_(Se,Ae,De));var Be=Se[0],Ut=Se[1],Xt=Nu((Be-Ae+2*Ue)/De+1,Ge);P(Ct(Xt),function(){return"The output # of rows ("+Xt+") must be an integer. Change the stride and/or zero pad parameters"});var ze=Nu((Ut-Ae+2*Ue)/De+1,Ge);return P(Ct(ze),function(){return"The output # of columns ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}),[Xt,ze]}([$,U],F,j,M,H);ee=ye[0],le=ye[1]}else if(M==="same"){ee=Math.ceil($/j),le=Math.ceil(U/D);var se=Math.max(0,(ee-1)*j+F-$),xe=Math.max(0,(le-1)*D+z-U),Ee=Math.floor(se/2),be=se-Ee,We=Math.floor(xe/2);X={top:Ee,bottom:be,left:We,right:xe-We,type:"SAME"}}else{if(M!=="valid")throw Error("Unknown padding parameter: "+M);X={top:0,bottom:0,left:0,right:0,type:"VALID"},ee=Math.ceil(($-F+1)/j),le=Math.ceil((U-z+1)/D)}return{padInfo:X,outHeight:ee,outWidth:le}}(o,c,d,y,x,S,_,a),N=k.padInfo,A=k.outHeight,T=k.outWidth,L=i?g*f:g;return s==="channelsFirst"?h=[l,L,A,T]:s==="channelsLast"&&(h=[l,A,T,L]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:A,outWidth:T,outChannels:L,padInfo:N,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:_,dilationHeight:b,dilationWidth:E,inShape:e,outShape:h,filterShape:t}}function Md(e,t,n,r,o,a,i,s){a===void 0&&(a=!1),i===void 0&&(i="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if(i==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3],h=e[4];else{if(i!=="channelsFirst")throw new Error("Unknown dataFormat "+i);l=e[0],h=e[1],c=e[2],d=e[3],f=e[4]}var p,m=t[0],g=t[1],v=t[2],y=t[4],x=Lv(n),w=x[0],b=x[1],E=x[2],S=Lv(r),_=S[0],k=S[1],N=S[2],A=as(m,_),T=as(g,k),L=as(v,N),M=function(z,H,X,ee,le,ye,se,xe,Ee,be,We){var Se,Ae,De,Ue;if(typeof z=="number"){Se={top:z,bottom:z,left:z,right:z,front:z,back:z,type:z===0?"VALID":"NUMBER"};var Ge=function(K,oe,re,Z,ae,Ne){ae==null&&(ae=P_(K,oe,Z));var nt=K[0],Et=K[1],bi=K[2],Mr=Nu((nt-oe+2*ae)/Z+1,Ne);P(Ct(Mr),function(){return"The output # of depths ("+Mr+") must be an integer. Change the stride and/or zero pad parameters"});var fo=Nu((Et-oe+2*ae)/Z+1,Ne);P(Ct(fo),function(){return"The output # of rows ("+fo+") must be an integer. Change the stride and/or zero pad parameters"});var ho=Nu((bi-oe+2*ae)/Z+1,Ne);return P(Ct(ho),function(){return"The output # of columns ("+ho+") must be an integer. Change the stride and/or zero pad parameters"}),[Mr,fo,ho,re]}([H,X,ee,1],xe,1,le,z,We);Ae=Ge[0],De=Ge[1],Ue=Ge[2]}else if(z==="same"){Ae=Math.ceil(H/le),De=Math.ceil(X/ye),Ue=Math.ceil(ee/se);var Be=(Ae-1)*le+xe-H,Ut=(De-1)*ye+Ee-X,Xt=(Ue-1)*se+be-ee,ze=Math.floor(Be/2),bn=Be-ze,Cn=Math.floor(Ut/2),O=Ut-Cn,V=Math.floor(Xt/2);Se={top:Cn,bottom:O,left:V,right:Xt-V,front:ze,back:bn,type:"SAME"}}else{if(z!=="valid")throw Error("Unknown padding parameter: "+z);Se={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ae=Math.ceil((H-xe+1)/le),De=Math.ceil((X-Ee+1)/ye),Ue=Math.ceil((ee-be+1)/se)}return{padInfo:Se,outDepth:Ae,outHeight:De,outWidth:Ue}}(o,c,d,f,w,b,E,A,T,L,s),$=M.padInfo,U=M.outDepth,j=M.outHeight,D=M.outWidth,F=a?y*h:y;return i==="channelsFirst"?p=[l,F,U,j,D]:i==="channelsLast"&&(p=[l,U,j,D,F]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:U,outHeight:j,outWidth:D,outChannels:F,padInfo:$,strideDepth:w,strideHeight:b,strideWidth:E,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:A,effectiveFilterHeight:T,effectiveFilterWidth:L,dilationDepth:_,dilationHeight:k,dilationWidth:N,inShape:e,outShape:p,filterShape:t}}function P_(e,t,n,r){r===void 0&&(r=1);var o=as(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function Fd(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Lv(e){return typeof e=="number"?[e,e,e]:e}function as(e,t){return t<=1?e:e+(e-1)*(t-1)}function Nu(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Ms(e){var t=Fd(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function Fn(e,t){return Ms(e)||Ms(t)}function Fg(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function A_(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=st(e.shape),o=e.toFloat(),a=n.complex(o,r);return r.dispose(),o.dispose(),a}if(!wO(e.dtype,t))return W.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var i=n.real(e);return a=i.cast(t),i.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=ie(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Bv(e,t){return W.makeTensorFromDataId(e.dataId,t,e.dtype)}function M_(e,t,n){var r=(t-e)/(n-1),o=Rl(n,"float32");o[0]=e;for(var a=1;a<o.length;a++)o[a]=o[a-1]+r;return kt(o,"float32")}function jv(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function i1(e,t){return{real:e[2*t],imag:e[2*t+1]}}function KL(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function YL(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function XL(e,t,n){var r=function(a,i,s){return function(u,l,c){for(var d=0,f=u.length,h=0,p=!1;d<f;){var m=c(l,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,p=!m)}return p?d:-d-1}(a,i,s||QL)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function QL(e,t){return e>t?1:e<t?-1:0}function Og(e,t,n,r,o){return F_(e,t,n,r,o,0).selectedIndices}function Lg(e,t,n,r,o,a){var i=F_(e,t,n,r,o,a);return i.numValidOutputs.dispose(),{selectedIndices:i.selectedIndices,selectedScores:i.selectedScores}}function F_(e,t,n,r,o,a,i,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,b){return{score:w,boxIndex:b,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(s1),l=a>0?-.5/a:0,c=[],d=[];c.length<n&&u.length>0;){var f=u.pop(),h=f.score,p=f.boxIndex,m=f.suppressBeginIndex;if(h<o)break;for(var g=!1,v=c.length-1;v>=m;--v){var y=JL(e,p,c[v]);if(y>=r){g=!0;break}if(f.score=f.score*ZL(r,l,y),f.score<=o)break}f.suppressBeginIndex=c.length,g||(f.score===h?(c.push(p),d.push(f.score)):f.score>o&&XL(u,f,s1))}var x=c.length;return s&&(c.fill(0,x),d.fill(0,x)),{selectedIndices:kt(c,"int32"),selectedScores:kt(d,"float32"),numValidOutputs:ie(x,"int32")}}function JL(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-a)*(u-i),p=(d-l)*(f-c);if(h<=0||p<=0)return 0;var m=Math.max(a,l),g=Math.max(i,c),v=Math.min(s,d),y=Math.min(u,f),x=Math.max(v-m,0)*Math.max(y-g,0);return x/(h+p-x)}function ZL(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function s1(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function O_(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(a){o[n]=a;var i=e.slice(r,o);return r[n]+=a,i})}function L_(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Re(n,e.dtype);for(r=0;r<o.values.length;++r){for(var a=o.indexToLoc(r),i=new Array(e.rank),s=0;s<i.length;s++)i[s]=a[s]%e.shape[s];var u=e.locToIndex(i);o.values[r]=e.values[u]}return o.toTensor()}function B_(e,t,n,r,o){for(var a=t[t.length-1],i=[e.length/a,a],s=i[0],u=i[1],l=nl(n,s*r),c=nl("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),p=[],m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort(function(w,b){return b.value-w.value});var g=d*r,v=l.subarray(g,g+r),y=c.subarray(g,g+r);for(m=0;m<r;m++)v[m]=p[m].value,y[m]=p[m].index}var x=t.slice();return x[x.length-1]=r,[qt(l,x,n),qt(c,x,"int32")]}function Bg(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Re(e,"int32"),a=Re([n.length,e.length],"int32");for(r=0;r<n.length;r++){var i=o.indexToLoc(n[r]),s=r*e.length;a.values.set(i,s)}return a.toTensor()}var eB=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,a){return"T"+a});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},tB=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,a){return"T"+a});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},nB=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,a=e.inSize,i=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function j_(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function Sn(e,t){return t===1?[e]:j_(e,t)}function an(){var e,t,n,r,o,a,i,s,u,l;return Y().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",a="outputColor",i="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",a="gl_FragColor",i="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:a,defineOutput:i,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function qa(e,t,n){n===void 0&&(n="index");var r=to(t);return r.map(function(o,a){return"int "+e[a]+" = "+n+" / "+o+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+o:"index -= "+e[a]+" * "+o)+";"}).join("")}function jg(e){var t=to(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var W_=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function rB(e,t,n,r){var o=[];e.forEach(function(h){var p=pe(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var a,i,s=o.join(`
`),u=e.map(function(h){return function(p,m,g){g===void 0&&(g=!1);var v="";v+=g?z_(p):Ii(p);var y=p.shapeInfo.logicalShape,x=m.logicalShape;return y.length<=x.length&&(v+=g?function(w,b){var E,S=w.name,_=S.charAt(0).toUpperCase()+S.slice(1),k="get"+_+"AtOutCoords",N=w.shapeInfo.logicalShape.length,A=b.logicalShape.length,T=ua(w.shapeInfo.logicalShape,b.logicalShape),L=et(A),M=A-N,$=["x","y","z","w","u","v"];E=N===0?"":A<2&&T.length>=1?"coords = 0;":T.map(function(X){return"coords."+$[X+M]+" = 0;"}).join(`
`);var U="";U=A<2&&N>0?"coords":w.shapeInfo.logicalShape.map(function(X,ee){return"coords."+$[ee+M]}).join(", ");var j="return outputValue;",D=pe(w.shapeInfo.logicalShape)===1,F=pe(b.logicalShape)===1;if(N!==1||D||F){if(D&&!F)j=A===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var z=N-2,H=N-1;T.indexOf(z)>-1&&T.indexOf(H)>-1?j="return vec4(outputValue.x);":T.indexOf(z)>-1?j="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(H)>-1&&(j="return vec4(outputValue.xx, outputValue.zz);")}}else j=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+L+` coords = getOutputCoords();
      `+E+`
      vec4 outputValue = get`+_+"("+U+`);
      `+j+`
    }
  `}(p,m):function(w,b){var E=w.name,S=E.charAt(0).toUpperCase()+E.slice(1),_="get"+S+"AtOutCoords",k=b.texShape,N=w.shapeInfo.texShape,A=w.shapeInfo.logicalShape.length,T=b.logicalShape.length;if(!w.shapeInfo.isUniform&&A===T&&w.shapeInfo.flatOffset==null&&zt(N,k))return`
      float `+_+`() {
        return sampleTexture(`+E+`, resultUV);
      }
    `;var L,M=et(T),$=ua(w.shapeInfo.logicalShape,b.logicalShape),U=T-A,j=["x","y","z","w","u","v"];L=A===0?"":T<2&&$.length>=1?"coords = 0;":$.map(function(F){return"coords."+j[F+U]+" = 0;"}).join(`
`);var D="";return D=T<2&&A>0?"coords":w.shapeInfo.logicalShape.map(function(F,z){return"coords."+j[z+U]}).join(", "),`
    float `+_+`() {
      `+M+` coords = getOutputCoords();
      `+L+`
      return get`+S+"("+D+`);
    }
  `}(p,m)),v}(h,t,r)}).join(`
`),l=t.texShape,c=an(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+oB+`
    `+aB+`
    `+iB+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,b){var E=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];return E[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+E[1]+`.0);
      }
    `:E[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+E[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      return 2 * (resTexRC.x * `+E[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(w,b){var E=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];if(zt(w,b))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+E[0]+", "+E[1]+`));
      }
    `;var S=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));

      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=h,g=p,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(m[2]/2),x=y*Math.ceil(m[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,b){for(var E=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)],S=Math.ceil(w[w.length-1]/2),_=S*Math.ceil(w[w.length-2]/2),k=_,N="",A="b, r, c",T=2;T<w.length-1;T++)k*=w[w.length-T-1],N=`
      int b`+T+" = index / "+k+`;
      index -= b`+T+" * "+k+`;
    `+N,A="b"+T+", "+A;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+N+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+w.length+"("+A+`);
    }
  `}(h,p)}var m,g,v,y,x}(t.logicalShape,l),i=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return zt(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return m=p,g=qa(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var x=qa(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var x=qa(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var x=qa(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var m,g}(t.logicalShape,l),i=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=sB),[f,d,i,s,a,u,n].join(`
`)}function Ii(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var a=n.shapeInfo.texShape,i=a[0],s=a[1];if(i===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],d=Oa(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+ki(n)+`
      }
    `;var a=n.shapeInfo.texShape,i=a[0],s=a[1];if(s===1&&i===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Oa(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+i+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:i===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+i+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),i=n.shapeInfo.texShape;if(i!=null&&zt(r,i)){var s=i[0],u=i[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=$a(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var h=Ti(n,f);return`
      `+Ii(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+Pi(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+ki(n)+`
      }
    `;var p=i[0],m=i[1],g=Oa(o);return m===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+m+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+p+", "+m+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),i=r[1]*r[2],s=r[2],u=$a(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=Ti(n,d);return`
        `+Ii(f)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+Pi(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+i+", "+s+`, 1)));
        `+ki(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],m=h[1],g=n.shapeInfo.flatOffset;if(m===i&&g==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+m+".0, "+p+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(m===s&&g==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+".0, "+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=Oa(o);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+i+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+m+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),i=r[3],s=r[2]*i,u=r[1]*s,l=$a(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=Ti(n,c);return`
      `+Ii(f)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+Pi(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+i+`, 1)));
        `+ki(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],g=p[1];if(g===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+i+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===i&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=Oa(o);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+i+` + depth2;
      vec2 uv = uvFromFlat(`+m+", "+g+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),i=r[4],s=r[3]*i,u=r[2]*s,l=r[1]*u,c=$a(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=Ti(n,d);return`
      `+Ii(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+Pi(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+i+`)) +
          depth3;
        `+ki(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],v=m[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+i+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===i&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=Oa(o);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+i+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),i=$a(r),s=i.newShape,u=i.keptDims;if(s.length<r.length){var l=Ti(n,s);return`
      `+Ii(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+Pi(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+ki(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===p&&m==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&m==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=Oa(o);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function z_(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=an(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var a=o.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=an();return`
    vec4 `+i+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(o){var a=o.shapeInfo.logicalShape,i=o.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=an();if(u!=null&&zt(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+i+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+i+`, uv);
    }
  `}(e);case 3:return function(o){var a=o.shapeInfo.logicalShape,i=o.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),d=Ti(o,c);return`
        `+z_(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Pi(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],h=l[1],p=Math.ceil(a[2]/2),m=p*Math.ceil(a[1]/2),g=an();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+m+", "+p+`, b, row, col);
      return `+g.texture2D+"("+i+`, uv);
    }
  `}(e);default:return function(o){for(var a=o.shapeInfo.logicalShape,i=a.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(a[i-1]/2),p=h*Math.ceil(a[i-2]/2),m="int b, int row, int col",g="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<i-1;v++)m="int b"+v+", "+m,p*=a[i-v-1],g="b"+v+" * "+p+" + "+g;var y=an();return`
    vec4 `+u+"("+m+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var oB=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,aB=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sB=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Oa(e){return"offset"+e}function ki(e){var t=e.name,n=pe(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function et(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Ti(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Pi(e,t){return t.map(function(n){return e[n]}).join(", ")}var uB=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,P(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],a=Math.ceil(o/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var i,s,u=this.outputShape,l=u.length,c=et(l),d=Sn("coords",l);if(a===1){var f=et(s=l+1);i=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,i=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],m=h.map(function(_){return"int "+_}),g=Sn("sourceLocR",s-1).concat("inIdx.r"),v=Sn("sourceLocG",s-1).concat("inIdx.g"),y=Sn("sourceLocB",s-1).concat("inIdx.b"),x=Sn("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",b=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",E=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",S=r?"":`
      float getBestIndicesAChannel(`+m.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+m.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+i+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+E+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+b+`
          vec4 candidate = `+E+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},lB=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+i+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},cB=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=d-1-e.padInfo.top,m=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+i+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},dB=function(e,t,n,r,o,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Fe(e,t),Fe(e,n);var i="0.0";r!=null&&(Fe(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Fe(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+i+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},fB=function(e,t,n,r,o,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Fe(e,t),Fe(e,n);var i="vec4(0.0)";r!=null&&(Fe(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Fe(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+i+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},hB="return areal * breal - aimag * bimag;",pB="return areal * bimag + aimag * breal;",u1=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Fe(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Uh="return a + b;",Vh="return a - b;",l1="return a * b;",$_="return (a < 0.) ? b * a : a;",mt=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Fe(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},U_=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,xo=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Fe(t,n);var o=this.outputShape.length,a="";if(r)if(o===0||pe(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+et(o)+` coords = getOutputCoords();
        `,o===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var i=Sn("coords",o);a+=`
            bool nextRowOutOfBounds =
              (`+i[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+i[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},vB=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,a){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(a,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),mB=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,a){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(a,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),gB=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},yB=function(e){this.outputShape=[],this.outputShape=As(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var a=t.length,i=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+i+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},xB=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=As(e,t);var n=this.outputShape,r=n.length,o=et(r),a=Sn("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=i[t],c=i.slice(-2),d=i.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+dc(i,l,h)+`),
            vec2(`+dc(c,l,h)+`));
        }`}var p=s.length,m=s[s.length-1];f+=`
        return getChannel(
          getT`+p+"("+dc(i,l,m)+`),
          vec2(`+dc(c,l,m)+"));",this.userCode=`
      float getValue(`+i.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function dc(e,t,n){var r=e.indexOf(t);return e.map(function(o,a){return a===r?o+" - "+n:o}).join()}var wB=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},bB=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=e.dataFormat==="channelsLast",i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},CB=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,a=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+i+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},EB=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+i+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},_B=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},SB=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},c1=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,a=e.padInfo.left,i=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",m=p?1:2,g=p?2:3,v=p?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+i+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+m+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+x+`
        setOutput(result);
      }
    `},kB=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+a+", "+i+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},d1=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,a=e.inWidth,i=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,m="",g="";n&&(m=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},f1=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,a=e.inWidth,i=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=h,m="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var v=0;v<h;v++)m+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<p;y++){if(m+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(v=2*y)*d+`;
        `,l===1){if(v<h&&(m+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<h)){var x=s%2==0?s_(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(m+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):m+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<h&&(m+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(m+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<h&&(m+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<h&&(m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),m+="}");v<h&&(m+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<h&&(m+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<f;g++)for(v=0;v<h;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var w="",b="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,b="result = activation(result);");var E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+m+`

        vec4 result = dotProd;
        `+E+`
        `+b+`
        setOutput(result);
      }
    `},RB=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],i=e[1],s=e[2],u=e[3],l=t[0],c=n[0],d=n[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,h=[i-1+".0",s-1+".0"],p=h[0],m=h[1],g=c>1?[""+(i-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=g[0],y=g[1],x=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],b=w[0],E=w[1],S=w[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+b+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+E+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},NB=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+et(r)+` coords = getOutputCoords();
        int end = `+h1(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+h1(r,"coords")+` = idx;
          val += getX(`+function(i,s){if(i===1)return""+s;if(i===2)return s+".x, "+s+".y";if(i===3)return s+".x, "+s+".y, "+s+".z";if(i===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+i+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function h1(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var DB=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ol.DENSE;var t=Ru(e),n=an();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+qa(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},IB=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ol.DENSE;var t=Ru(e),n=an();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+qa(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},TB=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),PB=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},AB=function(e){this.variableNames=["A"],this.outTexUsage=Un.DOWNLOAD;var t=an();this.outputShape=e,this.userCode=`
      `+W_+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},MB=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Un.DOWNLOAD;var t=an();this.outputShape=e,this.userCode=`
      `+W_+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},FB=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=an(),o=t[0],a=t[1];this.outputShape=e;var i="result";n&&(i="floor(result * 255. + 0.5)"),this.userCode=`
      `+jg(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+i+`, 0., 0., 0.);
      }
    `},OB=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=an(),o=t[0],a=t[1];this.outputShape=e;var i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;i+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+jg(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+i+`

        `+r.output+" = "+s+`;
      }
    `},LB="return real * expR - imag * expI;",BB="return real * expI + imag * expR;",p1=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},jB=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),WB=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=et(this.rank),a=function(i,s){var u=i.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<i.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},zB=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=et(t.length),o=et(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function $B(e,t){var n=an();return LO(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function UB(e,t){return $O(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function VB(e,t){return UO(e,t,new Uint16Array([0,1,2,2,1,3]))}function Dl(e,t,n,r,o,a,i){HO(n,r);var s=VO(e,t),u=e.TEXTURE_2D;return ve(e,t,function(){return e.bindTexture(u,s)}),ve(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ve(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ve(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ve(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ve(e,t,function(){return e.texImage2D(u,0,o,n,r,0,a,i,null)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function HB(e,t,n,r,o){var a=_f(n,r);return Dl(e,t,a[0],a[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function GB(e,t,n,r,o){var a=_f(n,r);return Dl(e,t,a[0],a[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function qB(e,t,n,r,o){var a=_f(n,r);return Dl(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function KB(e,t,n,r,o){var a=Nl(n,r);return Dl(e,t,a[0],a[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function YB(e,t,n,r,o){var a=Nl(n,r);return Dl(e,t,a[0],a[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function XB(e,t,n,r){return ve(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),t1(e,t,n,"clipSpacePos",r,3,20,0)&&t1(e,t,n,"uv",r,2,20,12)}function QB(e,t,n,r,o,a,i){var s,u,l;ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=i.internalFormatPackedFloat),s.set(a),ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function JB(e,t,n,r){ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ve(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ve(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function ZB(e,t,n,r,o){var a=e.createBuffer();ve(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var i=16*n*r;return ve(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)}),ve(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ve(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function ej(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function tj(e,t,n,r,o){var a=_f(n,r),i=a[0],s=a[1],u=new Uint8Array(n*r*4);return ve(e,t,function(){return e.readPixels(0,0,i,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function nj(e,t,n,r,o,a,i,s){var u=e,l=new Float32Array(function(c,d){var f=Nl(c,d);return f[0]*f[1]*4}(a,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function rj(e,t,n,r){var o=new Float32Array(n*r*4);return ve(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var oj=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Y().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,PO(n,t)):this.gl=so(n);var r="WEBGL_color_buffer_float";if(Y().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=sc(this.gl,this.debug,"OES_texture_float"),ir(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=sc(this.gl,this.debug,"OES_texture_half_float");else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ir(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=sc(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ir(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!ir(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=UB(this.gl,this.debug),this.indexBuffer=VB(this.gl,this.debug),this.framebuffer=GO(this.gl,this.debug),this.textureConfig=Dg(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return Y().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ve(n,this.debug,function(){return n.finish()}),ve(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ve(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ve(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),HB(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),GB(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),qB(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),JB(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),QB(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),YB(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),KB(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(n1(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ve(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return tj(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,a,i){return nj(this.gl,t,0,0,0,a,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return ej(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=ZB(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(i,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=i}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return rj(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=BO(n,this.debug,t),o=$B(n,this.debug),a=WO(n,this.debug);return ve(n,this.debug,function(){return n.attachShader(a,o)}),ve(n,this.debug,function(){return n.attachShader(a,r)}),zO(n,this.debug,a),this.debug&&jh(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=XB(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ve(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&jh(this.gl,this.debug,this.program),ve(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?KO(this.gl,this.debug,t,n):YO(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ve(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),XO(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Nl(n,r),a=o[0],i=o[1];this.setOutputMatrixTextureDriver(t,a,i)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&jh(this.gl,this.debug,this.program),uc(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ve(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=sc(this.gl,this.debug,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),a=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return de(this,void 0,void 0,function(){var n=this;return fe(this,function(r){switch(r.label){case 0:return[4,Yx(function(){return n.disposed||n.isQueryAvailable(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||Yx(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Wh(this.gl,this.debug,t,this.framebuffer),this.debug&&uc(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Wh(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&uc(this.gl)):n1(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;Wh(o,this.debug,t,this.framebuffer),this.debug&&uc(o),this.outputTexture=t,ve(o,this.debug,function(){return o.viewport(0,0,n,r)}),ve(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var a=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function v1(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,a=t[r],i=a.shape;if(!zt(o,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+i+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!zt(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var aj=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,a=n.strideWidth,i=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,p=o*r,m=an(),g=d==="channelsLast",v=g?0:1,y=g?1:2,x="",w=0;w<=1;w++)for(var b=0;b<=1;b++)x+=`
          blockIndex = rc.y + `+b+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+i+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+m.output+` = result;
      }
    `},ij=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var a,i=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+i+"; j <= "+i+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},sj=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},uj=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,i=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+i+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+i+"; j <= "+i+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},lj=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,a=e.effectiveFilterWidth,i=o-1-e.padInfo.top,s=a-1-e.padInfo.left,u=o*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},cj=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=u-1-e.padInfo.top,f=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+i+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Hh=function(e,t,n,r,o,a,i){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),a===void 0&&(a=null),i===void 0&&(i=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=i?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+m+`

        `+p+`

        setOutput(result);
      }
    `},dj=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),fj=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},hj=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=Sn("rc",t),r=et(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),i=function(s,u){var l=s.length,c=function(d,f){for(var h=[],p=0;p<=1;p++)for(var m=0;m<=1;m++){for(var g=(p===0?"r":"rp1")+", "+(m===0?"c":"cp1"),v=2;v<d;v++)g=f[f.length-1-v]+","+g;h.push(g)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+i+`));
          }
        }
      `}},pj=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=et(r),a=t.map(function(u){return u[0]}).join(","),i=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+a+`);
      `+o+" end = "+o+"("+i+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+i+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},vj=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,v){return g[0]+e[v]+g[1]});for(var r=e.length,o=et(r),a=t.map(function(g){return g[0]}).join(","),i=t.map(function(g,v){return g[0]+e[v]}).join(","),s=Sn("rc",r),u=Sn("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,m=r===1?2:4;p<m;p++)h+=`
        `+d[p]+`
        if (`+f+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+a+`);
      const `+o+" end = "+o+"("+i+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Gh=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+a+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+a+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+i+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+m+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+p+`);
      }
    `}},qh=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+a+", "+i+`);
        const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),w=r%4,b=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+a+", "+i+`);
      const ivec3 pads = ivec3(`+h+", "+p+", "+m+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+b+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+b+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},mj=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,a=Math.ceil(o/n);this.outputShape=[r,a];var i="0.0",s="";t==="prod"?i="1.0":t==="min"?(i="1.0 / 1e-20",s="min"):t==="max"&&(i="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(i="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(i="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+i+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+i+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},gj=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+qa(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+jg(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},yj=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],a=r[2],i=e.shape,s=i[1],u=i[2],l=[n&&s>1?o-1:o,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},xj=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],a=e[1],i=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?i-1:i],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+i+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},wj=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],a=e[1],i=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?i-1:i],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+i+`.0,
                                     `+i+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},bj=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],a=r[2],i=e.shape,s=i[1],u=i[2],l=[n&&s>1?o-1:o,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Cj=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],a=e[1],i=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?i-1:i],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+i+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},Ej=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,i){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(i)}).join(","),o=et(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},_j=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Sn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],i=et(n);function s(u){var l=e.map(function(c,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+i+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},m1=function(e,t,n,r,o,a,i){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=et(o.length),u=et(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},Sj=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,a=e.numSegments,i=a*Math.ceil(o/n);this.outputShape=[r,i];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},kj=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&i.push(""+a[u]);r=i.join(),o=s.join()}var l=et(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},Rj=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=et(this.rank),o="uniform int start["+this.rank+"];",a=function(i){if(i===1)return"sourceLoc";if(i<=6)return Kh.slice(0,i).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+i+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(i,s){return"sourceLoc."+Kh[s]+" = start["+s+"] + coords."+Kh[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Kh=["x","y","z","w","u","v"],Nj=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=et(this.rank),r=Sn("coords",this.rank),o=Sn("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",i="getChannel(getSource("+o.join()+"), "+a+")",s=`
      result.x = `+i+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+i+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+i+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+i+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Dj=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=et(n.length),a=et(n.length),i="";if(r===1)i="coords * strides + begin";else{var s=0;i=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+i+`));
      }
    `},Ij=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,a=g1(n,r),i=y1(t,a,r);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[i].shift();return this.usedTextures[i].push(s),s}return this.numUsedTextures++,this.log(),a===zn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===zn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===zn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===zn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===zn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var a=y1(n,g1(r,o),o);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],s=i.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function g1(e,t){if(e===Un.UPLOAD)return zn.PACKED_2X2_FLOAT32;if(e===Un.RENDER||e==null)return function(n){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?zn.PACKED_2X2_FLOAT32:zn.UNPACKED_FLOAT32:n?zn.PACKED_2X2_FLOAT16:zn.UNPACKED_FLOAT16}(t);if(e===Un.DOWNLOAD||e===Un.PIXELS)return zn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function y1(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var Tj=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=et(this.rank),a=function(i){var s=i.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+i[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<i.length;c++)l.push("imod("+u[c]+", "+i[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},Pj=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=et(this.rank),a=function(i){var s=i.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<i.length;c++)l[i[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},Aj=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=et(this.rank),a=j_("rc",this.rank),i=new Array(this.rank);for(r=0;r<t.length;r++)i[t[r]]=a[r];var s="vec2("+i.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+i.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},Wg=1.7580993408473768,zg=1.0507009873554805,Te=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Ar="if (isnan(x)) return x;",Mj="return x;",x1="return abs(x);",V_=Ar+`
  return (x < 0.0) ? 0.0 : x;
`,H_=Ar+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,G_="return (x >= 0.0) ? x : (exp(x) - 1.0);",Fj=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Wg+`;
  float scale = `+zg+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,w1="return -x;",b1="return ceil(x);",C1="return floor(x);",E1="return exp(x);",_1="return exp(x) - 1.0;",Oj=Ar+`
  return sin(x);
`,Lj=Ar+`
  return cos(x);
`,Bj=Ar+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,jj=Ar+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Wj=Ar+`
  return atan(x);
`,zj=Ar+"return log(x + sqrt(x * x + 1.0));",$j=Ar+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,Uj=Ar+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,fc="return x;",Vj="return x;",q_=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,K_=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Y_=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,uu=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},Hj=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Sn("rc",t),r=et(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),i=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+i+`));
      }
    `},hc={};function pc(e,t){if(t===void 0&&(t=!1),e==="linear")return t?Vj:Mj;if(e==="relu")return t?q_:V_;if(e==="elu")return t?Y_:G_;if(e==="relu6")return t?K_:H_;if(e==="prelu")return t?U_:$_;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var Gj=600,qj=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=so(Y().getNumber("WEBGL_VERSION"));o.binaryCache=((r=Y().getNumber("WEBGL_VERSION"))in hc||(hc[r]={}),hc[r]),o.gpgpu=new oj(a),o.canvas=a.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new Ij(o.gpgpu),o.numMBBeforeWarning=Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*Gj/1024/1024,o.texData=new I_(o,W),o}return Pr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:o,values:n,usage:Un.UPLOAD}),a},t.prototype.move=function(n,r,o,a){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:a,values:r,usage:Un.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,a=r.dtype,i=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new uu(u,fc):new Te(u,fc);var d=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return o;var h,p,m=this.activeTimers!=null;return m&&(h=Hr()),a==="complex64"?p=jv(i.real.dataSync(),i.imag.dataSync()):p=this.getValuesFromTexture(n),m&&(this.downloadWaitMs+=Hr()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return de(this,void 0,void 0,function(){var r,o,a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S,_;return fe(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(N){return r.push(N)})];if(o=this.texData.get(n),a=o.values,i=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new uu(i,fc):new Te(i,fc),f=this.runWebGLProgram(d,[{dataId:n,shape:i,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(n),g=this.texData.get(m.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[g.texture].concat(Ru(i)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=k.sent(),x=y[0],w=y[1],v=jv(x,w),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(b=pe(i),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,b)),k.label=5;case 5:return m!=null&&this.disposeData(m.dataId),E=this.convertAndCacheOnCPU(n,v),S=this.pendingRead.get(n),this.pendingRead.delete(n),S.forEach(function(N){return N(E)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,E]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!FO(o))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),a=o.shape,i=o.dtype,s=o.isPacked,u=pe(a);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Ru(a))).subarray(0,u);return this.disposeData(l.dataId),d}var f=Y().getBool("WEBGL_PACK")&&s===!0,h=f?zh(a):a,p=f?new MB(h):new AB(h),m=this.runWebGLProgram(p,[{shape:h,dtype:i,dataId:n}],"float32"),g=this.texData.get(m.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),v},t.prototype.time=function(n){return de(this,void 0,void 0,function(){var r,o,a,i,s,u,l;return fe(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],a=!1,this.programTimersStack==null?(this.programTimersStack=o,a=!0):this.activeTimers.push(o),this.activeTimers=o,n(),i=Ts(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=Ts(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return l=c.sent(),u.kernelMs=vO(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Hr(),endMs:null}},t.prototype.endTimer=function(n){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Hr(),n)},t.prototype.getQueryTime=function(n){return de(this,void 0,void 0,function(){var r;return fe(this,function(o){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,a=r.dtype,i=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(i,a),this.textureManager.releaseTexture(o,i,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return Y().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=W.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return o.texData.get(a.dataId).texture==null&&a.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:W.keep(n.clone()),imag:W.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(pe(o)===0)return qt([],o,n.dtype);var a=this.texData.get(n.dataId).isPacked,i=N_(n.shape,r,o);if(a||!i){var s=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nj(o):new Rj(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var a=this.texData.get(n.dataId),i=this.makeOutput(o,n.dtype),s=this.texData.get(i.dataId);Object.assign(s,a),s.shape=o,s.dtype=n.dtype;var u=D_(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),i},t.prototype.stridedSlice=function(n,r,o,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,a);var i=Mg(r,o,a);if(i.some(function(u){return u===0}))return qt([],i);var s=new Dj(r,a,i);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _j(n.shape,r):new Ej(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return or(h)}),a=n.map(function(h){return Kr(h)});return Ht(this.concat(o,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(n.length/2),s=this.concat(n.slice(0,i),r),u=this.concat(n.slice(i),r);return this.concat([s,u],r)}if(Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new xB(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=As(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,pe(h.shape.slice(r)))}),f=new yB(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,w1,n.dtype);var r=new Te(n.shape,w1);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,a){var i=o?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((i===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),a&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=Gt(n.dtype,r.dtype),p=new Hh(n.shape,[l,i,s],o,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,a=n.transposeA,i=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],d=i?o.shape[1]:o.shape[2],f=r.shape[0],h=Gt(r.dtype,o.dtype),p=s!=null,m=l!=null,g=u?pc(u,!0):null,v=new Hh(r.shape,[f,c,d],a,i,p,g,m),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),a=this.texData.get(r.dataId),i=new u1(hB,n.shape,r.shape),s=new u1(pB,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(i,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,l1,n.dtype);var f=new mt(l1,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,a,i,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(i!=null&&(c=i.shape,u.push(i)),Y().getBool("WEBGL_PACK_NORMALIZATION")){var d=new fB(n.shape,r.shape,o.shape,l,c,a);return this.compileAndRun(d,u)}var f=new dB(n.shape,r.shape,o.shape,l,c,a);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(n,r,o,a,i){var s=Y().getBool("WEBGL_PACK_NORMALIZATION")?new uj(n.shape,r,o,a,i):new ij(n.shape,r,o,a,i);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,a,i,s,u){var l=new sj(r.shape,a,i,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(i){return Ed(i)});return L_(Re(n.shape,n.dtype,o),r)}var a=new Tj(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,o){var a=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vj(n.shape,r,o):new pj(n.shape,r,o);return this.compileAndRun(a,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Aj(n.shape,r):new Pj(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var a=new WB(n.shape,r.size,o);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){P(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,f){return d*f}),i=Dd(n.shape,r,a),s=Id(i.length,r.length),u=Td(n.shape,r,a),l=__(o,r.length),c=S_(u,o,r.length);return n.reshape(i).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){P(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,h){return f*h}),i=[[0,0]];i.push.apply(i,o);for(var s=1+r.length;s<n.shape.length;++s)i.push([0,0]);var u=n.pad(i),l=Dd(u.shape,r,a,!1),c=Id(l.length,r.length,!1),d=Td(u.shape,r,a,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.reduce=function(n,r,o){var a=n.shape[0],i=n.shape[1],s=$h(i),u=new mj({windowSize:s,inSize:i,batchSize:a},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var a=n.shape[0],i=n.shape[1];o!=null&&(a=o.shape[0],i=o.shape[1]);var s=$h(i),u=new nB({windowSize:s,inSize:i,batchSize:a},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var a=o!=null?o.shape:n.shape,i=$h(a[a.length-1]),s=new uB(a,i,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){jn("sum",r,n.rank);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i),u=Mh(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i),u=Mh(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,o){var a=0,i=uo([a],n.rank),s=n;i!=null&&(s=n.transpose(i),a=lo(1,n.rank)[0]);var u=function(h,p,m){for(var g=[],v=h.length,y=0;y<v;y++)y!==p?g.push(h[y]):g.push(m);return g}(s.shape,a,o),l=pe([s.shape[a]]),c=s.as2D(-1,l),d=Mh(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return i!=null&&(f=f.transpose(Ig(i))),f},t.prototype.segOpCompute=function(n,r,o,a,i){var s=n.shape[0],u=n.shape[1],l=function(f,h){var p,m=!1;for(f<=R_?(p=f,m=!0):p=Iv(f,Math.floor(Math.sqrt(f)));!m;)p>h||p===f?m=!0:p=Iv(f,p+1);return p}(u,i),c=new Sj({windowSize:l,inSize:u,batchSize:s,numSegments:i}),d=this.compileAndRun(c,[n,o],a);return d.shape[1]===i?d:(o=Nd(0,i).tile([u/l]),this.segOpCompute(d,r,o,a,i))},t.prototype.argMinMaxReduce=function(n,r,o){var a=[r];if(jn("arg"+o.charAt(0).toUpperCase()+o.slice(1),a,n.rank),!Y().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var i=nn(n.shape,a),s=i[0],u=pe(i[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var i=new NB(n.shape,o,a);return this.compileAndRun(i,[n])},t.prototype.equal=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new mt("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new mt("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new mt("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new mt("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new mt("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new mt("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Te(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new mt("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new mt("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var a=new kj(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,o],Gt(r.dtype,o.dtype))},t.prototype.where=function(n){kd("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Bg(n.shape,r)},t.prototype.topk=function(n,r,o){return B_(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){jn("min",r,n.rank);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new mt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new mt(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);jn("max",r,n.rank);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new mt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){jn("all",r,n.rank);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){jn("any",r,n.rank);var o=nn(n.shape,r),a=o[0],i=pe(o[1]),s=n.as2D(-1,i);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.realDivide=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new mt(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new mt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Uh);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Gt(n.dtype,r.dtype);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Uh,o);var a=new mt(Uh,n.shape,r.shape);return this.compileAndRun(a,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var a=new uu(n.shape,r);return this.compileAndRun(a,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,a,i){i===void 0&&(i=!1);var s=new xo(o,n.shape,r.shape,i);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var a=this,i=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[i.complexTensors.real,s.complexTensors.real],[i.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],p=f[1],m=a.makeComplexComponentTensorInfo(n,h),g=a.makeComplexComponentTensorInfo(r,p),v=new mt(o,n.shape,r.shape);return a.compileAndRun(v,[m,g],Gt(h.dtype,p.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>Y().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([o,a])}var i=n.map(function(l){return l.dtype}).reduce(function(l,c){return Gt(l,c)}),s=n.map(function(l){return l.shape}),u=Y().getBool("WEBGL_PACK")?new tB(n[0].shape,s):new eB(n[0].shape,s);return this.compileAndRun(u,n,i)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Vh);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Gt(n.dtype,r.dtype);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Vh,n.dtype);var a=new mt(Vh,n.shape,r.shape);return this.compileAndRun(a,[n,r],o)},t.prototype.pow=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new mt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=Gt(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,b1,n.dtype);var r=new Te(n.shape,b1);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,C1,n.dtype);var r=new Te(n.shape,C1);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Te(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Te(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Te(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Te(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Te(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,E1,n.dtype);var r=new Te(n.shape,E1);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,_1,n.dtype);var r=new Te(n.shape,_1);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=Lt([r],n.shape),a=this.max(n,o),i=Mn(a.shape,o),s=this.subtract(n,a.reshape(i)),u=this.exp(s),l=this.sum(u,o).reshape(i);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Te(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Te(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Te(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Te(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Te(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=Y().getBool("WEBGL_PACK")?new uu(n.shape,q_):new Te(n.shape,V_),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=Y().getBool("WEBGL_PACK")?new uu(n.shape,K_):new Te(n.shape,H_),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(U_,n.shape,r.shape):new mt($_,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Y_,n.dtype);var r=new Te(n.shape,G_);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new mt("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new Te(n.shape,Fj);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Te(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var a,i=(a=Y().getBool("WEBGL_PACK_CLIP")?new mB(n.shape):new vB(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(a,[n],null,i)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,x1,n.dtype);var r=new Te(n.shape,x1);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new gB(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,a)},t.prototype.sigmoid=function(n){var r=new Te(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Te(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Te(n.shape,Oj);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Te(n.shape,Lj);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Te(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Te(n.shape,Bj);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Te(n.shape,jj);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Te(n.shape,Wj);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new mt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new Te(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Te(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Te(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Te(n.shape,zj);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Te(n.shape,$j);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Te(n.shape,Uj);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Te(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new Te(n.shape,function(a){return a===void 0&&(a=0),Ar+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,a,i,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",p=(d===1||f===1)&&c>1e3,m=u[2]%2!=0&&!!l.isPacked;if(p||!Y().getBool("WEBGL_LAZILY_UNPACK")||!Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:i,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},b=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,P(cc(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var E=this.reshape(r,[1,o.inChannels,o.outChannels]),S=this.fusedBatchMatMul({a:w,b:E,transposeA:!1,transposeB:!1,bias:a,activation:i,preluActivationWeights:s}),_=this.texData.get(S.dataId);return P(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=b,_.shape=o.outShape,W.makeTensorFromDataId(S.dataId,o.outShape,S.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,a,i,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",p=u*l*c,m=f*d,g=[p,m],v=n.squeeze([0]),y=r.reshape([1,p,-1]),x=new aj(g,v.shape,o),w=this.compileAndRun(x,[v]).reshape([1,g[0],g[1]]),b=a!=null,E=s!=null,S=i?pc(i,!0):null,_=new Hh(w.shape,[1,m,o.outChannels],!0,!1,b,S,E),k=[w,y];a&&k.push(a),E&&k.push(s);var N=this.compileAndRun(_,k);return h?N.reshape([1,f,d,o.outChannels]):N.reshape([1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,a=n.convInfo,i=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,a,i,s,u);if(Y().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,a,i,s,u);var l=i!=null,c=u!=null,d=s?pc(s,!1):null,f=new c1(a,l,d,c),h=[r,o];return i&&h.push(i),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(Y().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var a=new c1(o);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var a=new bB(o);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var a=new wB(o);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,a=n.filter,i=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,d=u?pc(u,c):null,f=[o,a],h=s!=null,p=l!=null;return h&&f.push(s),p&&f.push(l),c?(r=new f1(i,h,d,p),this.compileAndRun(r,f)):(r=new d1(i,h,d,p),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,o){var a;return Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(a=new f1(o),this.compileAndRun(a,[n,r])):(a=new d1(o),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var a=new SB(o);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var a=new _B(o);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,o){var a=new kB(o);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var a=new EB(o);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var a=new CB(o);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var o=new Gh(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new Gh(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,a){var i=new Gh(a,"max",!0),s=this.compileAndRun(i,[r]),u=new lj(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var a=new lB(o);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return A_(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],a=new Array(n.rank-1),i=0,s=0;s<n.rank;s++)s!==r&&(a[i++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var o=new qh(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var a=new cB(o);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new qh(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,a){var i=new qh(a,"max",!0),s=this.compileAndRun(i,[r]),u=new cj(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!cc(n.shape,r)&&(o.texture===null||!cc(o.shape,r))){var a=this.packedReshape(n,r);return W.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return Bv(n,r)},t.prototype.resizeBilinear=function(n,r,o,a){var i=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new wj(n.shape,r,o,a):new xj(n.shape,r,o,a);return this.compileAndRun(i,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var a=new yj(n,r,o);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,a){var i=new Cj(n.shape,r,o,a);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var a=new bj(n,r,o);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,o,a){var i=r?n:Mo(n),s=i.shape[0],u=i.shape[1],l=new dj(s,u,o),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[i],"int32",c)},t.prototype.oneHot=function(n,r,o,a){var i=new fj(n.size,r,o,a);return this.compileAndRun(i,[n])},t.prototype.diag=function(n){var r=new PB(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,a,i){return kd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Og(n.dataSync(),r.dataSync(),o,a,i)},t.prototype.cropAndResize=function(n,r,o,a,i,s){var u=new RB(n.shape,r.shape,a,i,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){P(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],i=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=i*r,c=s*r,d=u/(r*r),f=new TB(o==="NHWC"?[a,l,c,d]:[a,d,l,c],r,o);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,o){return O_(n,r,o)},t.prototype.scatterND=function(n,r,o){var a=Pd(0,n,o),i=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,d=[c/u,u],f=n.reshape([s,i]),h=r.reshape([s,u]);if(c===0)return Bv(qt([]),o);var p=ie(0),m=new m1(s,i,f.rank,h.rank,l,d);return this.compileAndRun(m,[h,f,p]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,a){var i=Pd(0,n,o),s=i.sliceRank,u=i.numUpdates,l=i.strides,c=i.outputSize,d=new m1(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(d,[r,n,a]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),a=new p1(LB,n.shape,r),i=new p1(BB,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(i,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,a=o[o.length-1],i=k_(n,r),s=i[0],u=i[1],l=i[2],c=i[3],d=r.reshape([u,a]),f=n.reshape([n.size/l,l]),h=new zB(a,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||kl(r))==="string"){var a=Cd(o,pe(n));return a.fill(r),W.makeTensor(a,n,o,this)}var i=new jB(n,r),s=i.getCustomSetupFunc(r);return this.compileAndRun(i,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return M_(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return W.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new Hj(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new hj(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[_d(n.shape)].concat(Sd(n.shape)),a={dtype:n.dtype,shape:o,dataId:n.dataId},i=[_d(r)].concat(Sd(r)),s=new gj(i,o),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),a=o.isPacked,i=o.shape,s=o.dtype,u=zh(i);return r=a?new IB(u):new DB(u),{dtype:s,shape:i,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,a,i){var s=this;i===void 0&&(i=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===ol.DENSE){var c=Ru(n.outputShape);l.texShape=c.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),pe(u.shape)===0)return l.values=nl(u.dtype,0),u;var d=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(x.dataId);if(w.texture==null){if(!n.packedInputs&&pe(x.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=x.shape)}else if(!!w.isPacked!=!!n.packedInputs)x=w.isPacked?s.unpackTensor(x):s.packTensor(x),d.push(x),w=s.texData.get(x.dataId);else if(w.isPacked&&!cc(w.shape,x.shape)){var b=x,E=x.shape;x.shape=w.shape,x=s.packedReshape(x,E),d.push(x),w=s.texData.get(x.dataId),b.shape=E}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},m=function(x,w,b){var E="";w.concat(b).forEach(function(k){var N=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,A=k.isUniform?"uniform":k.texData.texShape;E+=k.shape+"_"+A+"_"+N});var S=x.userCode,_=x.constructor.name;return _+="_"+E+"_"+S}(n,f,p),g=this.getAndSaveBinary(m,function(){return function(x,w,b,E){var S=w.userCode,_=b.map(function(D,F){var z={logicalShape:D.shape,texShape:D.isUniform?null:D.texData.texShape,isUniform:D.isUniform,isPacked:!D.isUniform&&D.texData.isPacked,flatOffset:null};return D.texData!=null&&D.texData.slice!=null&&D.texData.slice.flatOffset>0&&(z.flatOffset=D.texData.slice.flatOffset),{name:w.variableNames[F],shapeInfo:z}}),k=_.map(function(D){return D.shapeInfo}),N={logicalShape:E.shape,texShape:E.texData.texShape,isUniform:!1,isPacked:E.texData.isPacked,flatOffset:null},A=rB(_,N,S,w.packedInputs),T=x.createProgram(A),L=null,M=x.getUniformLocation(T,"NAN",!1);Y().getNumber("WEBGL_VERSION")===1&&(L=x.getUniformLocation(T,"INFINITY",!1));for(var $={},U=0;U<w.variableNames.length;U++){var j=w.variableNames[U];$[j]=x.getUniformLocation(T,j,!1),$["offset"+j]=x.getUniformLocation(T,"offset"+j,!1)}return{program:w,source:A,webGLProgram:T,uniformLocations:$,inShapeInfos:k,outShapeInfo:N,infLoc:L,nanLoc:M}}(s.gpgpu,n,f,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(x,w,b,E,S){v1(w.inShapeInfos,b),v1([w.outShapeInfo],[E]);var _=E.texData.texture,k=E.texData.texShape;E.texData.isPacked?x.setOutputPackedMatrixTexture(_,k[0],k[1]):x.setOutputMatrixTexture(_,k[0],k[1]),x.setProgram(w.webGLProgram),Y().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&x.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&x.gl.uniform1f(w.nanLoc,NaN),b.forEach(function(N,A){var T=w.program.variableNames[A],L=w.uniformLocations[T],M=w.uniformLocations["offset"+T];if(L!=null)if(N.isUniform)if(pe(N.shape)<2)x.gl.uniform1f(L,N.uniformValues[0]);else{var $=N.uniformValues;$ instanceof Float32Array||($=new Float32Array($)),x.gl.uniform1fv(L,$)}else N.texData.slice!=null&&M!=null&&x.gl.uniform1i(M,N.texData.slice.flatOffset),x.setInputMatrixTexture(N.texData.texture,L,A)}),S!=null&&S(x,w.webGLProgram),x.executeProgram()}(this.gpgpu,g,f,p,a),d.forEach(function(x){return s.disposeData(x.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!Y().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,a,i){i===void 0&&(i=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,a,i);return W.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ue(function(){if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Y().getBool("DEBUG");Y().set("DEBUG",!1);var o=n.abs(ie(1e-8)).dataSync()[0];if(Y().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),a=o.shape,i=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Hr());var h=o.texShape;if(h==null&&(h=ZO(a,c),o.texShape=h),s!=null){var p=zh(a),m=void 0,g=h[1],v=h[0],y=s instanceof Uint8Array;c?(g=(r=Nl(h[0],h[1]))[0],v=r[1],m=new OB(p,[v,g],y)):m=new FB(p,[v,g],y);var x=this.makeTensorInfo([v,g],i);this.texData.get(x.dataId).usage=y?Un.PIXELS:Un.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,v,s);var w=this.runWebGLProgram(m,[x],i,null,!0),b=this.texData.get(w.dataId);o.texture=b.texture,o.texShape=b.texShape,o.isPacked=b.isPacked,o.usage=b.usage,this.disposeData(x.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=Hr()-d)}else{var E=this.acquireTexture(h,l,i,c);o.texture=E}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),a=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(i,s){if(s==="float32"||s==="complex64")return i;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(i.length):new Uint8Array(i.length),l=0;l<u.length;++l)u[l]=Math.round(i[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),o.values},t.prototype.acquireTexture=function(n,r,o,a){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*u_(r)},t}(T_);v_()&&W.registerBackend("webgl",function(){return new qj},2);var Kj=B({square_:function(e){var t=I(e,"x","square"),n=[t];return W.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),il="SquaredDifference",X_=B({squaredDifference_:function(e,t){var n,r=I(e,"a","squaredDifference"),o=I(t,"b","squaredDifference");n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape);var a={a:r,b:o},i=[r,o];return W.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},a,function(s,u){var l=u[0],c=u[1],d=ie(2);return{a:function(){return s.mul(l.sub(c).mul(d))},b:function(){return s.mul(c.sub(l).mul(d))}}},il,{},i,[])}}),Yj=B({abs_:function(e){var t=I(e,"x","abs");return t.dtype==="complex64"?W.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):W.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),Xj=B({acos_:function(e){var t=I(e,"x","acos");return W.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ie(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),Qj=B({acosh_:function(e){var t=I(e,"x","acosh");return W.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),Jj=B({asin_:function(e){var t=I(e,"x","asin");return W.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ie(1).sub(o.toFloat().square()).sqrt())}}})}}),Zj=B({asinh_:function(e){var t=I(e,"x","asinh");return W.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ie(1).add(o.toFloat().square()).sqrt())}}})}}),eW=B({atan_:function(e){var t=I(e,"x","atan");return W.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),tW=B({atanh_:function(e){var t=I(e,"x","atanh");return W.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(ie(1).sub(o.toFloat().square()))}}})}}),nW=B({ceil_:function(e){var t=I(e,"x","ceil");return W.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),$g=B({clipByValue_:function(e,t,n){var r=I(e,"x","clipByValue");P(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],a={min:t,max:n};return W.runKernelFunc(function(i,s){var u=i.clip(r,t,n);return s([r]),u},{x:r},function(i,s){var u=s[0];return{x:function(){return i.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),je(i))}}},"ClipByValue",a,o)}}),rW=B({cos_:function(e){var t=I(e,"x","cos"),n=[t];return W.runKernelFunc(function(r,o){var a=r.cos(t);return o([t]),a},{x:t},function(r,o){var a=o[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),oW=B({cosh_:function(e){var t=I(e,"x","cosh");return W.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),aW=B({erf_:function(e){var t=I(e,"x","erf");return P(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),W.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Wv=B({exp_:function(e){var t=I(e,"x","exp");return W.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),iW=B({expm1_:function(e){var t=I(e,"x","expm1");return W.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),sW=B({floor_:function(e){var t=I(e,"x","floor");return W.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),uW=B({log_:function(e){var t=I(e,"x","log"),n=[t];return W.runKernelFunc(function(r,o){var a=r.log(t);return o([t]),a},{x:t},function(r,o){var a=o[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),lW=B({log1p_:function(e){var t=I(e,"x","log1p");return W.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),cW=B({logSigmoid_:function(e){var t=I(e,"x","logSigmoid");return W.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Od=B({neg_:function(e){var t=I(e,"x","neg"),n=[t];return W.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),dW=B({reciprocal_:function(e){var t=I(e,"x","reciprocal");return W.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),fW=B({round_:function(e){var t=I(e,"x","round");return W.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),Q_=B({rsqrt_:function(e){var t=I(e,"x","rsqrt"),n=[t];return W.runKernelFunc(function(r,o){var a=r.rsqrt(t);return o([t]),a},{x:t},function(r,o){var a=o[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),J_=B({sigmoid_:function(e){var t=I(e,"x","sigmoid");return W.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ie(1).sub(o)))}}},"Sigmoid")}}),hW=B({sign_:function(e){var t=I(e,"x","sign");return W.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),pW=B({isNaN_:function(e){var t=I(e,"x","isNaN");return W.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),vW=B({isInf_:function(e){var t=I(e,"x","isInf");return W.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),mW=B({isFinite_:function(e){var t=I(e,"x","isFinite");return W.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return je(n)}}})}}),gW=B({sin_:function(e){var t=I(e,"x","sin"),n=[t];return W.runKernelFunc(function(r,o){var a=r.sin(t);return o([t]),a},{x:t},function(r,o){var a=o[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),yW=B({sinh_:function(e){var t=I(e,"x","sinh");return W.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),xW=B({softplus_:function(e){var t=I(e,"x","softplus");return W.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),wW=B({sqrt_:function(e){var t=I(e,"x","sqrt");return W.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),bW=B({step_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","step");return W.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return je(r)}}})}}),CW=B({tan_:function(e){var t=I(e,"x","tan");return W.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),EW=B({tanh_:function(e){var t=I(e,"x","tanh");return W.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return ie(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function Z_(e,t,n,r,o,a){var i,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(i=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),P(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),P(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),P(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),i!=null&&P(i.rank===2||i.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+i.rank+"."}),s!=null&&P(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Il(u,l,c,s,i,a)}function eS(e,t,n,r,o,a){var i,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(i=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),P(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),P(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),P(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),i!=null&&P(i.rank===3||i.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+i.rank+"."}),s!=null&&P(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Il(u,l,c,s,i,a)}function tS(e,t,n,r,o,a){var i,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(i=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),P(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),P(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),P(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),i!=null&&P(i.rank===4||i.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+i.rank+"."}),s!=null&&P(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Il(u,l,c,s,i,a)}function Il(e,t,n,r,o,a){a==null&&(a=.001);var i,s,u,l=I(e,"x","batchNorm"),c=I(t,"mean","batchNorm"),d=I(n,"variance","batchNorm");o!=null&&(i=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),P(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),P(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),P(i==null||c.rank===i.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,i];return W.runKernelFunc(function(h,p){var m=h.batchNormalization(u,vc(c),vc(d),a,vc(i),vc(s));return p([l,c,d,i]),m},{x:l,mean:c,variance:d,scale:i,offset:s},function(h,p){var m=p,g=m[0],v=m[1],y=m[2],x=m[3],w=x??ie(1),b=Ft(v.shape,u.shape),E=[];if(v.rank===1){for(var S=0;S<u.shape.length-1;++S)E.push(u.shape[S]);E.push(1)}var _=g.sub(v),k=h.mul(w),N=Q_(y.add(ie(a))),A=N.mul(N).mul(N).mul(ie(-.5));return{x:function(){return v.rank===1?h.mul(os(N.as4D(1,1,1,v.shape[0]),E)).mul(w).reshape(g.shape):h.mul(N).mul(w).reshape(g.shape)},mean:function(){var T=N.mul(ie(-1)).mul(k);return v.rank===1&&(T=T.sum(b)),T.reshape(v.shape)},variance:function(){var T=A.mul(_).mul(k);return v.rank===1&&(T=T.sum(b)),T.reshape(v.shape)},scale:function(){var T=_.mul(N),L=h.mul(T);return v.rank===1&&(L=L.sum(b)),L.reshape(v.shape)},offset:function(){var T=h;return v.rank===1&&(T=T.sum(b)),T.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:a},f).reshape(l.shape)}function vc(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Rf(){m_("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var _W=B({batchNormalization2d_:function(e,t,n,r,o,a){return r===void 0&&(r=.001),Rf(),Z_(e,t,n,a,o,r)}}),SW=B({batchNormalization3d_:function(e,t,n,r,o,a){return r===void 0&&(r=.001),Rf(),eS(e,t,n,a,o,r)}}),kW=B({batchNormalization4d_:function(e,t,n,r,o,a){return r===void 0&&(r=.001),Rf(),tS(e,t,n,a,o,r)}}),RW=B({batchNormalization_:function(e,t,n,r,o,a){return r===void 0&&(r=.001),Rf(),Il(e,t,n,a,o,r)}}),nS=B({batchNorm_:Il}),NW=B({batchNorm2d_:Z_}),DW=B({batchNorm3d_:eS}),IW=B({batchNorm4d_:tS}),Nf=B({logicalAnd_:function(e,t){var n=I(e,"a","logicalAnd","bool"),r=I(t,"b","logicalAnd","bool");return Fe(n.shape,r.shape),W.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),TW=B({logicalNot_:function(e){var t=I(e,"x","logicalNot","bool");return W.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),rS=B({logicalOr_:function(e,t){var n=I(e,"a","logicalOr","bool"),r=I(t,"b","logicalOr","bool");return Fe(n.shape,r.shape),W.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),PW=B({logicalXor_:function(e,t){var n=I(e,"a","logicalXor","bool"),r=I(t,"b","logicalXor","bool");return Fe(n.shape,r.shape),rS(e,t).logicalAnd(Nf(e,t).logicalNot())}}),ci=B({where_:function(e,t,n){var r=I(t,"a","where"),o=I(n,"b","where"),a=I(e,"condition","where","bool");return Ke(r.shape,o.shape,"Error in where: "),a.rank===1?P(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ke(a.shape,o.shape,"Error in where: "),W.runKernelFunc(function(i,s){var u=i.select(a,r,o);return s([a]),u},{$condition:a,$a:r,$b:o},function(i,s){var u=s[0];return{$condition:function(){return je(u).toFloat()},$a:function(){return i.mul(u.cast(i.dtype))},$b:function(){return i.mul(u.logicalNot().cast(i.dtype))}}})}}),oS=function(e){return de(this,void 0,void 0,function(){var t,n,r;return fe(this,function(o){switch(o.label){case 0:return[4,(t=I(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Bg(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Me=B({add_:function(e,t){var n,r=I(e,"a","add"),o=I(t,"b","add");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i){return i.add(r,o)},{a:r,b:o},function(i){return{a:function(){var s=i,u=Ft(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=i,u=Ft(o.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),AW=B({addN_:function(e){P(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),P(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,a){return I(o,"tensors"+a,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!zt(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return W.runKernelFunc(function(o){return o.addN(t)},r,function(o){var a={};return t.forEach(function(i,s){a[s]=function(){return o.clone()}}),a},"AddN")}}),MW=B({addStrict_:function(e,t){var n=I(e,"a","addStrict"),r=I(t,"b","addStrict");return Ke(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),FW=B({atan2_:function(e,t){var n,r=I(e,"a","atan2"),o=I(t,"b","atan2");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i,s){var u=i.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(i,s){var u=s[0],l=s[1];return{$a:function(){var c=Me(u.square(),l.square()),d=i.mul(l.div(c)),f=Ft(u.shape,a);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=Me(u.square(),l.square()),d=Od(i.mul(u.div(c))),f=Ft(l.shape,a);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),xr=B({div_:function(e,t){var n,r=I(e,"a","div"),o=I(t,"b","div");if(n=vt(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return aS(r,o);var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i,s){var u=i.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(i,s){var u=s[0],l=s[1];return{a:function(){var c=i.div(l.toFloat()),d=Ft(u.shape,a);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=i.mul(u.toFloat()),d=Ft(l.shape,a);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),OW=B({divNoNan_:function(e,t){var n,r=I(e,"a","div"),o=I(t,"b","div");r=(n=vt(r,o))[0],o=n[1];var a=xr(r,o),i=je(a),s=o.equal(i);return ci(s,i,a)}}),LW=B({divStrict_:function(e,t){var n=I(e,"a","div"),r=I(t,"b","div");return Ke(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),aS=B({floorDiv_:function(e,t){var n,r=I(e,"a","floorDiv"),o=I(t,"b","floorDiv");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i,s){var u=i.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(i,s){var u=s[0],l=s[1];return{a:function(){var c=i.div(l.toFloat()),d=Ft(u.shape,a);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=i.mul(u.toFloat()),d=Ft(l.shape,a);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),Ug=B({maximum_:function(e,t){var n,r=I(e,"a","maximum"),o=I(t,"b","maximum");return n=vt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Fe(r.shape,o.shape),W.runKernelFunc(function(a,i){var s=a.maximum(r,o);return i([r,o]),s},{a:r,b:o},function(a,i){var s=i[0],u=i[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),BW=B({maximumStrict_:function(e,t){var n=I(e,"a","maximumStrict"),r=I(t,"b","maximumStrict");return Ke(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),iS=B({minimum_:function(e,t){var n,r=I(e,"a","minimum"),o=I(t,"b","minimum");return n=vt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Fe(r.shape,o.shape),W.runKernelFunc(function(a,i){var s=a.minimum(r,o);return i([r,o]),s},{a:r,b:o},function(a,i){var s=i[0],u=i[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),jW=B({minimumStrict_:function(e,t){var n=I(e,"a","minimumStrict"),r=I(t,"b","minimumStrict");return Ke(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),WW=B({mod_:function(e,t){var n,r=I(e,"a","mod"),o=I(t,"b","mod");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i,s){var u=i.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(i,s){var u=s[0],l=s[1];return{$a:function(){var c=Ft(u.shape,a);return c.length>0?i.sum(c).reshape(u.shape):i},$b:function(){var c=i.mul(u.div(l).floor().neg()),d=Ft(l.shape,a);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),zW=B({modStrict_:function(e,t){var n=I(e,"a","modStrict"),r=I(t,"b","modStrict");return Ke(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),un=B({mul_:function(e,t){var n,r=I(e,"a","mul"),o=I(t,"b","mul");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i,s){var u=i.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(i,s){var u=s[0],l=s[1];return{a:function(){var c=i.mul(l.toFloat()),d=Ft(u.shape,a);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=i.mul(u.toFloat()),d=Ft(l.shape,a);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),$W=B({mulStrict_:function(e,t){var n=I(e,"a","mul"),r=I(t,"b","mul");return Ke(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Ld=B({pow_:function(e,t){var n,r=I(e,"base","pow"),o=I(t,"exp","pow");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape),i=[r,o];return W.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(l.pow(f.sub(ie(1))))),p=Ft(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,je(l)),p=s.mul(d.mul(h)),m=Ft(c.shape,a);return m.length>0&&(p=p.sum(m)),p.reshape(c.shape)}}},"Pow",{},i,[!0])}}),UW=B({powStrict_:function(e,t){return Ke(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),VW=B({squaredDifferenceStrict_:function(e,t){var n=I(e,"a","squaredDifferenceStrict"),r=I(t,"b","squaredDifferenceStrict");return Ke(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ot=B({sub_:function(e,t){var n,r=I(e,"a","sub"),o=I(t,"b","sub");n=vt(r,o),r=n[0],o=n[1];var a=Fe(r.shape,o.shape);return W.runKernelFunc(function(i){return i.subtract(r,o)},{a:r,b:o},function(i){return{a:function(){var s=i,u=Ft(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=i,u=Ft(o.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),HW=B({subStrict_:function(e,t){var n=I(e,"a","subStrict"),r=I(t,"b","subStrict");return Ke(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),sS=B({equal_:function(e,t){var n,r=I(e,"a","equal"),o=I(t,"b","equal");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a){return a.equal(r,o)},{$a:r,$b:o})}}),GW=B({equalStrict_:function(e,t){var n=I(e,"a","equalStrict"),r=I(t,"b","equalStrict");return Ke(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),qW=B({greater_:function(e,t){var n,r=I(e,"a","greater"),o=I(t,"b","greater");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a){return a.greater(r,o)},{a:r,b:o},null,"Greater")}}),uS=B({greaterEqual_:function(e,t){var n,r=I(e,"a","greaterEqual"),o=I(t,"b","greaterEqual");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a,i){var s=a.greaterEqual(r,o);return i([r,o]),s},{a:r,b:o},function(a,i){var s=i[0],u=i[1];return{a:function(){return je(s)},b:function(){return je(u)}}},"GreaterEqual")}}),KW=B({greaterEqualStrict_:function(e,t){var n=I(e,"a","greaterEqualStrict"),r=I(t,"b","greaterEqualStrict");return Ke(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),YW=B({greaterStrict_:function(e,t){var n=I(e,"a","greaterStrict"),r=I(t,"b","greaterStrict");return Ke(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),XW=B({less_:function(e,t){var n,r=I(e,"a","less"),o=I(t,"b","less");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a){return a.less(r,o)},{a:r,b:o},null,"Less")}}),QW=B({lessEqual_:function(e,t){var n,r=I(e,"a","lessEqual"),o=I(t,"b","lessEqual");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a,i){var s=a.lessEqual(r,o);return i([r,o]),s},{a:r,b:o},null,"LessEqual")}}),JW=B({lessEqualStrict_:function(e,t){var n=I(e,"a","lessEqualStrict"),r=I(t,"b","lessEqualStrict");return Ke(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),ZW=B({lessStrict_:function(e,t){var n=I(e,"a","lessStrict"),r=I(t,"b","lessStrict");return Ke(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),e5=B({notEqual_:function(e,t){var n,r=I(e,"a","notEqual"),o=I(t,"b","notEqual");return n=vt(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),W.runKernelFunc(function(a){return a.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),t5=B({notEqualStrict_:function(e,t){var n=I(e,"a","notEqualStrict"),r=I(t,"b","notEqualStrict");return Ke(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function S1(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function k1(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Vg=B({gather_:function(e,t,n){n===void 0&&(n=0);var r=I(e,"x","gather"),o=I(t,"indices","gather","int32");n=Lt(n,r.shape)[0];var a=function(i,s,u){for(var l=i.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(i.shape[h]),d*=i.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<i.rank;h++)c.push(i.shape[h]),f*=i.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return W.runKernelFunc(function(i,s){var u=i.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(i,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,n),f=d.length,h=l.slice(n,l.length).slice(1),p=h.length,m=S1(0,f),g=S1(f+1,f+1+p),v=k1([d,[c],h]),y=i.reshape(v),x=u.reshape([c]),w=k1([[f],m,g]),b=y.transpose(w),E=lS(b,x,r.shape[n]),S=Ig(w);return E=E.transpose(S)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),lS=B({unsortedSegmentSum_:function(e,t,n){var r=I(e,"x","unsortedSegmentSum"),o=I(t,"segmentIds","unsortedSegmentSum","int32");return P(Ct(n),function(){return"numSegments must be of dtype int"}),W.runKernelFunc(function(a,i){var s=a.unsortedSegmentSum(r,o,n);return i([o]),s},{$x:r},function(a,i){var s=i[0];return{$x:function(){return function(u,l){for(var c=Ug(l,je(l)),d=Vg(u,c),f=uS(l,ie(0,"int32")),h=d.rank-f.rank,p=0;p<h;++p)f=rr(f,p+1);f=Nf(f,Us(d.shape,"bool"));var m=je(d);return ci(f,d,m)}(a,s)}}})}}),n5=function(e,t,n){return de(this,void 0,void 0,function(){var r,o,a,i,s,u,l,c,d,f,h,p,m;return fe(this,function(g){switch(g.label){case 0:for(r=I(e,"tensor","boolMask"),o=I(t,"mask","boolMask","bool"),a=n??0,i=o.rank,s=r.shape,P(i>0,function(){return"mask cannot be scalar"}),Ke(s.slice(a,a+i),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+i;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+i)),d=r.reshape(c),f=o.reshape([-1]),[4,oS(f)];case 1:return h=g.sent(),p=h.squeeze([1]),m=Vg(d,p,a),e!==r&&r.dispose(),t!==o&&o.dispose(),p.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})};function cS(e,t,n,r,o,a,i){a===void 0&&(a="NHWC"),P(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),P(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),P(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),P(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],d=a==="NHWC"?u.shape[3]:u.shape[1];P(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),P(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),i!=null&&P(Ct(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var f=Fg(a),h=yi(s,n.shape,r,1,o,i,!1,f),p=W.runKernelFunc(function(m,g){var v=m.conv2dDerInput(u,n,h);return g([n,u]),v},{dy4D:u,filter:n},function(m,g){var v=g[0],y=g[1];return{dy4D:function(){return dr(m,v,r,o,a,1,i)},filter:function(){return Hg(m,y,v.shape,r,o,a,i)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Yh(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function dS(e,t,n,r,o){P(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,i=t,s=!1;t.rank===4&&(s=!0,i=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=i.shape[4];P(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),P(i.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+i.rank}),P(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),P(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),P(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Md(a,n.shape,r,1,o),d=W.runKernelFunc(function(f){return f.conv3dDerInput(i,n,c)},{dy5D:i});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var r5=B({conv1d_:function(e,t,n,r,o,a,i){o===void 0&&(o="NWC"),a===void 0&&(a=1);var s=I(e,"x","conv1d"),u=I(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),P(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),P(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),i!=null&&P(Ct(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}),P(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),P(Fn(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),P(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=dr(f,d,[1,n],r,"NHWC",[1,a],i);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),dr=B({conv2d_:function(e,t,n,r,o,a,i){o===void 0&&(o="NHWC"),a===void 0&&(a=[1,1]);var s=I(e,"x","conv2d"),u=I(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),P(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),P(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),i!=null&&P(Ct(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var d=o==="NHWC"?l.shape[3]:l.shape[1];P(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),P(Fn(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var f=Fg(o),h=yi(l.shape,u.shape,n,a,r,i,!1,f),p=[u,l],m=W.runKernelFunc(function(g,v){var y=g.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(g,v){var y=v,x=y[0],w=y[1];return P(Ms(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return fS(w.shape,g,x,n,r,o)},filter:function(){return Hg(w,g,x.shape,n,r,o)}}},"Conv2D",h,p);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),o5=B({conv3d_:function(e,t,n,r,o,a){o===void 0&&(o="NDHWC"),a===void 0&&(a=[1,1,1]);var i=I(e,"x","conv3d"),s=I(t,"filter","conv3d"),u=i,l=!1;i.rank===4&&(l=!0,u=i.as5D(1,i.shape[0],i.shape[1],i.shape[2],i.shape[3])),P(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),P(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),P(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),P(function(f,h){return Yh(f)||Yh(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),P(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Md(u.shape,s.shape,n,a,r),d=W.runKernelFunc(function(f,h){var p=f.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(f,h){P(Yh(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],m=h[1];return{x:function(){return dS(p.shape,f,m,n,r)},$filter:function(){return function(g,v,y,x,w){var b=g;g.rank===4&&(b=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var E=v;E.rank===4&&(E=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),P(b.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+b.shape+"."}),P(E.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+E.shape+"."}),P(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),P(b.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+b.shape[4]+") must match input depth in filter ("+y[3]+"."}),P(E.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+E.shape[4]+") must match output depth for filter ("+y[4]+")."});var S=Md(b.shape,y,x,1,w);return W.runKernelFunc(function(_){return _.conv3dDerFilter(b,E,S)},{x5D:b,dy5D:E})}(p,f,m.shape,n,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Hg=B({conv2dDerFilter_:function(e,t,n,r,o,a,i){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),P(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),P(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),P(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];P(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),P(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),i!=null&&P(Ct(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var d=Fg(a),f=yi(s.shape,n,r,1,o,i,!1,d);return W.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),fS=B({conv2dDerInput_:cS}),Df=B({depthwiseConv2d_:function(e,t,n,r,o,a,i){a===void 0&&(a=[1,1]);var s=I(e,"x","depthwiseConv2d"),u=I(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),P(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),P(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),P(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),P(Fn(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),i!=null&&P(Ct(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var d=yi(l.shape,u.shape,n,a,r,i,!0),f=[l,u],h=W.runKernelFunc(function(p,m){var g=p.depthwiseConv2D(l,u,d);return m([l,u]),g},{x:l,filter:u},function(p,m){P(Ms(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var g=m[0],v=m[1];return{x:function(){return hS(g.shape,p,v,d)},filter:function(){return pS(g,p,v.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),hS=B({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,a=!1;t.rank===3&&(a=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=W.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return a?i.as3D(i.shape[1],i.shape[2],i.shape[3]):i}}),pS=B({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),W.runKernelFunc(function(i){return i.depthwiseConv2DDerFilter(o,a,r)},{x4D:o,dy4D:a})}}),Gg=B({separableConv2d_:function(e,t,n,r,o,a,i){a===void 0&&(a=[1,1]),i===void 0&&(i="NHWC");var s=I(e,"x","separableConv2d"),u=I(t,"depthwiseFilter","separableConv2d"),l=I(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");P(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),P(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),P(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),P(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),P(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];P(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var p=Df(c,u,r,o,i,a),m=dr(p,l,1,"valid",i);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),a5=B({conv2dTranspose_:function(e,t,n,r,o,a){return cS(n,I(e,"x","conv2dTranspose"),I(t,"filter","conv2dTranspose"),r,o,"NHWC",a)}}),i5=B({conv3dTranspose_:function(e,t,n,r,o){return dS(n,I(e,"x","conv3dTranspose"),I(t,"filter","conv3dTranspose"),r,o)}}),If=B({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=I(e,"a","matMul"),i=I(t,"b","matMul");o=vt(a,i),a=o[0],i=o[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?i.shape[i.rank-1]:i.shape[i.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?i.shape[i.rank-2]:i.shape[i.rank-1],d=a.shape.slice(0,-2),f=i.shape.slice(0,-2),h=pe(d),p=pe(f);P(a.rank>=2&&i.rank>=2&&a.rank===i.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+i.rank+"."}),P(zt(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+a.shape+" and "+i.shape+" must match."}),P(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+i.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=a.shape.slice(0,-2).concat([l,c]),g=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?i.as3D(p,c,u):i.as3D(p,u,c),y={transposeA:n,transposeB:r};return W.runKernelFunc(function(x,w){var b=x.batchMatMul(g,v,n,r);return w([g,v]),b},{a:g,b:v},function(x,w){var b=w,E=b[0],S=b[1];return n||r?!n&&r?{a:function(){return x.matMul(S,!1,!1)},b:function(){return x.matMul(E,!0,!1)}}:n&&!r?{a:function(){return S.matMul(x,!1,!0)},b:function(){return E.matMul(x,!1,!1)}}:{a:function(){return S.matMul(x,!0,!0)},b:function(){return x.matMul(E,!0,!0)}}:{a:function(){return x.matMul(S,!1,!0)},b:function(){return E.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),s5=B({dot_:function(e,t){var n=I(e,"t1","dot"),r=I(t,"t2","dot");P(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return P(o===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),u5=B({outerProduct_:function(e,t){var n=I(e,"v1","outerProduct"),r=I(t,"v2","outerProduct");return P(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Tl=B({reverse_:function(e,t){var n=I(e,"x","reverse");if(n.rank===0)return n.clone();var r=Lt(t,n.shape);return W.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),l5=B({reverse1d_:function(e){var t=I(e,"x","reverse");return P(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Tl(t,0)}}),c5=B({reverse2d_:function(e,t){var n=I(e,"x","reverse");return P(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Tl(n,t)}}),d5=B({reverse3d_:function(e,t){var n=I(e,"x","reverse");return P(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Tl(n,t)}}),f5=B({reverse4d_:function(e,t){var n=I(e,"x","reverse");return P(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Tl(n,t)}});function vS(e,t,n,r,o,a){var i=I(e,"x","maxPool"),s=i,u=!1;i.rank===3&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),P(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),P(Fn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&P(Ct(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var l=al(s.shape,t,n,r,o,a);if(l.filterWidth===1&&l.filterHeight===1&&zt(l.inShape,l.outShape))return i.clone();var c=[s],d=W.runKernelFunc(function(f,h){var p=f.maxPool(s,l);return h([s,p]),p},{x:s},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,x,w,b,E,S){var _=I(g,"dy","maxPoolBackprop"),k=I(v,"input","maxPoolBackprop"),N=I(y,"output","maxPoolBackprop");P(k.rank===_.rank,function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+_.rank+")"}),P(Fn(w,b),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),P(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),P(k.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+k.rank+"."});var A=al(k.shape,x,w,b,E,S);return W.runKernelFunc(function(T){return T.maxPoolBackprop(_,k,N,A)},{$dy:_,$input:k})}(f,p,m,t,n,r,o)}}},"MaxPool",l,c);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function mS(e,t,n,r,o,a){var i=I(e,"x","avgPool","float32");P(Fn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=i,u=!1;i.rank===3&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),P(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&P(Ct(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var l=al(s.shape,t,n,r,o,a);if(l.filterWidth===1&&l.filterHeight===1&&zt(l.inShape,l.outShape))return i.clone();var c=W.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,h,p,m,g,v){var y=I(f,"dy","avgPoolBackprop"),x=I(h,"input","avgPoolBackprop");P(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),P(Fn(m,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"});var w=x,b=y,E=!1;x.rank===3&&(E=!0,w=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),P(b.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+b.rank+"."}),P(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var S=al(w.shape,p,m,g,v),_=W.runKernelFunc(function(k){return k.avgPoolBackprop(b,w,S)},{dy4D:b,input4D:w});return E?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(d,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(i.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Bt=B({maxPool_:function(e,t,n,r,o){return vS(e,t,n,1,r,o)}}),Pl=B({avgPool_:function(e,t,n,r,o){return mS(e,t,n,1,r,o)}}),h5=B({pool_:function(e,t,n,r,o,a){o==null&&(o=[1,1]),a==null&&(a=1),r===0&&(r="valid");var i=I(e,"x","maxPool"),s=i,u=!1;i.rank===3&&(u=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2])),P(Fn(a,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+o+"'"});var l,c=al(s.shape,t,a,o,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,b){var E=w.map(function(k,N){return k+(k-1)*(b[N]-1)}).map(function(k){return k-1}),S=E.map(function(k){return Math.floor(k/2)}),_=E.map(function(k,N){return k-S[N]});return E.map(function(k,N){return[S[N],_[N]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,b,E){var S=E.map(function(M){return M[0]}),_=E.map(function(M){return M[1]}),k=w.concat(S,_),N=b.map(function(M,$){return(M-k[$]%M)%M}),A=_.map(function(M,$){return M+N[$]}),T=b.map(function(M,$){return[S[$],A[$]]}),L=b.map(function(M,$){return[0,N[$]]});return[T,L]}([c.inHeight,c.inWidth],d,l),p=h[0],m=h[1],g=f?r:"valid",v=f?s:C_(s,d,p),y=(n==="avg"?function(){return mS(v,t,a,1,g)}:function(){return vS(v,t,a,1,g)})(),x=f?y:x_(y,d,m);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),p5=B({maxPool3d_:function(e,t,n,r,o,a,i){a===void 0&&(a="NDHWC");var s=I(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),i==null&&(i=[1,1,1]),P(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),P(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),P(Fn(n,i),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),o!=null&&P(Ct(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Ad(u.shape,t,n,i,r,o,a),d=W.runKernelFunc(function(f,h){var p=f.maxPool3d(u,c);return h([u,p]),p},{x:u},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(g,v,y,x,w,b,E,S){var _=I(g,"dy","maxPool3dBackprop"),k=I(v,"input","maxPool3dBackprop"),N=I(y,"output","maxPool3dBackprop"),A=_,T=k,L=N,M=!1;k.rank===4&&(M=!0,A=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),L=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3])),P(A.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+A.rank+"."}),P(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),P(L.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+L.rank+"."}),b==null&&(b=[1,1,1]),P(Fn(w,b),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),S!=null&&P(Ct(E),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+E+"."});var $=Ad(T.shape,x,w,b,E,S),U=W.runKernelFunc(function(j){return j.maxPool3dBackprop(A,T,L,$)},{dy5D:A,input5D:T});return M?U.as4D(U.shape[1],U.shape[2],U.shape[3],U.shape[4]):U}(f,p,m,t,n,i,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),v5=B({avgPool3d_:function(e,t,n,r,o,a,i){a===void 0&&(a="NDHWC");var s=I(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),i==null&&(i=[1,1,1]),P(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),P(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),P(Fn(n,i),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),o!=null&&P(Ct(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Ad(u.shape,t,n,i,r,o,a),d=W.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,p,m,g,v,y,x){var w=I(h,"dy","avgPool3dBackprop"),b=I(p,"input","avgPool3dBackprop"),E=w,S=b,_=!1;b.rank===4&&(_=!0,E=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),S=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),P(E.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+E.rank+"."}),P(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),v==null&&(v=[1,1,1]),P(Fn(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),x!=null&&P(Ct(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var k=Ad(S.shape,m,g,v,y,x),N=W.runKernelFunc(function(A){return A.avgPool3dBackprop(E,S,k)},{dy5D:E,input5D:S});return _?N.as4D(N.shape[1],N.shape[2],N.shape[3],N.shape[4]):N}(f,u,t,n,i,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),oo=B({slice_:function(e,t,n){var r,o,a=I(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){P(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(P(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),UL(a,r,o);var i=a.shape,s={begin:r,size:o};return W.runKernelFunc(function(u){return u.slice(a,r,o)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],i[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),m5=B({slice1d_:function(e,t,n){var r=I(e,"x","slice1d");return P(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,[t],[n])}}),g5=B({slice2d_:function(e,t,n){var r=I(e,"x","slice2d");return P(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}}),gS=B({slice3d_:function(e,t,n){var r=I(e,"x","slice3d");return P(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}}),y5=B({slice4d_:function(e,t,n){var r=I(e,"x","slice4d");return P(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),oo(r,t,n)}});function yS(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(Mn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Mn(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return o==null?a:a.transpose(o)}}}var x5=B({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","all","bool"),o=Lt(t,r.shape),a=o,i=uo(a,r.rank);i!=null&&(r=r.transpose(i),a=lo(a.length,r.rank));var s=W.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=Mn(s.shape,o);return s.reshape(u)}return s}}),w5=B({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","any","bool"),o=Lt(t,r.shape),a=o,i=uo(a,r.rank);i!=null&&(r=r.transpose(i),a=lo(a.length,r.rank));var s=W.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=Mn(s.shape,o);return s.reshape(u)}return s}}),b5=B({argMax_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","argMax");t==null&&(t=0);var r=Lt(t,n.shape),o=uo(r,n.rank);o!=null&&(n=n.transpose(o),r=lo(r.length,n.rank));var a={axis:r[0]},i=[n];return W.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return je(l)}}},"ArgMax",a,i)}}),C5=B({argMin_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","argMin");t==null&&(t=0);var r=Lt(t,n.shape),o=uo(r,n.rank);return o!=null&&(n=n.transpose(o),r=lo(r.length,n.rank)),W.runKernelFunc(function(a,i){var s=a.argMin(n,r[0]);return i([n]),s},{$x:n},function(a,i){var s=i[0];return{$x:function(){return je(s)}}})}}),E5=B({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","logSumExp"),o=Lt(t,r.shape),a=r.max(o,!0),i=r.sub(a).exp().sum(o).log(),s=a.reshape(i.shape).add(i);if(n){var u=Mn(s.shape,o);return s.reshape(u)}return s}}),Tf=B({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","max"),o=r,a=Lt(t,r.shape),i=a,s=uo(i,r.rank);s!=null&&(r=r.transpose(s),i=lo(i.length,r.rank));var u=[r],l=W.runKernelFunc(function(d,f){var h=d.max(r,i);return f([o,h]),h},{x:r},function(d,f){return yS(d,f[1],f[0],a,s)},"Max",{axes:i},u,[!0]);if(n){var c=Mn(l.shape,a);l=l.reshape(c)}return l}}),_5=B({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","mean"),o=Lt(t,r.shape),a=pe(nn(r.shape,o)[1]);return kf(function(i){var s=ie(a);return{value:(s.dtype===i.dtype?i:i.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=i.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(Us(i.shape,"float32")).div(a)}}})(r)}}),S5=B({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","min"),o=r,a=Lt(t,r.shape),i=a,s=uo(i,r.rank);s!=null&&(r=r.transpose(s),i=lo(i.length,r.rank));var u=[r],l=W.runKernelFunc(function(d,f){var h=d.min(r,i);return f([o,h]),h},{x:r},function(d,f){return yS(d,f[1],f[0],a,s)},"Min",{axes:i},u,[!0]);if(n){var c=Mn(l.shape,a);l=l.reshape(c)}return l}}),k5=B({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Lt(t,(e=I(e,"x","moments")).shape),o=e.mean(r,n),a=o.shape;n||(a=Mn(o.shape,r));var i=e.toFloat().sub(o.reshape(a)).square();return{mean:o,variance:i.mean(r,n)}}}),xS=B({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=Lt(t,r.shape);return kf(function(a){var i=uo(o,a.rank),s=o,u=a;i!=null&&(u=a.transpose(i),s=lo(s.length,a.rank));var l=function(h){var p=a.shape.slice();return o.forEach(function(m){p[m]=1}),h.reshape(p).mul(Us(a.shape,"float32"))},c={axes:s},d=W.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var f=Mn(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),R5=B({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=Lt(t,r.shape),a=uo(o,r.rank),i=o,s=r;a!=null&&(s=r.transpose(a),i=lo(i.length,r.rank));var u=W.runKernelFunc(function(c){return c.prod(s,i)},{permutedX:s});if(n){var l=Mn(u.shape,o);u=u.reshape(l)}return u}}),wS=B({elu_:function(e){var t=I(e,"x","elu");return W.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return W.runKernelFunc(function(a){return a.eluDer(n,o)},{dy:n,y:o})}}})}}),N5=B({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=I(e,"x","leakyRelu");return Ug(ie(t).mul(n),n)}}),bS=B({prelu_:function(e,t){var n=I(e,"x","prelu"),r=I(t,"alpha","prelu");return W.runKernelFunc(function(o,a){var i=o.prelu(n,r);return a([n,r]),i},{x:n,alpha:r},function(o,a){var i=a[0],s=a[1],u=i.greater(0);return{x:function(){return ci(u,o,o.mul(s))},alpha:function(){var l=ci(u,je(o),o.mul(i)),c=Ft(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),ft=B({relu_:function(e){var t=I(e,"x","relu");return t.dtype==="bool"?t.toInt():W.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),CS=B({relu6_:function(e){var t=I(e,"x","relu6");return t.dtype==="bool"?t.toInt():W.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],a=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),D5=B({selu_:function(e){var t=I(e,"x","selu");return W.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var a=o.greater(ie(0)),i=ie(Wg),s=ie(zg),u=n.mul(s),l=n.mul(i).mul(o.toFloat().exp());return ci(a,u,l)}}})}}),Na=B({transpose_:function(e,t){var n=I(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,a){return a}).reverse()),P(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){P(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return W.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var a=Ig(t);return{x:function(){return o.transpose(a)}}},"Transpose",r)}}),I5=B({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var a=I(e,"x","localResponseNormalization");P(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),P(Ct(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var i=a,s=!1;a.rank===3&&(s=!0,i=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=W.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(i,t,n,r,o);return c([i,d]),d},{x4D:i},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return W.runKernelFunc(function(h){return h.LRNGrad(l,d,f,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),ES=B({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ie(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=I(e,"x","norm"),t,n),a=o.shape;if(r){var i=Lt(n,e.shape);a=Mn(o.shape,i)}return o.reshape(a)}}),T5=B({basicLSTMCell_:function(e,t,n,r,o,a){var i=I(e,"forgetBias","basicLSTMCell"),s=I(t,"lstmKernel","basicLSTMCell"),u=I(n,"lstmBias","basicLSTMCell"),l=I(r,"data","basicLSTMCell"),c=I(o,"c","basicLSTMCell"),d=I(a,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),h=f.shape[0],p=f.shape[1]/4,m=[h,p],g=f.slice([0,0],m),v=f.slice([0,p],m),y=f.slice([0,2*p],m),x=f.slice([0,3*p],m),w=g.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(i.add(y).sigmoid())),b=w.tanh().mulStrict(x.sigmoid());return[w,b]}}),P5=B({multiRNNCell_:function(e,t,n,r){for(var o=I(t,"data","multiRNNCell"),a=Rd(n,"c","multiRNNCell"),i=Rd(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],i[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),A5=B({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var a=I(e,"v","movingAverage"),i=I(t,"x","movingAverage"),s=I(n,"decay","movingAverage");IO(a,i),P(zt(a.shape,i.shape),function(){return"Shape mismatch in v and x"});var u=ie(1),l=u.sub(s),c=i.sub(a).mul(l);if(o){P(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=I(r,"step","movingAverage");c=c.div(u.sub(Ld(s,d)))}return a.add(c)}}),M5=B({stridedSlice_:function(e,t,n,r,o,a,i,s,u){if(o===void 0&&(o=0),a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),i!==0)throw new Error("ellipsis mask is not yet supported");var l=I(e,"x","stridedSlice"),c=a1(s),d=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,d.splice(g,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)t[f]=VL(o,t,r,l.shape,f),n[f]=HL(a,n,r,l.shape,f),r[f]=r[f]||1;var h=a1(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var p=Mg(t,n,r),m=p.filter(function(g,v){return h.indexOf(v)===-1});return r.every(function(g){return g===1})?oo(l,t,p).reshape(m):W.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(m)}}),F5=B({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=I(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var a=W.runKernelFunc(function(i){return i.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),O5=B({scatterND_:function(e,t,n){var r=I(e,"indices","scatterND","int32"),o=I(t,"updates","scatterND");return $L(o,r,n),W.runKernelFunc(function(a){return a.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),qg=B({fft_:function(e){P(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return W.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),Bd=B({ifft_:function(e){P(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return W.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Kg=B({rfft_:function(e,t){P(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),i=e.shape.map(function(v){return v});i[e.shape.length-1]=t,n=e.slice(a,i),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(st(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Ht(n,u).as2D(o,r),c=qg(l),d=Math.floor(r/2)+1,f=or(c),h=Kr(c),p=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Ht(p[0],m[0]).reshape(g)}}),_S=B({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Bd(r);return or(o)}var a=[n,2*(t-1)],i=or(e).as2D(n,t),s=Kr(e).as2D(n,t),u=i.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ie(-1)),c=i.concat(u,1),d=s.concat(l,1);return r=Ht(c,d).as2D(a[0],a[1]),o=Bd(r),or(o)}}),L5=Object.freeze({fft:qg,ifft:Bd,rfft:Kg,irfft:_S}),B5=B({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=I(e,"sparseIndices","sparseToDense","int32"),a=I(t,"sparseValues","sparseToDense"),i=I(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,a,n,i),W.runKernelFunc(function(s){return s.sparseToDense(o,a,n,i)},{$sparseIndices:o,$sparseValues:a,$defaultValue:i})}}),j5=B({gatherND_:function(e,t){var n=I(t,"indices","gatherND","int32"),r=I(e,"x","gatherND");return W.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),W5=B({diag_:function(e){var t=I(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return W.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),z5=B({dropout_:function(e,t,n,r){var o=I(e,"x","dropout");if(P(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),P(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof dt?o.clone():o;var a=function(u,l){if(l==null)return u.shape.slice();if(zt(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(o,n),i=1-t,s=b_(a,0,1,"float32",r).add(i).floor().div(i);return o.mul(s)}});function SS(e,t,n){for(var r=1-e%2,o=new Float32Array(e),a=0;a<e;++a){var i=2*Math.PI*a/(e+r-1);o[a]=t-n*Math.cos(i)}return kt(o,"float32")}var Yg=B({hannWindow_:function(e){return SS(e,.5,.5)}}),kS=B({hammingWindow_:function(e){return SS(e,.54,.46)}}),Xg=B({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var a=0,i=[];a+t<=e.size;)i.push(oo(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=At([oo(e,a,t-s),no([s],o)]);i.push(u),a+=n}return i.length===0?ya([],[0,t]):At(i).as2D(i.length,t)}}),RS=B({stft_:function(e,t,n,r,o){var a;o===void 0&&(o=Yg),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var i=Xg(e,t,n),s=un(i,o(t)),u=[],l=0;l<i.shape[0];l++)u.push(Kg(s.slice([l,0],[1,t]),r));return At(u)}}),$5=Object.freeze({hannWindow:Yg,hammingWindow:kS,frame:Xg,stft:RS}),sn,U5=function(e,t,n){return n===void 0&&(n=1),de(this,void 0,void 0,function(){var r,o,a,i,s,u,l,c,d,f,h,p,m,g;return fe(this,function(v){switch(v.label){case 0:return r=I(e,"predictions","inTopK"),o=I(t,"targets","inTopK"),P(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),P(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Ke(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],P(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return i=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[i.length/a,a],c=u[1],d=nl("bool",l=u[0]),f=0;f<l;f++){for(h=f*c,p=i.subarray(h,h+c),m=[],g=0;g<p.length;g++)m.push({value:p[g],index:g});for(m.sort(function(y,x){return x.value-y.value}),d[f]=0,g=0;g<n;g++)if(m[g].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,qt(d,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(sn||(sn={}));var V5=B({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=sn.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","absoluteDifference"),a=I(t,"predictions","absoluteDifference"),i=null;n!=null&&(i=I(n,"weights","absoluteDifference")),Ke(o.shape,a.shape,"Error in absoluteDifference: ");var s=o.sub(a).abs();return Fo(s,i,r)}}),Fo=B({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=sn.SUM_BY_NONZERO_WEIGHTS);var r=I(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=I(t,"weights","computeWeightedLoss"));var a=o==null?r:r.mul(o);if(n===sn.NONE)return a;if(n===sn.SUM)return a.sum();if(n===sn.MEAN){if(o==null)return a.mean();var i=r.size/o.size,s=a.sum().div(o.sum());return i>1?s.div(ie(i)):s}if(n===sn.SUM_BY_NONZERO_WEIGHTS){if(o==null)return a.sum().div(ie(r.size));var u=o.mul(Us(r.shape)).notEqual(ie(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),H5=B({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=sn.SUM_BY_NONZERO_WEIGHTS);var a=I(e,"labels","cosineDistance"),i=I(t,"predictions","cosineDistance"),s=null;r!=null&&(s=I(r,"weights","cosineDistance")),Ke(a.shape,i.shape,"Error in cosineDistance: ");var u=ie(1).sub(a.mul(i).sum(n,!0));return Fo(u,s,o)}}),G5=B({hingeLoss_:function(e,t,n,r){r===void 0&&(r=sn.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","hingeLoss"),a=I(t,"predictions","hingeLoss"),i=null;n!=null&&(i=I(n,"weights","hingeLoss")),Ke(o.shape,a.shape,"Error in hingeLoss: ");var s=ie(1);o=ie(2).mul(o).sub(s);var u=s.sub(o.mul(a)).relu();return Fo(u,i,r)}}),q5=B({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=sn.SUM_BY_NONZERO_WEIGHTS);var a=I(e,"labels","huberLoss"),i=I(t,"predictions","huberLoss"),s=null;n!=null&&(s=I(n,"weights","huberLoss")),Ke(a.shape,i.shape,"Error in huberLoss: ");var u=ie(r),l=i.sub(a).abs(),c=iS(l,u),d=l.sub(c),f=ie(.5).mul(c.square()).add(u.mul(d));return Fo(f,s,o)}}),K5=B({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=sn.SUM_BY_NONZERO_WEIGHTS);var a=I(e,"labels","logLoss"),i=I(t,"predictions","logLoss"),s=null;n!=null&&(s=I(n,"weights","logLoss")),Ke(a.shape,i.shape,"Error in logLoss: ");var u=ie(1),l=ie(r),c=a.mul(i.add(l).log()).neg().sub(u.sub(a).mul(u.sub(i).add(l).log()));return Fo(c,s,o)}}),Y5=B({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=sn.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","meanSquaredError"),a=I(t,"predictions","meanSquaredError"),i=null;n!=null&&(i=I(n,"weights","meanSquaredError")),Ke(o.shape,a.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(a);return Fo(s,i,r)}}),X5=B({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=sn.SUM_BY_NONZERO_WEIGHTS);var a=I(e,"multiClassLabels","sigmoidCrossEntropy"),i=I(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=I(n,"weights","sigmoidCrossEntropy")),Ke(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ie(r),l=ie(1),c=ie(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var p=I(f,"labels","sigmoidCrossEntropyWithLogits"),m=I(h,"logits","sigmoidCrossEntropyWithLogits");Ke(p.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=m.relu(),v=m.mul(p),y=m.abs().neg().exp().log1p();return g.sub(v).add(y)}(a,i);return Fo(d,s,o)}}),Q5=B({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=sn.SUM_BY_NONZERO_WEIGHTS);var a=I(e,"onehotLabels","softmaxCrossEntropy"),i=I(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=I(n,"weights","softmaxCrossEntropy")),Ke(a.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ie(r),l=ie(1),c=ie(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return kf(function(m,g,v){var y=g.logSumExp([p],!0),x=g.toFloat().sub(y);return v([m,x]),{value:x.mul(m).neg().sum([p]),gradFunc:function(w,b){var E=b[0],S=b[1],_=Mn(w.shape,[p]);return[w.reshape(_).mul(E.toFloat().sub(S.exp())),w.reshape(_).mul(S.exp().sub(E.toFloat()))]}}})(f,h)}(a,i);return Fo(d,s,o)}}),J5=Object.freeze({get Reduction(){return sn},absoluteDifference:V5,computeWeightedLoss:Fo,cosineDistance:H5,hingeLoss:G5,huberLoss:q5,logLoss:K5,meanSquaredError:Y5,sigmoidCrossEntropy:X5,softmaxCrossEntropy:Q5});function R1(e,t){return t===void 0&&(t=!1),W.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=w_(n),a=e.clone(),i=ya([[1]],[1,1]),s=i.clone(),u=n>=r?r:n,l=function(d){var f,h=a,p=s,m=o;f=W.tidy(function(){var g=a.slice([d,d],[n-d,1]),v=g.norm(),y=a.slice([d,d],[1,1]),x=ya([[-1]]).where(y.greater(0),ya([[1]])),w=y.sub(x.mul(v)),b=g.div(w);s=b.shape[0]===1?i.clone():i.concat(b.slice([1,0],[b.shape[0]-1,b.shape[1]]),0);var E=x.matMul(w).div(v).neg(),S=a.slice([d,0],[n-d,r]),_=E.mul(s);if(d===0)a=S.sub(_.matMul(s.transpose().matMul(S)));else{var k=S.sub(_.matMul(s.transpose().matMul(S)));a=a.slice([0,0],[d,r]).concat(k,0)}var N=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=N.sub(N.matMul(s).matMul(_.transpose()));else{var A=N.sub(N.matMul(s).matMul(_.transpose()));o=o.slice([0,0],[n,d]).concat(A,1)}return[s,a,o]}),s=f[0],a=f[1],o=f[2],An([h,p,m])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[o,a]})}var Z5=B({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=I(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,a=r.shape.slice(-2),i=a[0],s=a[1];if(!(t<=i))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+i+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=i),n<0&&(n=s);var u=Nd(0,i,1,"int32").reshape([-1,1]),l=Nd(0,s,1,"int32"),c=Ot(u,l),d=Nf(c.lessEqual(ie(+t,"int32")),c.greaterEqual(ie(-n,"int32"))),f=st([i,s],r.dtype);return Yn(Mt(r.reshape([-1,i,s])).map(function(h){return ci(d,h,f)})).reshape(o)}}),e6=B({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,P(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){P(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=Pg(e,e.shape[0],0).map(function(u){return E_(u,[0])});P(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],i=e,s=function(u){a.push(W.tidy(function(){var l=i[u];if(u>0)for(var c=0;c<u;++c){var d=xS(a[c].mulStrict(l)).mul(a[c]);l=l.sub(d)}return l.div(ES(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?Yn(a,0):a}}),t6=B({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return R1(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(i,s){return i*s}),r=Mt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],a=[];return r.forEach(function(i){var s=R1(i,t),u=s[0],l=s[1];o.push(u),a.push(l)}),[Yn(o,0).reshape(e.shape),Yn(a,0).reshape(e.shape)]}}),n6=Object.freeze({bandPart:Z5,gramSchmidt:e6,qr:t6});function Pf(e,t,n,r,o,a){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),a==null&&(a=0);var i=e.shape[0];return n=Math.min(n,i),P(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),P(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),P(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),P(t.rank===1,function(){return"scores must be a 1D tensor"}),P(t.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", but was "+t.shape[0]}),P(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:a}}var r6=B({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=I(e,"images","resizeBilinear");P(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),P(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,a=!1;r.rank===3&&(a=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t[0],s=t[1],u=W.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,i,s,n)},{x:o},function(l,c){return{x:function(){return W.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:i,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),o6=B({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=I(e,"images","resizeNearestNeighbor");P(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),P(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),P(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,a=!1;r.rank===3&&(a=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t[0],s=t[1],u=W.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,i,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return W.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),a6=B({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var a=I(e,"boxes","nonMaxSuppression"),i=I(t,"scores","nonMaxSuppression"),s=Pf(a,i,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return W.runKernelFunc(function(l){return l.nonMaxSuppression(a,i,n,r,o)},{boxes:a,scores:i},null,"NonMaxSuppressionV3",u)}}),i6=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),de(this,void 0,void 0,function(){var a,i,s,u,l,c,d;return fe(this,function(f){switch(f.label){case 0:return a=I(e,"boxes","nonMaxSuppressionAsync"),i=I(t,"scores","nonMaxSuppressionAsync"),s=Pf(a,i,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([a.data(),i.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=Og(l,c,n,r,o),a!==e&&a.dispose(),i!==t&&i.dispose(),[2,d]}})})},s6=B({nonMaxSuppressionWithScore_:function(e,t,n,r,o,a){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var i=I(e,"boxes","nonMaxSuppression"),s=I(t,"scores","nonMaxSuppression"),u=Pf(i,s,n,r,o,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=W.runKernel("NonMaxSuppressionV5",{boxes:i,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),u6=function(e,t,n,r,o,a){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),de(this,void 0,void 0,function(){var i,s,u,l,c,d,f;return fe(this,function(h){switch(h.label){case 0:return i=I(e,"boxes","nonMaxSuppressionAsync"),s=I(t,"scores","nonMaxSuppressionAsync"),u=Pf(i,s,n,r,o,a),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([i.data(),s.data()])];case 1:return l=h.sent(),c=l[0],d=l[1],f=Lg(c,d,n,r,o,a),i!==e&&i.dispose(),s!==t&&s.dispose(),[2,f]}})})},l6=B({cropAndResize_:function(e,t,n,r,o,a){var i=I(e,"image","cropAndResize"),s=I(t,"boxes","cropAndResize","float32"),u=I(n,"boxInd","cropAndResize","int32");o=o||"bilinear",a=a||0;var l=s.shape[0];return P(i.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+i.rank+"."}),P(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),P(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),P(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),P(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),P(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),W.runKernelFunc(function(c,d){return c.cropAndResize(i,s,u,r,o,a)},{images:i,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:a,cropSize:r})}}),Qg=Object.freeze({resizeBilinear:r6,resizeNearestNeighbor:o6,nonMaxSuppression:a6,nonMaxSuppressionAsync:i6,nonMaxSuppressionWithScore:s6,nonMaxSuppressionWithScoreAsync:u6,cropAndResize:l6}),Jg=function(e,t){return!(e>0)||t==="linear"},Zg=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},ey=function(e,t){var n=t,r=Ft(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},ty=function(e,t,n){if(t==="linear")return e;if(t==="relu")return ft(e);if(t==="elu")return wS(e);if(t==="relu6")return CS(e);if(t==="prelu")return bS(e,n);throw new Error("Unknown fused activation "+t+".")},c6=B({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,a=o!==void 0&&o,i=e.transposeB,s=i!==void 0&&i,u=e.bias,l=e.activation,c=l===void 0?"linear":l,d=e.preluActivationWeights;if(Jg(W.state.gradientDepth,c)===!1){var f=If(n,r,a,s);return u!=null&&(f=Me(f,u)),ty(f,c,d)}var h=I(n,"a","fused matMul"),p=I(r,"b","fused matMul");t=vt(h,p),h=t[0],p=t[1];var m=a?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],x=h.shape.slice(0,-2),w=p.shape.slice(0,-2),b=pe(x),E=pe(w);P(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),P(zt(x,w),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+w+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),P(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var S,_,k=h.shape.slice(0,-2).concat([v,y]),N=a?h.as3D(b,m,v):h.as3D(b,v,m),A=s?p.as3D(E,y,g):p.as3D(E,g,y);u!=null&&Fe(k,(S=vt(S=I(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(_=I(d,"prelu weights","fused matMul"));var T={a:N,b:A};u!=null&&(T.bias=S),d!=null&&(T.preluActivationWeights=_);var L=[N,A];return W.runKernelFunc(function(M,$){var U=M.fusedBatchMatMul({a:N,b:A,transposeA:a,transposeB:s,bias:S,activation:c,preluActivationWeights:_});return $([N,A,U]),U},T,function(M,$){var U=$[0],j=$[1],D=$[2],F=Zg(M,D,c),z={};return u!=null&&(z={bias:function(){return ey(S,F)}}),Object.assign(a||s?!a&&s?{a:function(){return F.matMul(j,!1,!1)},b:function(){return F.matMul(U,!0,!1)}}:a&&!s?{a:function(){return j.matMul(F,!1,!0)},b:function(){return U.matMul(F,!1,!1)}}:{a:function(){return j.matMul(F,!0,!0)},b:function(){return F.matMul(U,!0,!0)}}:{a:function(){return F.matMul(j,!1,!0)},b:function(){return U.matMul(F,!0,!1)}},z)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},L,[!0]).reshape(k)}}),d6=B({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,a=e.dataFormat,i=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",Jg(W.state.gradientDepth,f)===!1){var p=dr(t,n,r,o,i,u,l);return c!=null&&(p=Me(p,c)),ty(p,f,h)}var m=I(t,"x","conv2d"),g=I(n,"filter","conv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),P(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),P(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&P(Ct(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),P(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),P(Fn(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),P(i==="NHWC",function(){return"Error in conv2d: got dataFormat of "+i+" but only NHWC is currently supported."});var x,w,b=yi(v.shape,g.shape,r,u,o,l);c!=null&&(x=vt(x=I(c,"bias","fused conv2d"),m)[0],Fe(b.outShape,x.shape)),h!=null&&(w=I(h,"prelu weights","fused conv2d"));var E={x:v,filter:g};c!=null&&(E.bias=x),h!=null&&(E.preluActivationWeights=w);var S=[g,v],_=W.runKernelFunc(function(k,N){var A=k.fusedConv2d({input:v,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return N([g,v,A]),A},E,function(k,N){var A=N,T=A[0],L=A[1],M=A[2],$=Zg(k,M,f);P(Ms(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var U={};return c!=null&&(U={bias:function(){return ey(x,$)}}),Object.assign({x:function(){return fS(L.shape,$,T,r,o)},filter:function(){return Hg(L,$,T.shape,r,o)}},U)},"FusedConv2D",{convInfo:b,activation:f},S,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),f6=B({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,a=e.dataFormat,i=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(Jg(W.state.gradientDepth,f)===!1){var p=Df(t,n,r,o,i,u,l);return c!=null&&(p=Me(p,c)),ty(p,f,h)}var m=I(t,"x","depthwiseConv2d"),g=I(n,"filter","depthwiseConv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),P(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),P(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),P(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),P(Fn(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&P(Ct(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var x,w,b=yi(v.shape,g.shape,r,u,o,l,!0);c!=null&&(x=vt(x=I(c,"bias","fused conv2d"),m)[0],Fe(b.outShape,x.shape)),h!=null&&(w=I(h,"prelu weights","fused depthwiseConv2d"));var E={x:v,filter:g};c!=null&&(E.bias=x),h!=null&&(E.preluActivationWeights=w);var S=[g,v],_=W.runKernelFunc(function(k,N){var A=k.fusedDepthwiseConv2D({input:v,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return N([g,v,A]),A},E,function(k,N){P(Ms(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var A=N[0],T=N[1],L=N[2],M=Zg(k,L,f),$={};return c!=null&&($={bias:function(){return ey(x,M)}}),Object.assign({x:function(){return hS(T.shape,M,A,b)},filter:function(){return pS(T,M,A.shape,b)}},$)},"FusedDepthwiseConv2D",{convInfo:b,activation:f},S,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),h6=Object.freeze({matMul:c6,conv2d:d6,depthwiseConv2d:f6}),p6=Object.freeze({image:Qg,linalg:n6,losses:J5,spectral:L5,fused:h6,signal:$5,square:Kj,squaredDifference:X_,conv1d:r5,conv2d:dr,conv3d:o5,depthwiseConv2d:Df,separableConv2d:Gg,conv2dTranspose:a5,conv3dTranspose:i5,op:B,batchNormalization2d:_W,batchNormalization3d:SW,batchNormalization4d:kW,batchNormalization:RW,batchNorm:nS,batchNorm2d:NW,batchNorm3d:DW,batchNorm4d:IW,booleanMaskAsync:n5,complex:Ht,real:or,imag:Kr,concat:At,concat1d:hL,concat2d:pL,concat3d:vL,concat4d:mL,split:Pg,matMul:If,dot:s5,outerProduct:u5,reverse:Tl,reverse1d:l5,reverse2d:c5,reverse3d:d5,reverse4d:f5,maxPool:Bt,avgPool:Pl,pool:h5,maxPool3d:p5,avgPool3d:v5,slice:oo,slice1d:m5,slice2d:g5,slice3d:gS,slice4d:y5,abs:Yj,acos:Xj,acosh:Qj,asin:Jj,asinh:Zj,atan:eW,atanh:tW,ceil:nW,clipByValue:$g,cos:rW,cosh:oW,erf:aW,exp:Wv,expm1:iW,floor:sW,log:uW,log1p:lW,logSigmoid:cW,neg:Od,reciprocal:dW,round:fW,rsqrt:Q_,sigmoid:J_,sign:hW,isNaN:pW,isInf:vW,isFinite:mW,sin:gW,sinh:yW,softplus:xW,sqrt:wW,step:bW,tan:CW,tanh:EW,all:x5,any:w5,argMax:b5,argMin:C5,logSumExp:E5,max:Tf,mean:_5,min:S5,moments:k5,sum:xS,prod:R5,equal:sS,equalStrict:GW,greater:qW,greaterEqual:uS,greaterEqualStrict:KW,greaterStrict:YW,less:XW,lessEqual:QW,lessEqualStrict:JW,lessStrict:ZW,notEqual:e5,notEqualStrict:t5,add:Me,addN:AW,addStrict:MW,atan2:FW,div:xr,divNoNan:OW,divStrict:LW,floorDiv:aS,maximum:Ug,maximumStrict:BW,minimum:iS,minimumStrict:jW,mod:WW,modStrict:zW,mul:un,mulStrict:$W,pow:Ld,powStrict:UW,squaredDifferenceStrict:VW,sub:Ot,subStrict:HW,elu:wS,leakyRelu:N5,prelu:bS,relu:ft,relu6:CS,selu:D5,logicalAnd:Nf,logicalNot:TW,logicalOr:rS,logicalXor:PW,where:ci,whereAsync:oS,buffer:Re,print:SL,batchToSpaceND:x_,broadcastTo:kL,cast:RL,clone:NL,cumsum:DL,depthToSpace:IL,expandDims:rr,eye:w_,multinomial:TL,oneHot:Ov,pad:gi,pad1d:PL,pad2d:AL,pad3d:ML,pad4d:FL,rand:OL,randomNormal:LL,randomGamma:BL,randomUniform:b_,reshape:Cr,spaceToBatchND:C_,squeeze:E_,stack:Yn,tile:os,truncatedNormal:jL,unstack:Mt,setdiff1dAsync:WL,fill:no,linspace:fL,ones:Us,range:Nd,scalar:ie,tensor:qt,tensor1d:kt,tensor2d:ya,tensor3d:Tg,tensor4d:_n,tensor5d:lL,tensor6d:cL,variable:dL,zeros:st,onesLike:y_,zerosLike:je,transpose:Na,softmax:Mo,logSoftmax:qL,localResponseNormalization:I5,norm:ES,gather:Vg,unsortedSegmentSum:lS,basicLSTMCell:T5,multiRNNCell:P5,movingAverage:A5,stridedSlice:M5,topk:F5,scatterND:O5,fft:qg,ifft:Bd,rfft:Kg,irfft:_S,sparseToDense:B5,gatherND:j5,diag:W5,dropout:z5,hannWindow:Yg,hammingWindow:kS,frame:Xg,stft:RS,inTopKAsync:U5});function J(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&P(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Xh(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var v6=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new I_(n,W),n}return Pr(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,Y().get("IS_NODE")&&kd(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:o}),a},t.prototype.move=function(n,r,o,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,a=r.complexTensors;return o==="complex64"?jv(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(a){return Ed(a)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Re(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var a=this.write(n,r,o);return W.makeTensorFromDataId(a,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return de(this,void 0,void 0,function(){var r;return fe(this,function(o){return r=Hr(),n(),[2,{kernelMs:Hr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:W.keep(n.clone()),imag:W.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(J(n,"slice"),N_(n.shape,r,o)){var a=D_(r,n.strides),i=pe(o);return qt(this.readSync(n.dataId).subarray(a,a+i),o,n.dtype)}for(var s=Re(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,a){J(n,"stridedSlice");var i=Mg(r,o,a);if(i.some(function(h){return h===0}))return qt([],i);for(var s=Re(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*a[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Re([n.size,n.size],n.dtype),a=o.values,i=0;i<r.length;i++)a[i*n.size+i]=r[i];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],a=new Array(n.rank-1),i=0,s=0;s<n.rank;s++)s!==r&&(a[i++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){J(n,"reverse");for(var o=Re(n.shape,n.dtype),a=this.bufferSync(n),i=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[a.get.apply(a,c)].concat(l))},s=0;s<o.size;s++)i(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return or(h)}),i=n.map(function(h){return Kr(h)});return Ht(this.concat(a,r),this.concat(i,r))}var s=n.map(function(h){var p=pe(h.shape.slice(r));return h.as2D(-1,p)}),u=As(s.map(function(h){return h.shape}),1),l=Re(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var p=o.readSync(h.dataId),m=0,g=0;g<h.shape[0];++g)for(var v=g*u[1]+d,y=0;y<h.shape[1];++y)l[v+y]=p[m++];d+=h.shape[1]})}var f=As(n.map(function(h){return h.shape}),r);return qt(l,f,n[0].dtype)},t.prototype.neg=function(n){return J(n,"neg"),this.multiply(ie(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,a,i,s){return{real:o+i,imag:a+s}}):this.broadcastedBinaryOp(n,r,Gt(n.dtype,r.dtype),function(o,a){return o+a})},t.prototype.addN=function(n){var r=this;J(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),a=Re(n[0].shape,n[0].dtype),i=a.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<i.length;l++)i[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var o=Lt([r],n.shape),a=this.max(n,o),i=Mn(a.shape,o),s=this.subtract(n,a.reshape(i)),u=this.exp(s),l=this.sum(u,o).reshape(i);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,a,i,s){return{real:o-i,imag:a-s}}):this.broadcastedBinaryOp(n,r,Gt(n.dtype,r.dtype),function(o,a){return o-a})},t.prototype.pow=function(n,r){return J([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){return Math.pow(o,a)})},t.prototype.batchMatMul=function(n,r,o,a){J([n,r],"matMul");for(var i=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],p=f[1],m=f[2],g=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],x=g[2],w=s*u,b=Re([l,s,u],n.dtype),E=b.values,S=this.blockSize,_=0;_<l;_++)for(var k=0;k<s;k+=S)for(var N=0;N<u;N+=S)for(var A=0;A<i;A+=S)for(var T=Math.min(k+S,s),L=Math.min(N+S,u),M=Math.min(A+S,i),$=k;$<T;$++)for(var U=N;U<L;U++){for(var j=0,D=A;D<M;D++)j+=c[_*h+$*p+D*m]*d[D*v+U*y+_*x];E[_*w+($*u+U)]+=j}return b.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,a=n.transposeA,i=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,a,i);return s&&(c=this.add(c,s)),u&&(c=Xh(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,a,i,s){return{real:o*i-a*s,imag:o*s+a*i}}):this.broadcastedBinaryOp(n,r,Gt(n.dtype,r.dtype),function(o,a){return o*a})},t.prototype.realDivide=function(n,r){return J([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,a){return o/a})},t.prototype.floorDiv=function(n,r){return J([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,a){return Math.floor(o/a)})},t.prototype.sum=function(n,r){J(n,"sum"),jn("sum",r,n.rank);for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,Gt(n.dtype,"int32")),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,p=0;p<u;++p)h+=c[f+p];l[d]=h}return s},t.prototype.prod=function(n,r){J(n,"sum");for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,Gt(n.dtype,"int32")),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,p=0;p<u;++p)h*=c[f+p];l[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){J(n,"unsortedSegmentSum");for(var a=[],i=n.rank-r.rank,s=0;s<i;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ie(s,"int32"),l=sS(u,r).asType("float32").mul(n).sum(0);a.push(l)}return Yn(a)},t.prototype.argMin=function(n,r){J(n,"argMin");var o=[r];jn("argMin",o,n.rank);for(var a=nn(n.shape,o),i=a[0],s=a[1],u=st(i,"int32"),l=pe(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,g=0;g<l;++g){var v=d[h+g];v<p&&(p=v,m=g)}c[f]=m}return u},t.prototype.argMax=function(n,r){J(n,"argMax");var o=[r];jn("argMax",o,n.rank);for(var a=nn(n.shape,o),i=a[0],s=a[1],u=st(i,"int32"),l=pe(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,g=0;g<l;++g){var v=d[h+g];v>p&&(p=v,m=g)}c[f]=m}return u},t.prototype.cumsum=function(n,r,o,a){if(J(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var i=Gt(n.dtype,"int32"),s=st(n.shape,i),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],d=a?function(g,v){return g+c-v-1}:function(g,v){return g+v},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var p=d(f,h);if(h===0)u[p]=o?0:l[p];else{var m=d(f,h-1);u[p]=o?l[m]+u[m]:l[p]+u[m]}}return s},t.prototype.equal=function(n,r){return J([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o===a?1:0})},t.prototype.notEqual=function(n,r){return J([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o!==a?1:0})},t.prototype.less=function(n,r){return J([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o<a?1:0})},t.prototype.lessEqual=function(n,r){return J([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o<=a?1:0})},t.prototype.greater=function(n,r){return J([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o>a?1:0})},t.prototype.greaterEqual=function(n,r){return J([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o>=a?1:0})},t.prototype.logicalNot=function(n){J(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),a=0;a<r.length;++a)o[a]=r[a]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return J([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o&&a})},t.prototype.logicalOr=function(n,r){return J([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,a){return o||a})},t.prototype.select=function(n,r,o){J([n,r,o],"select");for(var a=this.readSync(n.dataId),i=this.readSync(r.dataId),s=this.readSync(o.dataId),u=st(r.shape,Gt(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:pe(r.shape.slice(1)),f=0;f<a.length;f++)for(var h=0;h<d;h++)a[f]===1?l[c++]=i[f]:l[c++]=s[f];return u},t.prototype.where=function(n){J([n],"where");var r=this.readSync(n.dataId);return Bg(n.shape,r)},t.prototype.topk=function(n,r,o){return J(n,"topk"),B_(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){J(n,"min"),jn("min",r,n.rank);for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,n.dtype),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m<h&&(h=m)}l[d]=h}return s},t.prototype.minimum=function(n,r){return J([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){return Math.min(o,a)})},t.prototype.mod=function(n,r){return J([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){var i=o%a;return o<0&&a<0||o>=0&&a>=0?i:(i+a)%a})},t.prototype.max=function(n,r){J(n,"max"),jn("max",r,n.rank);for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,n.dtype),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m>h&&(h=m)}l[d]=h}return s},t.prototype.maximum=function(n,r){return J([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){return Math.max(o,a)})},t.prototype.all=function(n,r){J(n,"all"),jn("all",r,n.rank);for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,n.dtype),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];h=h&&m}l[d]=h}return s},t.prototype.any=function(n,r){J(n,"any"),jn("any",r,n.rank);for(var o=nn(n.shape,r),a=o[0],i=o[1],s=st(a,n.dtype),u=pe(i),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];h=h||m}l[d]=h}return s},t.prototype.squaredDifference=function(n,r){return J([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){var i=o-a;return i*i})},t.prototype.ceil=function(n){J(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)o[a]=Math.ceil(r[a]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){J(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)o[a]=Math.floor(r[a]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){J(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?o[a]=-1:r[a]>0?o[a]=1:o[a]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){J(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(o[a]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){J(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(o[a]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){J(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(o[a]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){J(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a){var i=Math.floor(r[a]);r[a]-i<.5?o[a]=Math.floor(r[a]):r[a]-i>.5?o[a]=Math.ceil(r[a]):o[a]=i%2==0?i:i+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){J(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)o[a]=Math.exp(r[a]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){J(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)o[a]=Math.expm1(r[a]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){J(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a){var i=r[a];o[a]=Math.log(i)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){J(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a){var i=r[a];o[a]=Math.log1p(i)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){J(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a){var i=r[a];o[a]=Math.sqrt(i)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){J(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a){var i=r[a];o[a]=1/Math.sqrt(i)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){J(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),a=0;a<r.length;++a)o[a]=1/r[a];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){J(n,"relu");for(var r=st(n.shape,n.dtype),o=this.readSync(r.dataId),a=this.readSync(n.dataId),i=0;i<a.length;++i)o[i]=Math.max(0,a[i]);return r},t.prototype.relu6=function(n){J(n,"relu");for(var r=st(n.shape,n.dtype),o=this.readSync(r.dataId),a=this.readSync(n.dataId),i=0;i<a.length;++i)o[i]=Math.min(Math.max(0,a[i]),6);return r},t.prototype.prelu=function(n,r){return J([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){return o<0?a*o:o})},t.prototype.elu=function(n){J(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a){var i=o[a];r[a]=i>=0?i:Math.exp(i)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){J([n,r],"eluDer");for(var o=new Float32Array(r.size),a=this.readSync(r.dataId),i=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>=1?i[s]:i[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){J(n,"selu");for(var r=Wg,o=zg,a=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];a[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,o){J(n,"clip");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];a[s]=u>o?o:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.abs(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<n.size;++a){var i=o[2*a],s=o[2*a+1];r[a]=Math.hypot(i,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){J(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=o[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){J(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=1/(1+Math.exp(-o[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){J(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),a=this.readSync(n.dataId),i=0;i<a.length;++i){var s=a[i]>-r,u=a[i]<r,l=Math.exp(a[i]),c=void 0;c=u?l:s?a[i]:Math.log(1+l),o[i]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){J(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.sin(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){J(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.cos(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){J(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.tan(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){J(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.asin(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){J(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.acos(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){J(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.atan(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return J([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,a){return Math.atan2(o,a)})},t.prototype.sinh=function(n){J(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.sinh(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){J(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.cosh(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){J(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=mO(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){J(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.asinh(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){J(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.acosh(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){J(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a)r[a]=Math.atanh(o[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){J(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),a=0;a<o.length;++a){var i=Math.sign(o[a]),s=Math.abs(o[a]),u=1/(1+.3275911*s);r[a]=i*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),J(n,"step");for(var o=new Float32Array(n.size),a=this.readSync(n.dataId),i=0;i<a.length;++i){var s=a[i];isNaN(s)?o[i]=NaN:o[i]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,a=n.convInfo,i=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,a);return i&&(l=this.add(l,i)),s&&(l=Xh(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){J([n,r],"conv2d");for(var a=o.filterHeight,i=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=Re(o.outShape,n.dtype),h=n.strides[0],p=d?n.strides[1]:n.strides[2],m=d?n.strides[2]:1,g=d?1:n.strides[1],v=f.strides[0],y=d?f.strides[1]:f.strides[2],x=d?f.strides[2]:1,w=d?1:f.strides[1],b=this.readSync(n.dataId),E=this.readSync(r.dataId),S=f.values,_=0;_<o.batchSize;++_)for(var k=_*h,N=_*v,A=0;A<o.outHeight;++A)for(var T=N+A*y,L=A*o.strideHeight-c,M=0;M<a;M++){var $=L+M*s;if(!($<0||$>=o.inHeight))for(var U=M*r.strides[0],j=k+$*p,D=0;D<o.outWidth;++D)for(var F=T+D*x,z=D*o.strideWidth-l,H=0;H<i;H++){var X=z+H*u;if(!(X<0||X>=o.inWidth))for(var ee=j+X*m,le=U+H*r.strides[1],ye=0;ye<o.inChannels;++ye){for(var se=b[ee+ye*g],xe=0;xe<o.outChannels;++xe)S[F+xe*w]+=se*E[le+xe];le+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,o){for(var a=o.filterDepth,i=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,p=Re(o.outShape,n.dtype),m=this.readSync(n.dataId),g=this.readSync(r.dataId),v=p.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],w=y*p.strides[0],b=0;b<o.outDepth;++b)for(var E=w+b*p.strides[1],S=b*o.strideDepth-d,_=0;_<a;_++){var k=S+_*u;if(!(k<0||k>=o.inDepth))for(var N=_*r.strides[0],A=x+k*n.strides[1],T=0;T<o.outHeight;++T)for(var L=E+T*p.strides[2],M=T*o.strideHeight-h,$=0;$<i;$++){var U=M+$*l;if(!(U<0||U>=o.inHeight))for(var j=N+$*r.strides[1],D=A+U*n.strides[2],F=0;F<o.outWidth;++F)for(var z=L+F*o.outChannels,H=F*o.strideWidth-f,X=0;X<s;X++){var ee=H+X*c;if(!(ee<0||ee>=o.inWidth))for(var le=j+X*r.strides[2],ye=D+ee*o.inChannels,se=le,xe=0;xe<o.inChannels;++xe){for(var Ee=m[ye+xe],be=0;be<o.outChannels;++be)v[z+be]+=Ee*g[se+be];se+=o.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){J([n,r],"conv2dDerInput");for(var a=Re(o.inShape,"float32"),i=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,p=o.filterHeight,m=o.filterWidth,g=o.inChannels,v=o.inHeight,y=o.inWidth,x=o.outChannels,w=o.outHeight,b=o.outWidth,E=o.strideHeight,S=o.strideWidth,_=o.dataFormat,k=p-1-o.padInfo.top,N=m-1-o.padInfo.left,A=_==="channelsLast",T=a.strides[0],L=A?a.strides[1]:a.strides[2],M=A?a.strides[2]:1,$=A?1:a.strides[1],U=n.strides[0],j=A?n.strides[1]:n.strides[2],D=A?n.strides[2]:1,F=A?1:n.strides[1],z=0;z<h;++z)for(var H=0;H<g;++H)for(var X=0;X<v;++X)for(var ee=X-k,le=Math.max(0,Math.ceil(ee/E)),ye=Math.min(w,(p+ee)/E),se=0;se<y;++se){for(var xe=se-N,Ee=Math.max(0,Math.ceil(xe/S)),be=Math.min(b,(m+xe)/S),We=0,Se=le;Se<ye;++Se)for(var Ae=Se*E-ee,De=Ee;De<be;++De)for(var Ue=U*z+j*Se+D*De,Ge=c*(p-1-Ae)+d*(m-1-(De*S-xe))+f*H,Be=0;Be<x;++Be)We+=s[Ue+F*Be]*u[Ge+Be];i[T*z+L*X+M*se+$*H]=We}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var a=Re(o.inShape,"float32"),i=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],E=x[2],S=x[3],_=o.batchSize,k=o.filterDepth,N=o.filterHeight,A=o.filterWidth,T=o.inChannels,L=o.inDepth,M=o.inHeight,$=o.inWidth,U=o.outChannels,j=o.outDepth,D=o.outHeight,F=o.outWidth,z=o.strideDepth,H=o.strideHeight,X=o.strideWidth,ee=k-1-o.padInfo.front,le=N-1-o.padInfo.top,ye=A-1-o.padInfo.left,se=0;se<_;++se)for(var xe=0;xe<T;++xe)for(var Ee=0;Ee<L;++Ee)for(var be=Ee-ee,We=Math.max(0,Math.ceil(be/z)),Se=Math.min(j,(k+be)/z),Ae=0;Ae<M;++Ae)for(var De=Ae-le,Ue=Math.max(0,Math.ceil(De/H)),Ge=Math.min(D,(N+De)/H),Be=0;Be<$;++Be){for(var Ut=Be-ye,Xt=Math.max(0,Math.ceil(Ut/X)),ze=Math.min(F,(A+Ut)/X),bn=0,Cn=We;Cn<Se;++Cn)for(var O=Cn*z-be,V=Ue;V<Ge;++V)for(var K=V*H-De,oe=Xt;oe<ze;++oe)for(var re=p*se+m*Cn+g*V+v*oe,Z=w*(k-1-O)+b*(N-1-K)+E*(A-1-(oe*X-Ut))+S*xe,ae=0;ae<U;++ae)bn+=f[re+ae]*y[Z+ae];i[u*se+l*Ee+c*Ae+d*Be+xe]=bn}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){J([n,r],"conv2dDerFilter");for(var a=o.strideHeight,i=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=Re(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((f-m)/a)),v=Math.min(o.outHeight,(o.inHeight+f-m)/a),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((d-y)/i)),w=Math.min(o.outWidth,(o.inWidth+d-y)/i),b=0;b<o.inChannels;++b)for(var E=0;E<o.outChannels;++E){for(var S=0,_=0;_<o.batchSize;++_)for(var k=g;k<v;++k)for(var N=m+k*a-f,A=x;A<w;++A){var T=y+A*i-d;S+=l?h.get(_,N,T,b)*p.get(_,k,A,E):h.get(_,b,N,T)*p.get(_,E,k,A)}c.set(S,m,y,b,E)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var a=o.strideDepth,i=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=Re(o.filterShape,"float32"),f=d.values,h=d.strides,p=h[0],m=h[1],g=h[2],v=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],E=x[2],S=x[3],_=this.readSync(n.dataId),k=n.strides,N=k[0],A=k[1],T=k[2],L=k[3],M=o.padInfo.front,$=o.padInfo.left,U=o.padInfo.top,j=0;j<u;++j)for(var D=Math.max(0,Math.ceil((M-j)/a)),F=Math.min(o.outDepth,(o.inDepth+M-j)/a),z=j*p,H=0;H<l;++H)for(var X=Math.max(0,Math.ceil((U-H)/i)),ee=Math.min(o.outHeight,(o.inHeight+U-H)/i),le=H*m+z,ye=0;ye<c;++ye)for(var se=Math.max(0,Math.ceil(($-ye)/s)),xe=Math.min(o.outWidth,(o.inWidth+$-ye)/s),Ee=ye*g+le,be=0;be<o.inChannels;++be)for(var We=be*v+Ee,Se=0;Se<o.outChannels;++Se){for(var Ae=0,De=0;De<o.batchSize;++De)for(var Ue=De*N,Ge=De*w,Be=D;Be<F;++Be)for(var Ut=(j+Be*a-M)*A+Ue,Xt=Be*b+Ge,ze=X;ze<ee;++ze)for(var bn=(H+ze*i-U)*T+Ut,Cn=ze*E+Xt,O=se;O<xe;++O){var V=O*S+Cn;Ae+=_[(ye+O*s-$)*L+bn+be]*y[V+Se]}f[We+Se]=Ae}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,a=n.convInfo,i=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,a);return i&&(l=this.add(l,i)),s&&(l=Xh(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){J([n,r],"depthwiseConv2D");for(var a=o.filterHeight,i=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=Re(o.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),m=f.values,g=0;g<o.batchSize;++g)for(var v=g*n.strides[0],y=g*f.strides[0],x=0;x<o.outHeight;++x)for(var w=y+x*f.strides[1],b=x*o.strideHeight-l,E=0;E<a;++E){var S=b+E*s;if(!(S<0||S>=o.inHeight))for(var _=E*r.strides[0],k=v+S*n.strides[1],N=0;N<o.outWidth;++N)for(var A=w+N*f.strides[2],T=N*o.strideWidth-c,L=0;L<i;++L){var M=T+L*u;if(!(M<0||M>=o.inWidth))for(var $=_+L*r.strides[1],U=k+M*o.inChannels,j=A,D=$,F=0;F<o.inChannels;++F){for(var z=h[U+F],H=0;H<d;++H)m[j+H]+=z*p[D+H];j+=d,D+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){J([n,r],"depthwiseConv2DDerInput");for(var a=Re(o.inShape,"float32"),i=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],p=f[1],m=f[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],x=v[1],w=v[2],b=o.batchSize,E=o.filterHeight,S=o.filterWidth,_=o.inChannels,k=o.inHeight,N=o.inWidth,A=o.outChannels,T=o.outHeight,L=o.outWidth,M=o.strideHeight,$=o.strideWidth,U=E-1-o.padInfo.top,j=S-1-o.padInfo.left,D=A/_,F=0;F<b;++F)for(var z=0;z<_;++z)for(var H=0;H<k;++H)for(var X=H-U,ee=Math.max(0,Math.ceil(X/M)),le=Math.min(T,(E+X)/M),ye=0;ye<N;++ye){for(var se=ye-j,xe=Math.max(0,Math.ceil(se/$)),Ee=Math.min(L,(S+se)/$),be=0,We=ee;We<le;++We)for(var Se=We*M-X,Ae=xe;Ae<Ee;++Ae)for(var De=h*F+p*We+m*Ae,Ue=y*(E-1-Se)+x*(S-1-(Ae*$-se))+w*z,Ge=0;Ge<D;++Ge)be+=d[De+(z*D+Ge)]*g[Ue+Ge];i[u*F+l*H+c*ye+z]=be}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){J([n,r],"depthwiseConv2DDerFilter");for(var a=o.strideHeight,i=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=Re(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((d-m)/a)),v=Math.min(o.outHeight,(o.inHeight+d-m)/a),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((c-y)/i)),w=Math.min(o.outWidth,(o.inWidth+c-y)/i),b=0;b<o.outChannels;++b){for(var E=Math.trunc(b/f),S=b%f,_=0,k=0;k<o.batchSize;++k)for(var N=g;N<v;++N)for(var A=m+N*a-d,T=x;T<w;++T){var L=y+T*i-c;_+=h.get(k,A,L,E)*p.get(k,N,T,b)}l.set(_,m,y,E,S)}return l.toTensor()},t.prototype.tile=function(n,r){return J(n,"tile"),L_(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){J(n,"pad");var a=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),i=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=Re(a,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,h){return f+i[h]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},t.prototype.transpose=function(n,r){J(n,"transpose");for(var o=new Array(n.rank),a=0;a<o.length;a++)o[a]=n.shape[r[a]];var i=this.readSync(n.dataId),s=Re(o,n.dtype),u=this.bufferSync(n);for(a=0;a<n.size;++a){for(var l=u.indexToLoc(a),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=i[a]}return s.toTensor()},t.prototype.gather=function(n,r,o){J([n,r],"gather");var a=n.shape.slice(),i=this.readSync(r.dataId);a[o]=i.length;for(var s=Re(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[o]=i[c[o]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){J([n],"batchToSpaceND");var a=r.reduce(function(d,f){return d*f}),i=Dd(n.shape,r,a),s=Id(i.length,r.length),u=Td(n.shape,r,a),l=__(o,r.length),c=S_(u,o,r.length);return n.reshape(i).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){J([n],"spaceToBatchND");var a=r.reduce(function(f,h){return f*h}),i=[[0,0]];i.push.apply(i,o);for(var s=1+r.length;s<n.shape.length;++s)i.push([0,0]);var u=n.pad(i),l=Dd(u.shape,r,a,!1),c=Id(l.length,r.length,!1),d=Td(u.shape,r,a,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.pool=function(n,r,o){J(n,"pool");for(var a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(n.dataId),m=Re(r.outShape,n.dtype),g=m.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],w=0;w<r.batchSize;++w)for(var b=w*v,E=w*n.strides[0],S=0;S<r.inChannels;++S)for(var _=0;_<r.outHeight;++_)for(var k=_*a-d,N=Math.max(0,k),A=Math.min(r.inHeight,l+k),T=b+_*y,L=0;L<r.outWidth;++L){for(var M=L*i-f,$=Math.max(0,M),U=Math.min(r.inWidth,c+M),j=h,D=0,F=0,z=N;z<A;z+=s){for(var H=E+z*n.strides[1],X=$;X<U;X+=u){var ee=p[H+X*n.strides[2]+S];o==="max"&&ee>j?j=ee:o==="avg"&&(D+=ee,F++)}if(isNaN(j))break}g[T+L*x+S]=o==="avg"?D/F:j}return m.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=Re(r.outShape,"int32"),a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),p=0;p<r.batchSize;++p)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.outHeight;++g){for(var v=g*a-d,y=v;y<0;)y+=s;for(var x=Math.min(r.inHeight,l+v),w=0;w<r.outWidth;++w){for(var b=w*i-f,E=b;E<0;)E+=u;for(var S=Math.min(r.inWidth,c+b),_=Number.NEGATIVE_INFINITY,k=-1,N=y;N<x;N+=s)for(var A=N-v,T=E;T<S;T+=u){var L=T-b,M=h.get(p,N,T,m);M>_&&(_=M,k=A*c+L)}o.set(k,p,g,w,m)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,a){J([r,o],"maxPoolBackprop");for(var i=this.maxPoolPositions(r,a),s=a.strideHeight,u=a.strideWidth,l=a.dilationHeight,c=a.dilationWidth,d=a.effectiveFilterHeight,f=a.effectiveFilterWidth,h=f-1-a.padInfo.left,p=d-1-a.padInfo.top,m=Re(r.shape,"float32"),g=this.bufferSync(i),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var x=0;x<a.inChannels;++x)for(var w=0;w<a.inHeight;++w)for(var b=0;b<a.inWidth;++b){for(var E=w-p,S=b-h,_=0,k=0;k<d;k+=l){var N=(E+k)/s;if(!(N<0||N>=a.outHeight||Math.floor(N)!==N))for(var A=0;A<f;A+=c){var T=(S+A)/u;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var L=d*f-1-g.get(y,N,T,x)===k*f+A?1:0;L!==0&&(_+=v.get(y,N,T,x)*L)}}}m.set(_,y,w,b,x)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){J([n,r],"avgPoolBackprop");for(var a=o.strideHeight,i=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,p=d-1-o.padInfo.top,m=Re(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var w=0;w<o.inHeight;++w)for(var b=0;b<o.inWidth;++b){for(var E=w-p,S=b-h,_=0,k=0;k<d;k+=l){var N=(E+k)/a;if(!(N<0||N>=o.outHeight||Math.floor(N)!==N))for(var A=0;A<f;A+=c){var T=(S+A)/i;T<0||T>=o.outWidth||Math.floor(T)!==T||(_+=v.get(y,N,T,x))}}m.set(_*g,y,w,b,x)}return m.toTensor()},t.prototype.pool3d=function(n,r,o){J(n,"pool3d");for(var a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=Re(r.outShape,n.dtype),w=x.values,b=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],_=r.outShape[4],k=0;k<r.batchSize;++k)for(var N=k*b,A=k*n.strides[0],T=0;T<r.inChannels;++T)for(var L=0;L<r.outDepth;++L){for(var M=L*a-p,$=M;$<0;)$+=u;for(var U=Math.min(r.inDepth,d+M),j=N+L*E,D=0;D<r.outHeight;++D){for(var F=D*i-m,z=F;z<0;)z+=l;for(var H=Math.min(r.inHeight,f+F),X=j+D*S,ee=0;ee<r.outWidth;++ee){for(var le=ee*s-g,ye=le;ye<0;)ye+=c;for(var se=Math.min(r.inWidth,h+le),xe=X+ee*_,Ee=v,be=0,We=0,Se=$;Se<U;Se+=u){for(var Ae=A+Se*n.strides[1],De=z;De<H;De+=l){for(var Ue=Ae+De*n.strides[2],Ge=ye;Ge<se;Ge+=c){var Be=y[Ue+Ge*n.strides[3]+T];if(o==="max"&&Be>Ee?Ee=Be:o==="avg"&&(be+=Be,We++),isNaN(Ee))break}if(isNaN(Ee))break}if(isNaN(Ee))break}w[xe+T]=o==="avg"?be/We:Ee}}}return x.toTensor()},t.prototype.avgPool3d=function(n,r){return J(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){J([n,r],"avgPool3dBackprop");for(var a=o.strideDepth,i=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterDepth,m=o.effectiveFilterHeight,g=o.effectiveFilterWidth,v=p-1-o.padInfo.front,y=g-1-o.padInfo.left,x=m-1-o.padInfo.top,w=Re(r.shape,"float32"),b=1/(u*l*c),E=this.bufferSync(n),S=0;S<o.batchSize;++S)for(var _=0;_<o.inChannels;++_)for(var k=0;k<o.inDepth;++k)for(var N=0;N<o.inHeight;++N)for(var A=0;A<o.inWidth;++A){for(var T=k-v,L=N-x,M=A-y,$=0,U=0;U<p;U+=d){var j=(T+U)/a;if(!(j<0||j>=o.outDepth||Math.floor(j)!==j))for(var D=0;D<m;D+=f){var F=(L+D)/i;if(!(F<0||F>=o.outHeight||Math.floor(F)!==F))for(var z=0;z<g;z+=h){var H=(M+z)/s;H<0||H>=o.outWidth||Math.floor(H)!==H||($+=E.get(S,j,F,H,_))}}}w.set($*b,S,k,N,A,_)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return J(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=Re(r.outShape,"int32"),a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outDepth;++w){for(var b=w*a-p,E=b;E<0;)E+=u;for(var S=Math.min(r.inDepth,d+b),_=0;_<r.outHeight;++_){for(var k=_*i-m,N=k;N<0;)N+=l;for(var A=Math.min(r.inHeight,f+k),T=0;T<r.outWidth;++T){for(var L=T*s-g,M=L;M<0;)M+=c;for(var $=Math.min(r.inWidth,h+L),U=Number.NEGATIVE_INFINITY,j=-1,D=E;D<S;D+=u)for(var F=D-b,z=N;z<A;z+=l)for(var H=z-k,X=M;X<$;X+=c){var ee=X-L,le=v.get(y,D,z,X,x);le>=U&&(U=le,j=F*f*h+H*f+ee)}o.set(j,y,w,_,T,x)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,a){J([r,o],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,d=a.dilationHeight,f=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=h-1-a.padInfo.front,v=m-1-a.padInfo.left,y=p-1-a.padInfo.top,x=Re(r.shape,"float32"),w=this.bufferSync(i),b=this.bufferSync(n),E=0;E<a.batchSize;++E)for(var S=0;S<a.inChannels;++S)for(var _=0;_<a.inDepth;++_)for(var k=0;k<a.inHeight;++k)for(var N=0;N<a.inWidth;++N){for(var A=_-g,T=k-y,L=N-v,M=0,$=0;$<h;$+=c){var U=(A+$)/s;if(!(U<0||U>=a.outDepth||Math.floor(U)!==U))for(var j=0;j<p;j+=d){var D=(T+j)/u;if(!(D<0||D>=a.outHeight||Math.floor(D)!==D))for(var F=0;F<m;F+=f){var z=(L+F)/l;if(!(z<0||z>=a.outWidth||Math.floor(z)!==z)){var H=h*p*m-1-w.get(E,U,D,z,S)===$*p*m+j*m+F?1:0;H!==0&&(M+=b.get(E,U,D,z,S)*H)}}}}x.set(M,E,_,k,N,S)}return x.toTensor()},t.prototype.cast=function(n,r){return A_(n,r,this)},t.prototype.reshape=function(n,r){return Bv(n,r)},t.prototype.avgPool=function(n,r){return J(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,a){J(n,"resizeBilinear");for(var i=n.shape,s=i[0],u=i[1],l=i[2],c=i[3],d=this.readSync(n.dataId),f=new Float32Array(pe([s,r,o,c])),h=[a&&r>1?u-1:u,a&&o>1?l-1:l],p=[a&&r>1?r-1:r,a&&o>1?o-1:o],m=0,g=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var w=g*x,b=Math.floor(w),E=w-b,S=Math.min(u-1,Math.ceil(w)),_=y*n.strides[0]+b*n.strides[1],k=y*n.strides[0]+S*n.strides[1],N=0;N<o;N++)for(var A=v*N,T=Math.floor(A),L=A-T,M=Math.min(l-1,Math.ceil(A)),$=_+T*n.strides[2],U=k+T*n.strides[2],j=_+M*n.strides[2],D=k+M*n.strides[2],F=0;F<c;F++){var z=d[$+F],H=d[U+F],X=z+(d[j+F]-z)*L,ee=X+(H+(d[D+F]-H)*L-X)*E;f[m++]=ee}return qt(f,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){J([n,r],"resizeBilinearBackprop");for(var a=r.shape,i=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(i*s*u*l),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=p[0]/m[0],v=p[1]/m[1],y=this.readSync(n.dataId),x=0,w=0;w<i;w++)for(var b=w*r.strides[0],E=0;E<d;E++)for(var S=E*g,_=Math.floor(S),k=Math.min(Math.ceil(S),s-1),N=b+_*r.strides[1],A=b+k*r.strides[1],T=S-_,L=1-T,M=0;M<f;M++)for(var $=M*v,U=Math.floor($),j=Math.min(Math.ceil($),u-1),D=$-U,F=1-D,z=N+U*r.strides[2],H=N+j*r.strides[2],X=A+U*r.strides[2],ee=A+j*r.strides[2],le=L*F,ye=L*D,se=T*F,xe=T*D,Ee=0;Ee<l;Ee++){var be=y[x++];h[z+Ee]+=be*le,h[H+Ee]+=be*ye,h[X+Ee]+=be*se,h[ee+Ee]+=be*xe}return _n(h,[i,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,a){J(n,"resizeNearestNeighbor");for(var i=n.shape,s=i[0],u=i[1],l=i[2],c=i[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[a&&r>1?u-1:u,a&&o>1?l-1:l],p=[a&&r>1?r-1:r,a&&o>1?o-1:o],m=h[0]/p[0],g=h[1]/p[1],v=0,y=0;y<s;y++)for(var x=y*n.strides[0],w=0;w<r;w++)for(var b=m*w,E=x+Math.min(u-1,a?Math.round(b):Math.floor(b))*n.strides[1],S=0;S<o;S++)for(var _=g*S,k=E+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],N=0;N<c;N++){var A=d[k+N];f[v++]=A}return qt(f,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){J([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,i=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(i*s*u*l),p=this.readSync(n.dataId),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=m[0]/g[0],y=m[1]/g[1],x=1/v,w=1/y,b=2*Math.ceil(x)+2,E=2*Math.ceil(w)+2,S=0;S<i;S++)for(var _=S*r.strides[0],k=0;k<s;k++)for(var N=_+k*r.strides[1],A=Math.floor(k*x),T=Math.floor(A-b/2),L=0;L<u;L++)for(var M=N+L*r.strides[2],$=Math.floor(L*w),U=Math.floor($-E/2),j=0;j<l;j++){for(var D=0,F=0;F<b;F++){var z=F+T;if(!(z<0||z>=d)){var H=_+z*n.strides[1],X=z*v;if(k===Math.min(s-1,o?Math.round(X):Math.floor(X)))for(var ee=0;ee<E;ee++){var le=ee+U;if(!(le<0||le>=f)){var ye=H+le*n.strides[2],se=le*y;L===Math.min(u-1,o?Math.round(se):Math.floor(se))&&(D+=p[ye+j])}}}}h[M+j]=D}return _n(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,a,i,s){J([n,r,o,i,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=i?this.readSync(i.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=f.length,m=d.length,g=c.length,v=l.length,y=0,x=0,w=0,b=0,E=0;E<u.length;++E)h[E]=f[y++]+(u[E]-l[x++])*d[w++]/Math.sqrt(c[b++]+a),y>=p&&(y=0),x>=v&&(x=0),w>=m&&(w=0),b>=g&&(b=0);return _n(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,a,i){J(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(g){for(var v=g%s,y=g-v+Math.max(0,v-r),x=g-v+Math.min(v+r,u),w=0;y<=x;y++){var b=l[y];w+=b*b}return w}for(var h=0;h<c;h++){var p=f(h),m=l[h]*Math.pow(o+a*p,-i);d[h]=m}return _n(d,n.shape)},t.prototype.LRNGrad=function(n,r,o,a,i,s,u){J(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),p=n.size,m=0;m<p;m++){for(var g=m%l,v=m-g+Math.max(0,g-a),y=m-g+Math.min(l,g+a+1),x=0,w=v;w<y;w++)x+=Math.pow(d[w],2);for(x=s*x+i,w=v;w<y;w++){var b=-2*s*u*d[w]*f[m]/x;m===w&&(b+=Math.pow(x,-u)),b*=c[m],h[w]+=b}}return _n(h,n.shape)},t.prototype.multinomial=function(n,r,o,a){J(n,"multinomial");for(var i=r?n:Mo(n),s=i.shape[0],u=i.shape[1],l=st([s,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(i.dataId),f=0;f<s;++f){var h=f*u,p=new Float32Array(u-1);p[0]=d[h];for(var m=1;m<p.length;++m)p[m]=p[m-1]+d[h+m];for(var g=Sf(a.toString()),v=f*o,y=0;y<o;++y){var x=g();c[v+y]=p.length;for(var w=0;w<p.length;w++)if(x<p[w]){c[v+y]=w;break}}}return l},t.prototype.oneHot=function(n,r,o,a){J(n,"oneHot");var i=new Float32Array(n.size*r);i.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(i[u*r+s[u]]=o);return ya(i,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,a,i){return J(n,"nonMaxSuppression"),Og(this.readSync(n.dataId),this.readSync(r.dataId),o,a,i)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],a=n.shape[1],i=Re(n.shape,"float32"),s=Re(n.shape,"float32"),u=or(n).as2D(o,a),l=Kr(n).as2D(o,a),c=0;c<o;c++)for(var d=u.slice([c,0],[1,a]),f=l.slice([c,0],[1,a]),h=Ht(d,f),p=this.readSync(this.fftImpl(h,r).dataId),m=0;m<a;m++){var g=i1(p,m);i.values[c*a+m]=g.real,s.values[c*a+m]=g.imag}return Ht(i.toTensor(),s.toTensor()).as2D(o,a)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),a=o.size;if(this.isExponentOf2(a)){var i=this.fftRadix2(o,a,r).as2D(n.shape[0],n.shape[1]);return r&&(i=Ht(or(i).div(ie(a)),Kr(i).div(ie(a)))),i}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,a,r));return Ht(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var a=this.readSync(n.dataId),i=r/2,s=function(v){for(var y=Math.ceil(v.length/4),x=new Float32Array(y),w=new Float32Array(y),b=0;b<v.length;b+=4)x[Math.floor(b/4)]=v[b],w[Math.floor(b/4)]=v[b+1];return{real:x,imag:w}}(a),u=Ht(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),x=new Float32Array(y),w=new Float32Array(y),b=2;b<v.length;b+=4)x[Math.floor(b/4)]=v[b],w[Math.floor(b/4)]=v[b+1];return{real:x,imag:w}}(a),c=Ht(l.real,l.imag).as1D();u=this.fftRadix2(u,i,o),c=this.fftRadix2(c,i,o);var d=function(v,y){for(var x=new Float32Array(v/2),w=new Float32Array(v/2),b=0;b<Math.ceil(v/2);b++){var E=(y?2:-2)*Math.PI*(b/v);x[b]=Math.cos(E),w[b]=Math.sin(E)}return{real:x,imag:w}}(r,o),f=Ht(d.real,d.imag).mul(c),h=u.add(f),p=u.sub(f),m=or(h).concat(or(p)),g=Kr(h).concat(Kr(p));return Ht(m,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var a=new Float32Array(2*r),i=0;i<r;i++){for(var s=0,u=0,l=0;l<r;l++){var c=YL(i*l,r,o),d=i1(n,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(s/=r,u/=r),KL(a,s,u,i)}return a},t.prototype.depthToSpace=function(n,r,o){P(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),P(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],i=n.shape[1],s=n.shape[2],u=n.shape[3],l=i*r,c=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(a*l*c*d),p=0,m=0;m<a;++m)for(var g=0;g<l;++g)for(var v=Math.floor(g/r),y=g%r,x=0;x<c;++x)for(var w=Math.floor(x/r),b=(y*r+x%r)*d,E=0;E<d;++E){var S=E+b+u*(w+s*(v+i*m));h[p++]=f[S]}return _n(h,[a,l,c,d])},t.prototype.broadcastedBinaryOp=function(n,r,o,a){var i=Fe(n.shape,r.shape),s=Re(i,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ua(n.shape,i),d=ua(r.shape,i),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),m=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),x=y.slice(-n.rank);c.forEach(function(S){return x[S]=0});var w=p.locToIndex(x),b=y.slice(-r.rank);d.forEach(function(S){return b[S]=0});var E=m.locToIndex(b);f[v]=a(u[w],l[E])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var a=Fe(n.shape,r.shape),i=Re(a,"float32"),s=Re(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ua(n.shape,a),d=ua(r.shape,a),f=i.values,h=s.values;if(c.length+d.length===0)for(var p=0;p<f.length;p++){var m=p%u.length,g=p%l.length,v=o(u[2*m],u[2*m+1],l[2*g],l[2*g+1]);f[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(b){var E=i.indexToLoc(b),S=E.slice(-n.rank);c.forEach(function(T){return S[T]=0});var _=y.locToIndex(S),k=E.slice(-r.rank);d.forEach(function(T){return k[T]=0});var N=x.locToIndex(k),A=o(u[2*_],u[2*_+1],l[2*N],l[2*N+1]);f[b]=A.real,h[b]=A.imag};for(p=0;p<f.length;p++)w(p)}return this.complex(i.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return O_(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,a,i,s){for(var u=n.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],p=a[0],m=a[1],g=Re([h,p,m,f],"float32"),v=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),w=n.strides,b=g.strides,E=0;E<h;E++){var S=4*E,_=v[S],k=v[S+1],N=v[S+2],A=v[S+3],T=y[E];if(!(T>=l))for(var L=p>1?(N-_)*(c-1)/(p-1):0,M=m>1?(A-k)*(d-1)/(m-1):0,$=0;$<p;$++){var U=p>1?_*(c-1)+$*L:.5*(_+N)*(c-1);if(U<0||U>c-1)for(var j=0;j<m;j++)for(var D=0;D<f;D++){var F=D+j*b[2]+$*b[1]+E*b[0];g.values[F]=s}else if(i==="bilinear"){var z=Math.floor(U),H=Math.ceil(U),X=U-z;for(j=0;j<m;j++)if((Se=m>1?k*(d-1)+j*M:.5*(k+A)*(d-1))<0||Se>d-1)for(D=0;D<f;D++)F=D+j*b[2]+$*b[1]+E*b[0],g.values[F]=s;else{var ee=Math.floor(Se),le=Math.ceil(Se),ye=Se-ee;for(D=0;D<f;D++){var se=x[F=D+ee*w[2]+z*w[1]+T*w[0]],xe=x[F=D+le*w[2]+z*w[1]+T*w[0]],Ee=x[F=D+ee*w[2]+H*w[1]+T*w[0]],be=se+(xe-se)*ye,We=Ee+(x[F=D+le*w[2]+H*w[1]+T*w[0]]-Ee)*ye;F=D+j*b[2]+$*b[1]+E*b[0],g.values[F]=be+(We-be)*X}}}else for(j=0;j<m;++j){var Se;if((Se=m>1?k*(d-1)+j*M:.5*(k+A)*(d-1))<0||Se>d-1)for(D=0;D<f;D++)F=D+j*b[2]+$*b[1]+E*b[0],g.values[F]=s;else{var Ae=Math.round(Se),De=Math.round(U);for(D=0;D<f;D++){var Ue=D+Ae*w[2]+De*w[1]+T*w[0],Ge=D+j*b[2]+$*b[1]+E*b[0];g.values[Ge]=x[Ue]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,a){var i=Pd(0,n,o),s=i.sliceRank,u=i.numUpdates,l=i.sliceSize,c=i.strides,d=i.outputSize;return this.scatter(n,r,o,d,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,a=o[o.length-1],i=k_(n,r),s=i[0],u=i[1],l=i[2],c=i[3];if(u===0)return qt([],s,n.dtype);for(var d=new rl([u,l],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var m=[],g=0,v=0;v<a;v++){var y=f[p*a+v];g+=y*c[v],m.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+m+" does not index into "+n.shape);for(var x=0;x<l;x++)d.values[p*l+x]=h[g*l+x]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var a=Pd(0,n,o),i=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,d=ie(0);return this.scatter(n,r,o,c,u,s,i,l,d,!0)},t.prototype.fill=function(n,r,o){var a=Cd(o=o||kl(r),pe(n));return a.fill(r),W.makeTensor(a,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Cd(n.dtype,pe(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return M_(n,r,o)},t.prototype.scatter=function(n,r,o,a,i,s,u,l,c,d){var f=[a/i,i],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return qt([],o,r.dtype);var m=new rl(f,r.dtype);m.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,x=0;x<u;x++){var w=h[g*u+x];v.push(w),y+=w*l[x]}if(y<0||y>=a/i)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var b=0;b<i;b++)d?m.values[y*i+b]+=p[g*i+b]:m.values[y*i+b]=r.rank===0?p[0]:p[g*i+b]}return m.toTensor().reshape(o)},t}(T_);W.registerBackend("cpu",function(){return new v6},1);for(var Qh=0,N1=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,a=o.boxes,i=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;J(a,"NonMaxSuppressionWithScore");var h=Lg(f.data.get(a.dataId).values,f.data.get(i.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;J(r,"square");for(var a=o.data.get(r.dataId).values,i=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];i[s]=u*u}return{dataId:o.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:il,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,a=r.b,i=n;J([o,a],il);var s=i.data.get(o.dataId).values,u=i.data.get(a.dataId).values,l=function(f,h,p,m,g,v){var y=Fe(f,h),x=y.length,w=to(y),b=nl(g,pe(y)),E=f.length,S=h.length,_=to(f),k=to(h),N=ua(f,y),A=ua(h,y);if(N.length+A.length===0)for(var T=0;T<b.length;++T)b[T]=v(p[T%p.length],m[T%m.length]);else{var L=function(M){var $=SO(M,x,w),U=$.slice(-E);N.forEach(function(z){return U[z]=0});var j=Qx(U,E,_),D=$.slice(-S);A.forEach(function(z){return D[z]=0});var F=Qx(D,S,k);b[M]=v(p[j],m[F])};for(T=0;T<b.length;++T)L(T)}return[b,y]}(o.shape,a.shape,s,u,o.dtype,function(f,h){var p=f-h;return p*p}),c=l[0],d=l[1];return{dataId:i.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];Qh<N1.length;Qh++)a_(N1[Qh]);var Ri,m6=function(e){this.variableNames=["A"];var t=an(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},g6=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=an(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Jh=0,D1=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,a=r.numChannels,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,a];(s||i)&&(Ri==null&&(Ri=document.createElement("canvas").getContext("2d")),Ri.canvas.width=l,Ri.canvas.height=c,Ri.drawImage(o,0,0,l,c),o=Ri.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=Un.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var p=Y().getBool("WEBGL_PACK")?new g6(f):new m6(f),m=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;kd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,a=o.boxes,i=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=Lg(f.readSync(a.dataId),f.readSync(i.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,a=new Te(r.shape,"return x * x;");return o.runWebGLProgram(a,[r],r.dtype)}},{kernelName:il,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,a=r.b,i=n,s=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xo("return (a - b) * (a - b);",o.shape,a.shape):new mt("return (a - b) * (a - b);",o.shape,a.shape);return i.compileAndRun(s,[o,a])}}];Jh<D1.length;Jh++)a_(D1[Jh]);for(var Zh=0,I1=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:il,gradFunc:function(e,t){var n=t[0],r=t[1],o=ie(2);return{a:function(){return un(e,un(o,Ot(n,r)))},b:function(){return un(e,un(o,Ot(r,n)))}}}}];Zh<I1.length;Zh++)pO(I1[Zh]);var y6=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();Y().get("IS_BROWSER")&&Y().setPlatform("browser",new y6);var ep,x6=function(){return require("node-fetch")},w6=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return Y().global.fetch!=null?Y().global.fetch(t,n):(ep==null&&(ep=x6()),ep(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();Y().get("IS_NODE")&&Y().setPlatform("node",new w6);var zv={float32:4,int32:4,uint16:2,uint8:1,bool:1},jd=4;function NS(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,d=pe(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=zv[h.dtype],m=e.slice(r,r+d*p),g=h.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(l==="float32")f=Float32Array.from(g,function(E){return E*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(g,function(E){return Math.round(E*h.scale+h.min)})}r+=d*p}else if(l==="string"){var v=pe(s.shape);f=[];for(var y=0;y<v;y++){var x=new Uint32Array(e.slice(r,r+jd))[0];r+=jd;var w=new Uint8Array(e.slice(r,r+x));f.push(w),r+=x}}else{var b=zv[l];if(m=e.slice(r,r+d*b),l==="float32")f=new Float32Array(m);else if(l==="int32")f=new Int32Array(m);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(m)}r+=d*b}n[u]=qt(f,c,l)},a=0,i=t;a<i.length;a++)o(i[a]);return n}function b6(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),o),o+=a.byteLength}),r.buffer}var $v=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function T1(e){return $v?Buffer.byteLength(e):new Blob([e]).size}function ny(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function P1(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Al(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:T1(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:T1(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Vn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var i=a(t,r);i!==null&&o.push(i)}),o},e}(),is="://",xa=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){P(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(is)&&(t=t.slice(0,t.indexOf(is))),P(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();P(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function jc(e){if(e.indexOf(is)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+xa.getSchemes().join(","));return{scheme:e.split(is)[0],path:e.split(is)[1]}}function A1(e,t,n){return n===void 0&&(n=!1),de(this,void 0,void 0,function(){var r,o,a,i,s,u,l,c,d;return fe(this,function(f){switch(f.label){case 0:return P(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),P((r=Vn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),P(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],P((a=Vn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),P(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),i=a[0],s=jc(e).scheme,u=jc(e).path,l=s===jc(e).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,xa.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,i.save(c)];case 4:return d=f.sent(),!n||l?[3,6]:[4,xa.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var Ka="models_store",la="model_info_store";function DS(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Uv(e){var t=e.result;t.createObjectStore(Ka,{keyPath:"modelPath"}),t.createObjectStore(la,{keyPath:"modelPath"})}var ss=function(){function e(t){if(this.indexedDB=DS(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){return fe(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){return fe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,a){var i=r.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Uv(i)},i.onsuccess=function(){var s=i.result;if(n==null){var u=s.transaction(Ka,"readonly"),l=u.objectStore(Ka).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(m){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=Al(n),f=s.transaction(la,"readwrite"),h=f.objectStore(la),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});p.onsuccess=function(){var m=(c=s.transaction(Ka,"readwrite")).objectStore(Ka).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});m.onsuccess=function(){return o({modelArtifactsInfo:d})},m.onerror=function(g){var v=(h=f.objectStore(la)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(m.error)},v.onerror=function(y){return s.close(),a(m.error)}}},p.onerror=function(m){return s.close(),a(p.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},i.onerror=function(s){return a(i.error)}})},e.URL_SCHEME="indexeddb://",e}(),M1=function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ss.URL_SCHEME)?(t=e.slice(ss.URL_SCHEME.length),new ss(t)):null;var t};Vn.registerSaveRouter(M1),Vn.registerLoadRouter(M1);var C6=function(){function e(){this.indexedDB=DS()}return e.prototype.listModels=function(){return de(this,void 0,void 0,function(){var t=this;return fe(this,function(n){return[2,new Promise(function(r,o){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Uv(a)},a.onsuccess=function(){var i=a.result,s=i.transaction(la,"readonly"),u=s.objectStore(la).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return i.close(),o(u.error)},s.oncomplete=function(){return i.close()}},a.onerror=function(i){return o(a.error)}})]})})},e.prototype.removeModel=function(t){return de(this,void 0,void 0,function(){var n=this;return fe(this,function(r){var o;return t=(o=t).startsWith(ss.URL_SCHEME)?o.slice(ss.URL_SCHEME.length):o,[2,new Promise(function(a,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Uv(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(la,"readwrite"),d=c.objectStore(la),f=d.get(t);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),p=function(){var m=(u=l.transaction(Ka,"readwrite")).objectStore(Ka).delete(t);m.onsuccess=function(){return a(f.result.modelArtifactsInfo)},m.onerror=function(g){return i(f.error)}};h.onsuccess=p,h.onerror=function(m){return p(),l.close(),i(f.error)}},f.onerror=function(h){return l.close(),i(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return i(s.error)}})]})})},e}();if(Y().getBool("IS_BROWSER"))try{xa.registerManager(ss.URL_SCHEME,new C6)}catch{}var Co="/",Ai="tensorflowjs_models",IS="info",E6="model_topology",_6="weight_specs",S6="weight_data",k6="model_metadata";function TS(e){return{info:[Ai,e,IS].join(Co),topology:[Ai,e,E6].join(Co),weightSpecs:[Ai,e,_6].join(Co),weightData:[Ai,e,S6].join(Co),modelMetadata:[Ai,e,k6].join(Co)}}function R6(e){var t=e.split(Co);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Co)}var us=function(){function e(t){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=TS(this.modelPath)}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o;return fe(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Al(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(i){if($v)return Buffer.from(i).toString("base64");for(var s=new Uint8Array(i),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r,o,a,i,s;return fe(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(i=JSON.parse(a),n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,n.userDefinedMetadata=i.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if($v){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),F1=function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(us.URL_SCHEME)?(t=e.slice(us.URL_SCHEME.length),new us(t)):null;var t};Vn.registerSaveRouter(F1),Vn.registerLoadRouter(F1);var N6=function(){function e(){P(Y().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),P(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return de(this,void 0,void 0,function(){var t,n,r,o,a,i;return fe(this,function(s){for(t={},n=Ai+Co,r=Co+IS,o=0;o<this.LS.length;++o)(a=this.LS.key(o)).startsWith(n)&&a.endsWith(r)&&(i=R6(a),t[i]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return de(this,void 0,void 0,function(){var n,r;return fe(this,function(o){var a;if(t=(a=t).startsWith(us.URL_SCHEME)?a.slice(us.URL_SCHEME.length):a,n=TS(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(Y().getBool("IS_BROWSER"))try{xa.registerManager(us.URL_SCHEME,new N6)}catch{}var D6="model",I6=".json",T6=".weights.bin";function O1(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var tp=function(){function e(t){if(!Y().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=D6),this.modelTopologyFileName=t+I6,this.weightDataFileName=t+T6}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s;return fe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(i=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,O1(function(){return i.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,O1(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Al(t)}]}})})},e.URL_SCHEME="downloads://",e}(),P6=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r=this;return fe(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,i){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void i(g)}var h=[],p=[],m=[];d.forEach(function(g){g.paths.forEach(function(v){p.push(v),m.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(x){var w=x.target.result,b=p.indexOf(v);m[b]=w,m.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:ny(m),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(x){return i("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(f[v])})})}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return P1(u.name)}),a={},i=0,s=t;i<s.length;i++)s[i].paths.forEach(function(u){var l=P1(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function L1(e,t,n,r){(function(a){P(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,i){P(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),P(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+i}),P(i>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+i})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(a){return a.then(function(i){var s=n+ ++o/e.length*(r-n);return t(s),i}),a}))}function PS(e,t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s,u,l,c;return fe(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?Y().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),o=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return i=d.sent(),[3,4];case 2:return[4,L1(r,t.onProgress,o,a)];case 3:i=d.sent(),d.label=4;case 4:return s=i.map(function(f){return f.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,L1(s,t.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function B1(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),de(t,void 0,void 0,function(){var a,i,s,u,l,c,d,f,h,p;return fe(this,function(m){switch(m.label){case 0:if(a=n.map(function(){return!1}),i={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(x){var w="quantization"in x?x.quantization.dtype:x.dtype,b=zv[w]*pe(x.shape),E=function(){a[v]=!0,i[v]==null&&(i[v]=[]),i[v].push({manifestEntry:x,groupOffset:y,sizeBytes:b})};o!=null?o.forEach(function(S,_){S===x.name&&(E(),s[_]=!0)}):E(),u.push(x.name),y+=b})}),!s.every(function(g){return g}))throw l=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(g,v,y){return v&&g.push(y),g},[]),d=[],c.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;d.push(y)})}),[4,e(d)];case 1:return f=m.sent(),h={},p=0,c.forEach(function(g){for(var v=n[g].paths.length,y=0,x=0;x<v;x++)y+=f[p+x].byteLength;for(var w=new ArrayBuffer(y),b=new Uint8Array(w),E=0,S=0;S<v;S++){var _=new Uint8Array(f[p+S]);b.set(_,E),E+=_.byteLength}i[g].forEach(function(k){var N=NS(w.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var A in N)h[A]=N[A]}),p+=v}),[2,h]}})})}}Vn.registerSaveRouter(function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(tp.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new tp(t)}(e.slice(tp.URL_SCHEME.length)):null});var AS=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(P(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=Y().platform.fetch,P(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&P(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o,a;return fe(this,function(i){switch(i.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:Al(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r,o,a,i,s,u,l,c,d,f;return fe(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,a=n.weightsManifest,i=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:i,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s,u,l,c,d,f;return fe(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var m=p.lastIndexOf("/"),g=p.lastIndexOf("?"),v=p.substring(0,m),y=g>m?p.substring(g):"";return[v+"/",y]}(n),o=r[0],a=r[1],i=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],t.forEach(function(p){p.paths.forEach(function(m){d.push(i+m+a)})}),[4,PS(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,ny(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Vv(e){return e.match(AS.URL_SCHEME_REGEX)!=null}var j1=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Vv(n)}):Vv(e))?Hv(e,{onProgress:t}):null};function Hv(e,t){return new AS(e,t)}Vn.registerSaveRouter(j1),Vn.registerLoadRouter(j1);var np=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return de(this,void 0,void 0,function(){return fe(this,function(t){return[2,this.modelArtifacts]})})},e}(),A6=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){return fe(this,function(n){return[2,this.saveHandler(t)]})})},e}(),MS=Object.freeze({browserFiles:function(e){return new P6(e)},browserHTTPRequest:function(e,t){return Hv(e,t)},concatenateArrayBuffers:ny,decodeWeights:NS,encodeWeights:function(e,t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s=this;return fe(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=o[l],d=Array.isArray(e)?e[l].tensor:e[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(p){return de(s,void 0,void 0,function(){var m,g,v,y,x,w,b;return fe(this,function(E){switch(E.label){case 0:return[4,d.bytes()];case 1:for(m=E.sent(),g=m.reduce(function(S,_){return S+_.length},0)+jd*m.length,v=new Uint8Array(g),y=0,x=0;x<m.length;x++)w=m[x],b=new Uint8Array(new Uint32Array([w.length]).buffer),v.set(b,y),y+=jd,v.set(w,y),y+=w.length;return p(v),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},i=0;i<o.length;++i)a(i);return[4,Promise.all(r)];case 1:return[2,{data:b6(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new np(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new np({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new np({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Vn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Al,getSaveHandlers:function(e){return Vn.getSaveHandlers(e)},http:Hv,isHTTPScheme:Vv,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),de(this,void 0,void 0,function(){return fe(this,function(o){return[2,B1(function(a){return PS(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Vn.registerLoadRouter(e)},registerSaveRouter:function(e){return Vn.registerSaveRouter(e)},weightsLoaderFactory:B1,withSaveHandler:function(e){return new A6(e)},copyModel:function(e,t){return de(this,void 0,void 0,function(){return fe(this,function(n){return[2,A1(e,t,!1)]})})},listModels:function(){return de(this,void 0,void 0,function(){var e,t,n,r,o,a,i;return fe(this,function(s){switch(s.label){case 0:e=xa.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,xa.getManager(o).listModels()]):[3,4];case 2:for(i in a=s.sent())t[o+is+i]=a[i];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return de(this,void 0,void 0,function(){return fe(this,function(n){return[2,A1(e,t,!0)]})})},removeModel:function(e){return de(this,void 0,void 0,function(){var t;return fe(this,function(n){return t=jc(e),[2,xa.getManager(t.scheme).removeModel(t.path)]})})}}),Ni;B({confusionMatrix_:function(e,t,n){var r=I(e,"labels","confusionMatrix"),o=I(t,"predictions","confusionMatrix");P(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),P(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),P(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),P(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),P(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=Ov(r.asType("int32"),n),i=Ov(o.asType("int32"),n);return a.transpose().matMul(i).asType("int32")}});var M6=B({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,a=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);i=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(o_("FromPixels",W.backendName)!=null)return W.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],d=l[1];if(i?s=e.getContext("2d").getImageData(0,0,c,d).data:r||n?s=e.data:(a||o)&&(Ni==null&&(Ni=document.createElement("canvas").getContext("2d")),Ni.canvas.width=c,Ni.canvas.height=d,Ni.drawImage(e,0,0,c,d),s=Ni.getImageData(0,0,c,d).data),t===4)u=new Int32Array(s);else{var f=c*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return Tg(u,[d,c,t],"int32")}}),ry=Object.freeze({toPixels:function(e,t){return de(this,void 0,void 0,function(){var n,r,o,a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S,_;return fe(this,function(k){switch(k.label){case 0:if(n=I(e,"img","toPixels"),e instanceof dt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],a=r[1],(i=n.rank===2?1:n.shape[2])>4||i===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+i);return[4,n.data()];case 1:return s=k.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),d=c[0],f=c[1],h=d[0],p=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(m=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(a*o*4),v=0;v<o*a;++v)y=void 0,x=void 0,w=void 0,b=void 0,i===1?(y=s[v]*m,x=s[v]*m,w=s[v]*m,b=255):i===3?(y=s[3*v]*m,x=s[3*v+1]*m,w=s[3*v+2]*m,b=255):i===4&&(y=s[4*v]*m,x=s[4*v+1]*m,w=s[4*v+2]*m,b=s[4*v+3]*m),g[(E=4*v)+0]=Math.round(y),g[E+1]=Math.round(x),g[E+2]=Math.round(w),g[E+3]=Math.round(b);return t!=null&&(t.width=a,t.height=o,S=t.getContext("2d"),_=new ImageData(g,a,o),S.putImageData(_,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:M6}),F6=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),O6=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function xi(e){P(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),P(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),P(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),O6.register(e)}var wi=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Pr(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var a=this.computeGradients(n,o),i=a.value,s=a.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return An(s),r?i:(i.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return GL(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&An(this.iterations_)},t.prototype.saveIterations=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ie(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return de(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(F6);Object.defineProperty(wi,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var L6=function(e){function t(n,r,o){o===void 0&&(o=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=o,a.accumulatedGrads=[],a.accumulatedUpdates=[],o==null&&(a.epsilon=W.backend.epsilon()),a}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,a){var i=W.registeredVariables[o];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:o+"/accum_grad",variable:ue(function(){return je(i).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:o+"/accum_var",variable:ue(function(){return je(i).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;ue(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(i);i.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(An(this.accumulatedGrads.map(function(n){return n.variable})),An(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(wi);xi(L6);var B6=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,a){var i=W.registeredVariables[o];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:o+"/accumulator",variable:ue(function(){return no(i.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[a].variable;ue(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(W.backend.epsilon()).sqrt()).mul(-r.learningRate).add(i);i.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&An(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(wi);xi(B6);var j6=function(e){function t(n,r,o,a){a===void 0&&(a=null);var i=e.call(this)||this;return i.learningRate=n,i.beta1=r,i.beta2=o,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],ue(function(){i.accBeta1=ie(r).variable(),i.accBeta2=ie(o).variable()}),a==null&&(i.epsilon=W.backend.epsilon()),i}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ue(function(){var a=Ot(1,r.accBeta1),i=Ot(1,r.accBeta2);o.forEach(function(s,u){var l=W.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ue(function(){return je(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ue(function(){return je(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),m=h.div(a),g=p.div(i);d.assign(h),f.assign(p);var v=m.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&An(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&An(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r,o=this;return fe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),ue(function(){o.accBeta1.assign(Ld(o.beta1,o.iterations_+1)),o.accBeta2.assign(Ld(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(wi);xi(j6);var W6=function(e){function t(n,r,o,a,i){a===void 0&&(a=null),i===void 0&&(i=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=a,s.decay=i,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ue(function(){s.iteration=ie(0).variable(),s.accBeta1=ie(r).variable()}),a==null&&(s.epsilon=W.backend.epsilon()),s}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ue(function(){var a=Ot(1,r.accBeta1),i=xr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=W.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:je(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:je(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2),m=c.abs(),g=p.maximum(m);d.assign(h),f.assign(g);var v=i.div(a).mul(h.div(g.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&An(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&An(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(wi);xi(W6);var FS=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,a){var i=Array.isArray(n)?n[a].tensor:n[o];if(i!=null){var s=W.registeredVariables[o];ue(function(){var u=r.c.mul(i).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=iL(ie(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(wi);xi(FS);var z6=function(e){function t(n,r,o){o===void 0&&(o=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=o,a.accumulations=[],a.m=ie(a.momentum),a}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,a){var i=W.registeredVariables[o];r.accumulations[a]==null&&(r.accumulations[a]={originalName:o+"/momentum",variable:ue(function(){return je(i).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[o];u!=null&&ue(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(i):r.c.mul(c).add(i),s.assign(c),i.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&An(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(FS);xi(z6);var $6=function(e){function t(n,r,o,a,i){r===void 0&&(r=.9),o===void 0&&(o=0),a===void 0&&(a=null),i===void 0&&(i=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=i,a==null&&(s.epsilon=W.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Pr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,a){var i=W.registeredVariables[o];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:o+"/rms",variable:ue(function(){return je(i).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:o+"/momentum",variable:ue(function(){return je(i).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:o+"/mg",variable:ue(function(){return je(i).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;ue(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[a].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var p=i.sub(h);i.assign(p)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),l.assign(h),p=i.sub(h),i.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&An(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&An(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&An(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(wi);xi($6);dt.prototype.squaredDifference=function(e){return X_(this,e)},q=p6;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gv=function(e,t){return Gv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},Gv(e,t)};function _e(e,t){Gv(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var on=function(){return on=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},on.apply(this,arguments)};function me(e,t,n,r){function o(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function s(c){try{l(r.next(c))}catch(d){i(d)}}function u(c){try{l(r.throw(c))}catch(d){i(d)}}function l(c){c.done?a(c.value):o(c.value).then(s,u)}l((r=r.apply(e,[])).next())})}function ge(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,o,a,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Du(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)r[o]=a[i];return r}var ls=function(){function e(t,n){if(!ni(t)||!ni(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Af(e,t){return e instanceof dt&&e.shape.length===t}function U6(e){return Af(e,2)}function Mf(e){return Af(e,3)}function wa(e){return Af(e,4)}function V6(e){return e%1!==0}function W1(e){return e%2===0}function H6(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function z1(e){return e&&e.width&&e.height}function G6(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new ls(Math.round(n*o),Math.round(r*o))}function oy(e){return e.reduce(function(t,n){return t.add(n)},new He(0,0)).div(new He(e.length,e.length))}function sl(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function ni(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function $1(e){return ni(e)&&0<=e&&e<=1}var He=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Da=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(ni),a=[r.x,r.y,r.width,r.height].every(ni);if(!a&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var i=a?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=i[0],u=i[1],l=i[2],c=i[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(ni)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new He(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new He(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new He(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new He(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(i){return Math.round(i)}),n=t[0],r=t[1],o=t[2],a=t[3];return new e({x:n,y:r,width:o,height:a})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(i){return Math.floor(i)}),n=t[0],r=t[1],o=t[2],a=t[3];return new e({x:n,y:r,width:o,height:a})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,a=t.height,i=Math.abs(o-a);return o<a&&(n-=i/2,o+=i),a<o&&(r-=i/2,a+=i),new e({x:n,y:r,width:o,height:a})},e.prototype.rescale=function(t){var n=z1(t)?t.width:t,r=z1(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],a=r[1],i=r[2],s=r[3];return new e({x:o,y:a,width:i,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,a=r.y,i=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(a,0),c=i-u,d=s-l,f=Math.min(c,t-u),h=Math.min(d,n-l);return new e({x:u,y:l,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,a=r.height,i=this.x+t,s=this.y+n;return new e({x:i,y:s,width:o,height:a})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,a=1,i=1,s=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(u=-f+t+o,f=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:i,edy:u,dx:a,edx:s,y:c,ey:f,x:l,ex:d,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Ff=function(e){_e(t,e);function t(n,r,o,a,i){return i===void 0&&(i=!1),e.call(this,{left:n,top:r,right:o,bottom:a},i)||this}return t}(Da),OS=function(){function e(t,n,r,o,a){this._imageDims=new ls(a.width,a.height),this._score=t,this._classScore=n,this._className=r,this._box=new Da(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Da(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),co=function(e){_e(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),a=o.score,i=o.relativeBox,s=o.imageDims;return new t(a,i,s)},t}(OS);function q6(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),a=r*o;return n?a/(e.area+t.area-a):a/Math.min(e.area,t.area)}function K6(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),a=t.reduce(function(s,u){return s<u?u:s},0),i=n.reduce(function(s,u){return s<u?u:s},0);return new Ff(r,o,a,i)}function ul(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),a=[],i=function(){var s=o.pop();a.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var d=u[c],f=e[s],h=e[d];l.push(q6(f,h,r))}o=o.filter(function(p,m){return l[m]<=n})};o.length>0;)i();return a}function Ml(e,t){return ue(function(){var n=t[0],r=t[1],o=t[2],a=no(Du(e.shape.slice(0,3),[1]),n),i=no(Du(e.shape.slice(0,3),[1]),r),s=no(Du(e.shape.slice(0,3),[1]),o),u=At([a,i,s],3);return Ot(e,u)})}function Y6(e,t){return t===void 0&&(t=!1),ue(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var a=Math.abs(r-o),i=Math.round(a*(t?.5:1)),s=r>o?2:1,u=function(h){var p=e.shape.slice();return p[s]=h,no(p,0)},l=u(i),c=a-l.shape[s],d=t&&c?u(c):null,f=[d,e,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return At(f,s)})}function rp(e){return 1/(1+Math.exp(-e))}var ay=function(e){_e(t,e);function t(n,r,o,a,i){return i===void 0&&(i=!1),e.call(this,{x:n,y:r,width:o,height:a},i)||this}return t}(Da),X6=.5,Q6=.43,J6=.45,Wd=function(){function e(t,n,r){r===void 0&&(r=new He(0,0));var o=n.width,a=n.height;this._imgDims=new ls(o,a),this._shift=r,this._positions=t.map(function(i){return i.mul(new He(o,a)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new He(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new He(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new He(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof co?t.box.floor():new Da(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),a=o.useDlibAlignment,i=o.minBoxPadding;return a?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],a=function(d){return o.sub(d).magnitude()},i=(a(n)+a(r))/2,s=Math.floor(i/J6),u=oy(t),l=Math.floor(Math.max(0,u.x-X6*s)),c=Math.floor(Math.max(0,u.y-Q6*s));return new ay(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=K6(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),Z6=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],oy([n[3],n[4]])]},t}(Wd),ez=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(oy)},t}(Wd),U1=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+H6(this.distance)+")":"")},e}(),V1=function(e){_e(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(Da.assertIsValidBox(n,r),!ni(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Da),mc=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){_e(t,e);function t(n,r,o,a){var i=e.call(this,n,r)||this;return i._score=o,i._classScore=a,i}return t.assertIsValidPredictedBox=function(n,r){if(V1.assertIsValidLabeledBox(n,r),!$1(n.score)||!$1(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(V1);function tz(e){return e.detection instanceof co}function iy(e,t){var n={detection:t};return Object.assign({},e,n)}function LS(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function BS(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,a){e.readFile(r,function(i,s){return i?a(i):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function jS(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=BS();return on({Canvas:e||function(){function i(){}return i}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function i(){}return i}(),Image:t||function(){function i(){}return i}(),ImageData:global.ImageData||function(){function i(){}return i}(),Video:global.HTMLVideoElement||function(){function i(){}return i}(),createCanvasElement:n,createImageElement:r,fetch:o},a)}function WS(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function zS(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var It;function nz(){if(!It)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return It}function qv(e){It=e}function sy(){WS()&&qv(LS()),zS()&&qv(jS())}function rz(e){if(It||sy(),!It)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?It.Canvas:t,r=e.Image,o=r===void 0?It.Image:r;It.Canvas=n,It.Image=o,It.createCanvasElement=e.createCanvasElement||function(){return new n},It.createImageElement=e.createImageElement||function(){return new o},It.ImageData=e.ImageData||It.ImageData,It.Video=e.Video||It.Video,It.fetch=e.fetch||It.fetch,It.readFile=e.readFile||It.readFile}var cn={getEnv:nz,setEnv:qv,initialize:sy,createBrowserEnv:LS,createFileSystem:BS,createNodejsEnv:jS,monkeyPatch:rz,isBrowser:WS,isNodejs:zS};sy();function $S(e){return!cn.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function di(e){var t=cn.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=$S(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var a=o.getContext("2d");if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}var H1;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(H1||(H1={}));function US(e){var t=cn.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function oz(e){return new Promise(function(t,n){if(e instanceof cn.getEnv().Canvas||US(e))return t();function r(a){a.currentTarget&&(a.currentTarget.removeEventListener("load",r),a.currentTarget.removeEventListener("error",o),t(a))}function o(a){a.currentTarget&&(a.currentTarget.removeEventListener("load",r),a.currentTarget.removeEventListener("error",o),n(a))}e.addEventListener("load",r),e.addEventListener("error",o)})}function VS(e){var t=cn.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new ls(e.naturalWidth,e.naturalHeight):e instanceof r?new ls(e.videoWidth,e.videoHeight):new ls(e.width,e.height)}function Of(e){var t=e.width,n=e.height,r=cn.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function uy(e,t){var n=cn.getEnv().ImageData;if(!(e instanceof n)&&!US(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=VS(e),o=r.width,a=r.height,i=Of({width:o,height:a});return e instanceof n?di(i).putImageData(e,0,0):di(i).drawImage(e,0,0,o,a),i}function az(e,t){return me(this,void 0,void 0,function(){var n,r,o,a,i,s;return ge(this,function(u){switch(u.label){case 0:return n=cn.getEnv().createCanvasElement(),r=e.shape.slice(wa(e)?1:0),o=r[0],a=r[1],i=r[2],s=ue(function(){return e.as3D(o,a,i).toInt()}),[4,ry.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function G1(e){var t=cn.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function iz(e,t,n){n===void 0&&(n=!1);var r=cn.getEnv(),o=r.Image,a=r.Canvas;if(!(e instanceof o||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var i=VS(e),s=t/Math.max(i.height,i.width),u=s*i.width,l=s*i.height,c=Of({width:t,height:t}),d=e instanceof a?e:uy(e),f=Math.abs(u-l)/2,h=n&&u<l?f:0,p=n&&l<u?f:0;return di(c).drawImage(d,h,p,u,l),c}var zd=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,a){if(Mf(o)){r._imageTensors[a]=o,r._inputDimensions[a]=o.shape;return}if(wa(o)){var i=o.shape[0];if(i!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+i+" passed, but not supported in input array");r._imageTensors[a]=o,r._inputDimensions[a]=o.shape.slice(1);return}var s=o instanceof cn.getEnv().Canvas?o:uy(o);r._canvases[a]=s,r._inputDimensions[a]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return sl(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return G6({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,ue(function(){var o=sl(r.batchSize,0,1).map(function(i){var s=r.getInput(i);if(s instanceof dt){var u=wa(s)?s:s.expandDims();return u=Y6(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Qg.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof cn.getEnv().Canvas)return ry.fromPixels(iz(s,t,n));throw new Error("toBatchTensor - at batchIdx "+i+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),a=Yn(o.map(function(i){return i.toFloat()})).as4D(r.batchSize,t,t,3);return a})},e}();function $t(e){return me(this,void 0,void 0,function(){var t,n,r;return ge(this,function(o){switch(o.label){case 0:if(e instanceof zd)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(a){return Array.isArray(e)?" at input index "+a+":":""},r=t.map($S),r.forEach(function(a,i){if(!G1(a)&&!Mf(a)&&!wa(a))throw typeof t[i]=="string"?new Error("toNetInput -"+n(i)+" string passed, but could not resolve HTMLElement for element id "+t[i]):new Error("toNetInput -"+n(i)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(wa(a)){var s=a.shape[0];if(s!==1)throw new Error("toNetInput -"+n(i)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(a){return G1(a)&&oz(a)}))];case 1:return o.sent(),[2,new zd(r,Array.isArray(e))]}})})}function ly(e,t){return me(this,void 0,void 0,function(){var n,r,o,a,i,s,u;return ge(this,function(l){switch(l.label){case 0:return n=cn.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,$t(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return a=o.getInput(0),a instanceof n?(i=a,[3,4]):[3,2];case 2:return[4,az(a)];case 3:i=l.sent(),l.label=4;case 4:r=i,l.label=5;case 5:return s=di(r),u=t.map(function(c){return c instanceof co?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var d=c.x,f=c.y,h=c.width,p=c.height,m=Of({width:h,height:p});return di(m).putImageData(s.getImageData(d,f,h,p),0,0),m})]}})})}function cy(e,t){return me(this,void 0,void 0,function(){return ge(this,function(n){if(!Mf(e)&&!wa(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(wa(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ue(function(){var r=e.shape.slice(wa(e)?1:0),o=r[0],a=r[1],i=r[2],s=t.map(function(l){return l instanceof co?l.forSize(a,o).box:l}).map(function(l){return l.clipAtImageBorders(a,o)}),u=s.map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return gS(e.as3D(o,a,i),[d,c,0],[h,f,i])});return u})]})})}function sz(e,t){return me(this,void 0,void 0,function(){var n,r;return ge(this,function(o){switch(o.label){case 0:return n=cn.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function uz(e){return me(this,void 0,void 0,function(){return ge(this,function(t){switch(t.label){case 0:return[4,sz(e)];case 1:return[2,t.sent().json()]}})})}function HS(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),a=e.endsWith(".json")?o[o.length-1]:n,i=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return i=e.startsWith("/")?"/"+i:i,{modelBaseUri:i,manifestUri:i==="/"?"/"+a:i+"/"+a}}function lz(e,t){return me(this,void 0,void 0,function(){var n,r,o,a;return ge(this,function(i){switch(i.label){case 0:return n=HS(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,uz(r)];case 1:return a=i.sent(),[2,MS.loadWeights(a,o)]}})})}var Oo=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,a=r.objProp;o[a].dispose(),o[a]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Ps})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Ps)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,a=qt(o.dataSync());o.dispose(),t.reassignParamFromPath(r,a)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return me(this,void 0,void 0,function(){return ge(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return me(this,void 0,void 0,function(){var n;return ge(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,lz(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return me(this,void 0,void 0,function(){var n,r,o,a,i,s,u,l,c,d;return ge(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=cn.getEnv().readFile,r=HS(t,this.getDefaultModelName()),o=r.manifestUri,a=r.modelBaseUri,i=function(h){return Promise.all(h.map(function(p){return n(p).then(function(m){return m.buffer})}))},s=MS.weightsLoaderFactory(i),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,a)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(a,i){if(!a.nextObj.hasOwnProperty(i))throw new Error("traversePropertyPath - object does not have property "+i+", for path "+t);return{obj:a.nextObj,objProp:i,nextObj:a.nextObj[i]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof dt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function Hn(e,t,n){return ue(function(){var r=Gg(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Me(r,t.bias),r})}function op(e,t,n){return n===void 0&&(n=!1),ue(function(){var r=ft(n?Me(dr(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Hn(e,t.conv0,[2,2])),o=Hn(r,t.conv1,[1,1]),a=ft(Me(r,o)),i=Hn(a,t.conv2,[1,1]);return ft(Me(r,Me(o,i)))})}function gc(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),ue(function(){var o=ft(n?Me(dr(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Hn(e,t.conv0,r?[2,2]:[1,1])),a=Hn(o,t.conv1,[1,1]),i=ft(Me(o,a)),s=Hn(i,t.conv2,[1,1]),u=ft(Me(o,Me(a,s))),l=Hn(u,t.conv3,[1,1]);return ft(Me(o,Me(a,Me(s,l))))})}function Sr(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),ue(function(){var o=Me(dr(e,t.filters,[1,1],n),t.bias);return r?ft(o):o})}function Lo(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Lf(e,t){return function(n,r,o,a){var i=_n(e(n*r*o*o),[o,o,n,r]),s=kt(e(r));return t.push({paramPath:a+"/filters"},{paramPath:a+"/bias"}),{filters:i,bias:s}}}function dy(e,t){return function(n,r,o){var a=ya(e(n*r),[n,r]),i=kt(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:a,bias:i}}}var GS=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function fy(e,t){return function(n,r,o){var a=_n(e(9*n),[3,3,n,1]),i=_n(e(n*r),[1,1,n,r]),s=kt(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new GS(a,i,s)}}function hy(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new GS(n,r,o)}}function Fa(e,t){return function(n,r,o){var a=e[n];if(!Af(a,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+a);return t.push({originalPath:n,paramPath:o||n}),a}}function Bo(e){var t=e;function n(o){var a=t.slice(0,o);return t=t.slice(o),a}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function qS(e,t){var n=Lf(e,t),r=fy(e,t);function o(i,s,u,l){l===void 0&&(l=!1);var c=l?n(i,s,3,u+"/conv0"):r(i,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:d,conv2:f}}function a(i,s,u,l){l===void 0&&(l=!1);var c=o(i,s,u,l),d=c.conv0,f=c.conv1,h=c.conv2,p=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:p}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:a}}function cz(e){var t=[],n=Bo(e),r=n.extractWeights,o=n.getRemainingWeights,a=qS(r,t).extractDenseBlock4Params,i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),u=a(64,128,"dense2"),l=a(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:u,dense3:l}}}function KS(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function YS(e,t){var n=Fa(e,t),r=KS(n),o=hy(n);function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:l,conv1:c,conv2:d}}function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function dz(e){var t=[],n=YS(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Lo(e,t),{params:r,paramMappings:t}}var XS=function(e){_e(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ue(function(){var o=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],i=Ml(o,a).div(ie(255)),s=gc(i,r.dense0,!0);return s=gc(s,r.dense1),s=gc(s,r.dense2),s=gc(s,r.dense3),s=Pl(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return dz(n)},t.prototype.extractParams=function(n){return cz(n)},t}(Oo);function Qr(e,t){return ue(function(){return Me(If(e,t.weights),t.bias)})}function fz(e,t,n){var r=[],o=Bo(e),a=o.extractWeights,i=o.getRemainingWeights,s=dy(a,r),u=s(t,n,"fc");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:r,params:{fc:u}}}function hz(e){var t=[],n=Fa(e,t);function r(a){var i=n(a+"/weights",2),s=n(a+"/bias",1);return{weights:i,bias:s}}var o={fc:r("fc")};return Lo(e,t),{params:o,paramMappings:t}}function QS(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var JS=function(e){_e(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ue(function(){var a=n instanceof zd?r.faceFeatureExtractor.forwardInput(n):n;return Qr(a.as2D(a.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,a=r.paramMappings;this._params=o,this._paramMappings=a},t.prototype.extractClassifierParams=function(n){return fz(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=QS(n),o=r.featureExtractorMap,a=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),hz(a)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),a=o*r+o,i=n.slice(0,n.length-a),s=n.slice(n.length-a);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(s)},t}(Oo),q1=["neutral","happy","sad","angry","fearful","disgusted","surprised"],pz=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);q1.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return q1.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),vz=function(e){_e(t,e);function t(n){return n===void 0&&(n=new XS),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return ue(function(){return Mo(r.runNet(n))})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return me(this,void 0,void 0,function(){var r,o,a,i,s=this;return ge(this,function(u){switch(u.label){case 0:return[4,$t(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Mt(o).map(function(l){return me(s,void 0,void 0,function(){var c;return ge(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return a=u.sent(),o.dispose(),i=a.map(function(l){return new pz(l)}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(JS);function ZS(e,t){var n={expressions:t};return Object.assign({},e,n)}function mz(e){return tz(e)&&e.landmarks instanceof Wd&&e.unshiftedLandmarks instanceof Wd&&e.alignedRect instanceof co}function py(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),a=e.detection.imageDims,i=new co(e.detection.score,o.rescale(a.reverse()),a),s={landmarks:r,unshiftedLandmarks:t,alignedRect:i};return Object.assign({},e,s)}function gz(e,t){var n=Lf(e,t),r=fy(e,t);function o(i,s,u){var l=r(i,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),d=n(i,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function a(i,s){var u=r(i,i,s+"/separable_conv0"),l=r(i,i,s+"/separable_conv1"),c=r(i,i,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:a}}function yz(e,t){var n=[],r=Bo(e),o=r.extractWeights,a=r.getRemainingWeights,i=gz(o,n),s=i.extractConvParams,u=i.extractSeparableConvParams,l=i.extractReductionBlockParams,c=i.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),p={conv_in:d,reduction_block_0:f,reduction_block_1:h},m={};sl(t,0,1).forEach(function(x){m["main_block_"+x]=c(128,"middle_flow/main_block_"+x)});var g=l(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:n,params:{entry_flow:p,middle_flow:m,exit_flow:y}}}function xz(e,t){var n=Fa(e,t),r=KS(n),o=hy(n);function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:a,extractMainBlockParams:i}}function wz(e,t){var n=[],r=xz(e,n),o=r.extractConvParams,a=r.extractSeparableConvParams,i=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=i("entry_flow/reduction_block_0"),c=i("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};sl(t,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=i("exit_flow/reduction_block"),p=a("exit_flow/separable_conv"),m={reduction_block:h,separable_conv:p};return Lo(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:n}}function ek(e,t,n){return Me(dr(e,t.filters,n,"same"),t.bias)}function ap(e,t,n){n===void 0&&(n=!0);var r=n?ft(e):e;return r=Hn(r,t.separable_conv0,[1,1]),r=Hn(ft(r),t.separable_conv1,[1,1]),r=Bt(r,[3,3],[2,2],"same"),r=Me(r,ek(e,t.expansion_conv,[2,2])),r}function bz(e,t){var n=Hn(ft(e),t.separable_conv0,[1,1]);return n=Hn(ft(n),t.separable_conv1,[1,1]),n=Hn(ft(n),t.separable_conv2,[1,1]),n=Me(n,e),n}var Cz=function(e){_e(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return ue(function(){var a=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Ml(a,i).div(ie(256)),u=ft(ek(s,o.entry_flow.conv_in,[2,2]));return u=ap(u,o.entry_flow.reduction_block_0,!1),u=ap(u,o.entry_flow.reduction_block_1),sl(r._numMainBlocks,0,1).forEach(function(l){u=bz(u,o.middle_flow["main_block_"+l])}),u=ap(u,o.exit_flow.reduction_block),u=ft(Hn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return wz(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return yz(n,this._numMainBlocks)},t}(Oo);function Ez(e){var t=[],n=Bo(e),r=n.extractWeights,o=n.getRemainingWeights,a=dy(r,t),i=a(512,1,"fc/age"),s=a(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:i,gender:s}}}}function _z(e){var t=[],n=Fa(e,t);function r(a){var i=n(a+"/weights",2),s=n(a+"/bias",1);return{weights:i,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Lo(e,t),{params:o,paramMappings:t}}var $d;(function(e){e.FEMALE="female",e.MALE="male"})($d||($d={}));var Sz=function(e){_e(t,e);function t(n){n===void 0&&(n=new Cz(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ue(function(){var a=n instanceof zd?r.faceFeatureExtractor.forwardInput(n):n,i=Pl(a,[7,7],[2,2],"valid").as2D(a.shape[0],-1),s=Qr(i,o.fc.age).as1D(),u=Qr(i,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return ue(function(){var o=r.runNet(n),a=o.age,i=o.gender;return{age:a,gender:Mo(i)}})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return me(this,void 0,void 0,function(){var r,o,a,i,s,u,l=this;return ge(this,function(c){switch(c.label){case 0:return[4,$t(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),a=Mt(o.age),i=Mt(o.gender),s=a.map(function(d,f){return{ageTensor:d,genderTensor:i[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return me(l,void 0,void 0,function(){var p,m,g,v,y;return ge(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return p=x.sent()[0],[4,h.data()];case 2:return m=x.sent()[0],g=m>.5,v=g?$d.MALE:$d.FEMALE,y=g?m:1-m,f.dispose(),h.dispose(),[2,{age:p,gender:v,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,a=r.paramMappings;this._params=o,this._paramMappings=a},t.prototype.extractClassifierParams=function(n){return Ez(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=QS(n),o=r.featureExtractorMap,a=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),_z(a)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),a=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(a)},t}(Oo),tk=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var a=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),i=a.length;return ue(function(){var s=function(f,h){return Yn([no([68],f),no([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var p=a[f],m=p.width,g=p.height;return h(m,g)?Math.abs(m-g)/2:0},l=function(f){return u(f,function(h,p){return h<p})},c=function(f){return u(f,function(h,p){return p<h})},d=n.mul(no([i,136],r)).sub(Yn(Array.from(Array(i),function(f,h){return s(l(h),c(h))}))).div(Yn(Array.from(Array(i),function(f,h){return s(a[h].width,a[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return ue(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(a){var i=a[0],s=a[1];return{height:i,width:s}}))})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return me(this,void 0,void 0,function(){var r,o,a,i=this;return ge(this,function(s){switch(s.label){case 0:return[4,$t(n)];case 1:return r=s.sent(),o=ue(function(){return Mt(i.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return me(i,void 0,void 0,function(){var c,d,f,h,p;return ge(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[m.sent()]),h=c.filter(function(g,v){return W1(v)}),p=c.filter(function(g,v){return!W1(v)}),[2,new ez(Array(68).fill(0).map(function(g,v){return new He(h[v],p[v])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return a=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(JS),nk=function(e){_e(t,e);function t(n){return n===void 0&&(n=new XS),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(tk);function kz(e){var t=[],n=YS(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Lo(e,t),{params:r,paramMappings:t}}function Rz(e){var t=[],n=Bo(e),r=n.extractWeights,o=n.getRemainingWeights,a=qS(r,t).extractDenseBlock3Params,i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),u=a(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:u}}}var Nz=function(e){_e(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ue(function(){var o=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],i=Ml(o,a).div(ie(255)),s=op(i,r.dense0,!0);return s=op(s,r.dense1),s=op(s,r.dense2),s=Pl(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return kz(n)},t.prototype.extractParams=function(n){return Rz(n)},t}(Oo),Dz=function(e){_e(t,e);function t(n){return n===void 0&&(n=new Nz),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(tk);(function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(nk);function Iz(e,t){return Me(un(e,t.weights),t.biases)}function vy(e,t,n,r,o){o===void 0&&(o="same");var a=t.conv,i=a.filters,s=a.bias,u=dr(e,i,n,o);return u=Me(u,s),u=Iz(u,t.scale),r?ft(u):u}function Tz(e,t){return vy(e,t,[1,1],!0)}function rk(e,t){return vy(e,t,[1,1],!1)}function ok(e,t){return vy(e,t,[2,2],!0,"valid")}function Pz(e,t){function n(s,u,l){var c=e(s),d=c.length/(u*l*l);if(V6(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return ue(function(){return Na(_n(c,[u,d,l,l]),[2,3,1,0])})}function r(s,u,l,c){var d=n(s,u,l),f=kt(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,u){var l=kt(e(s)),c=kt(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function a(s,u,l,c){var d=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:d,scale:f}}function i(s,u,l,c,d){d===void 0&&(d=!1);var f=a((d?.5:1)*s,u,l,c+"/conv1"),h=a(s,u,l,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function Az(e){var t=Bo(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],a=Pz(n,o),i=a.extractConvLayerParams,s=a.extractResidualLayerParams,u=i(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),E=s(589824,256,3,"conv256_down_out"),S=ue(function(){return Na(ya(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var _={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:x,conv256_1:w,conv256_2:b,conv256_down_out:E,fc:S};return{params:_,paramMappings:o}}function Mz(e,t){var n=Fa(e,t);function r(i){var s=n(i+"/scale/weights",1),u=n(i+"/scale/biases",1);return{weights:s,biases:u}}function o(i){var s=n(i+"/conv/filters",4),u=n(i+"/conv/bias",1),l=r(i);return{conv:{filters:s,bias:u},scale:l}}function a(i){return{conv1:o(i+"/conv1"),conv2:o(i+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:a}}function Fz(e){var t=[],n=Mz(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,a=r("conv32_down"),i=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),p=o("conv128_1"),m=o("conv128_2"),g=o("conv256_down"),v=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!U6(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var b={conv32_down:a,conv32_1:i,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:p,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:x,fc:w};return Lo(e,t),{params:b,paramMappings:t}}function Br(e,t){var n=Tz(e,t.conv1);return n=rk(n,t.conv2),n=Me(n,e),n=ft(n),n}function yc(e,t){var n=ok(e,t.conv1);n=rk(n,t.conv2);var r=Pl(e,2,2,"valid"),o=st(r.shape),a=r.shape[3]!==n.shape[3],i=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(i){var s=Du(n.shape);s[1]=1;var u=st(s);n=At([n,u],1);var l=Du(n.shape);l[2]=1;var c=st(l);n=At([n,c],2)}return r=a?At([r,o],3):r,n=Me(r,n),n=ft(n),n}var Oz=function(e){_e(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ue(function(){var o=n.toBatchTensor(150,!0).toFloat(),a=[122.782,117.001,104.298],i=Ml(o,a).div(ie(256)),s=ok(i,r.conv32_down);s=Bt(s,3,2,"valid"),s=Br(s,r.conv32_1),s=Br(s,r.conv32_2),s=Br(s,r.conv32_3),s=yc(s,r.conv64_down),s=Br(s,r.conv64_1),s=Br(s,r.conv64_2),s=Br(s,r.conv64_3),s=yc(s,r.conv128_down),s=Br(s,r.conv128_1),s=Br(s,r.conv128_2),s=yc(s,r.conv256_down),s=Br(s,r.conv256_1),s=Br(s,r.conv256_2),s=yc(s,r.conv256_down_out);var u=s.mean([1,2]),l=If(u,r.fc);return l})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return me(this,void 0,void 0,function(){var r,o,a,i=this;return ge(this,function(s){switch(s.label){case 0:return[4,$t(n)];case 1:return r=s.sent(),o=ue(function(){return Mt(i.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return a=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Fz(n)},t.prototype.extractParams=function(n){return Az(n)},t}(Oo);function ak(e,t){var n={descriptor:t};return Object.assign({},e,n)}function ik(e,t){var n={age:t};return Object.assign({},e,n)}function sk(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var uk=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,a=n.maxNumScales,i=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=a||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Lz(e,t){function n(u,l){var c=_n(e(9*u),[3,3,u,1]),d=kt(e(u)),f=kt(e(u)),h=kt(e(u)),p=kt(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:p}}function r(u,l,c,d,f){var h=_n(e(u*l*c*c),[c,c,u,l]),p=kt(e(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function o(u,l,c,d){var f=r(u,l,c,d,!0),h=f.filters,p=f.bias;return{filters:h,batch_norm_offset:p}}function a(u,l,c){var d=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function i(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=a(32,64,"mobilenetv1/conv_1"),c=a(64,128,"mobilenetv1/conv_2"),d=a(128,128,"mobilenetv1/conv_3"),f=a(128,256,"mobilenetv1/conv_4"),h=a(256,256,"mobilenetv1/conv_5"),p=a(256,512,"mobilenetv1/conv_6"),m=a(512,512,"mobilenetv1/conv_7"),g=a(512,512,"mobilenetv1/conv_8"),v=a(512,512,"mobilenetv1/conv_9"),y=a(512,512,"mobilenetv1/conv_10"),x=a(512,512,"mobilenetv1/conv_11"),w=a(512,1024,"mobilenetv1/conv_12"),b=a(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,conv_8:g,conv_9:v,conv_10:y,conv_11:x,conv_12:w,conv_13:b}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),p=o(256,64,1,"prediction_layer/conv_6"),m=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),b=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),E=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),N=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),A=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),T={box_encoding_predictor:g,class_predictor:v},L={box_encoding_predictor:y,class_predictor:x},M={box_encoding_predictor:w,class_predictor:b},$={box_encoding_predictor:E,class_predictor:S},U={box_encoding_predictor:_,class_predictor:k},j={box_encoding_predictor:N,class_predictor:A};return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:p,conv_7:m,box_predictor_0:T,box_predictor_1:L,box_predictor_2:M,box_predictor_3:$,box_predictor_4:U,box_predictor_5:j}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:s}}function Bz(e){var t=[],n=Bo(e),r=n.extractWeights,o=n.getRemainingWeights,a=Lz(r,t),i=a.extractMobilenetV1Params,s=a.extractPredictionLayerParams,u=i(),l=s(),c=Tg(r(5118*4),[1,5118,4]),d={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:t}}function jz(e,t){var n=Fa(e,t);function r(l,c,d){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",p=n(d+"/depthwise_weights",4,f+"/filters"),m=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:p,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function a(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function i(l,c){var d=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(l){var c=i("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=i("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:u}}function Wz(e){var t=[],n=jz(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Mf(a))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+a);var i={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:a}};return Lo(e,t),{params:i,paramMappings:t}}function Wr(e,t,n){return ue(function(){var r=dr(e,t.filters,n,"same");return r=Me(r,t.batch_norm_offset),$g(r,0,6)})}var zz=.0010000000474974513;function $z(e,t,n){return ue(function(){var r=Df(e,t.filters,n,"same");return r=nS(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,zz),$g(r,0,6)})}function Uz(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function Vz(e,t){return ue(function(){var n=null,r=Wr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(a,i){var s=i+1,u=Uz(s);r=$z(r,a.depthwise_conv,u),r=Wr(r,a.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Hz(e,t,n,r,o){var a=e.shape[0],i=Math.min(n,a),s=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=i)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=Gz(e,c.boxIndex,l[f]);if(h!==0&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}function Gz(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),a=Math.min(r[t][1],r[t][3]),i=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(i-o)*(s-a),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var p=Math.max(o,u),m=Math.max(a,l),g=Math.min(i,c),v=Math.min(s,d),y=Math.max(g-p,0)*Math.max(v-m,0);return y/(f+h-y)}function qz(e){var t=Mt(Na(e,[1,0])),n=[Ot(t[2],t[0]),Ot(t[3],t[1])],r=[Me(t[0],xr(n[0],ie(2))),Me(t[1],xr(n[1],ie(2)))];return{sizes:n,centers:r}}function Kz(e,t){var n=qz(e),r=n.sizes,o=n.centers,a=Mt(Na(t,[1,0])),i=xr(un(Wv(xr(a[2],ie(5))),r[0]),ie(2)),s=Me(un(xr(a[0],ie(10)),r[0]),o[0]),u=xr(un(Wv(xr(a[3],ie(5))),r[1]),ie(2)),l=Me(un(xr(a[1],ie(10)),r[1]),o[1]);return Na(Yn([Ot(s,i),Ot(l,u),Me(s,i),Me(l,u)]),[1,0])}function Yz(e,t,n){return ue(function(){var r=e.shape[0],o=Kz(Cr(os(n.extra_dim,[r,1,1]),[-1,4]),Cr(e,[-1,4]));o=Cr(o,[r,o.shape[0]/r,4]);var a=J_(oo(t,[0,0,1],[-1,-1,-1])),i=oo(a,[0,0,0],[-1,-1,1]);i=Cr(i,[r,i.shape[1]]);var s=Mt(o),u=Mt(i);return{boxes:s,scores:u}})}function Di(e,t){return ue(function(){var n=e.shape[0],r=Cr(Sr(e,t.box_encoding_predictor),[n,-1,1,4]),o=Cr(Sr(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function Xz(e,t,n){return ue(function(){var r=Wr(e,n.conv_0,[1,1]),o=Wr(r,n.conv_1,[2,2]),a=Wr(o,n.conv_2,[1,1]),i=Wr(a,n.conv_3,[2,2]),s=Wr(i,n.conv_4,[1,1]),u=Wr(s,n.conv_5,[2,2]),l=Wr(u,n.conv_6,[1,1]),c=Wr(l,n.conv_7,[2,2]),d=Di(t,n.box_predictor_0),f=Di(e,n.box_predictor_1),h=Di(o,n.box_predictor_2),p=Di(i,n.box_predictor_3),m=Di(u,n.box_predictor_4),g=Di(c,n.box_predictor_5),v=At([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),y=At([d.classPrediction,f.classPrediction,h.classPrediction,p.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Bf=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),lk=function(e){_e(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ue(function(){var o=n.toBatchTensor(512,!1).toFloat(),a=Ot(un(o,ie(.007843137718737125)),ie(1)),i=Vz(a,r.mobilenetv1),s=Xz(i.out,i.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return Yz(u,l,r.output_layer)})},t.prototype.forward=function(n){return me(this,void 0,void 0,function(){var r;return ge(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,$t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),me(this,void 0,void 0,function(){var o,a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S,_;return ge(this,function(k){switch(k.label){case 0:return o=new Bf(r),a=o.maxResults,i=o.minConfidence,[4,$t(n)];case 1:for(s=k.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,d=l[0],f=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return g=(m=Array).from,[4,f.data()];case 2:return p=g.apply(m,[k.sent()]),v=.5,y=Hz(d,p,a,v,i),x=s.getReshapedInputDimensions(0),w=s.inputSize,b=w/x.width,E=w/x.height,S=d.arraySync(),_=y.map(function(N){var A=[Math.max(0,S[N][0]),Math.min(1,S[N][2])].map(function(j){return j*E}),T=A[0],L=A[1],M=[Math.max(0,S[N][1]),Math.min(1,S[N][3])].map(function(j){return j*b}),$=M[0],U=M[1];return new co(p[N],new ay($,T,U-$,L-T),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,_]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Wz(n)},t.prototype.extractParams=function(n){return Bz(n)},t}(Oo);(function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(lk);var Qz=.4,Jz=[new He(.738768,.874946),new He(2.42204,2.65704),new He(4.30971,7.04493),new He(10.246,4.59428),new He(12.6868,11.8741)],Zz=[new He(1.603231,2.094468),new He(6.041143,7.080126),new He(2.882459,3.518061),new He(4.266906,5.178857),new He(9.041765,10.66308)],e$=[117.001,114.697,97.404],t$="tiny_yolov2_model",n$="tiny_yolov2_separable_conv_model",xc=function(e){return typeof e=="number"};function r$(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!xc(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return xc(t.x)&&xc(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(xc)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function my(e){return ue(function(){var t=un(e,ie(.10000000149011612));return Me(ft(Ot(e,t)),t)})}function Uo(e,t){return ue(function(){var n=gi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=dr(n,t.conv.filters,[1,1],"valid"),n=Ot(n,t.bn.sub),n=un(n,t.bn.truediv),n=Me(n,t.conv.bias),my(n)})}function Vo(e,t){return ue(function(){var n=gi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Gg(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Me(n,t.bias),my(n)})}function o$(e,t){var n=Lf(e,t);function r(i,s){var u=kt(e(i)),l=kt(e(i));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(i,s,u){var l=n(i,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var a=fy(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:a}}function a$(e,t,n,r){var o=Bo(e),a=o.extractWeights,i=o.getRemainingWeights,s=[],u=o$(a,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],x=r[6],w=r[7],b=r[8],E=t.isFirstLayerConv2d?l(h,p,3,"conv0"):d(h,p,"conv0"),S=d(p,m,"conv1"),_=d(m,g,"conv2"),k=d(g,v,"conv3"),N=d(v,y,"conv4"),A=d(y,x,"conv5"),T=w?d(x,w,"conv6"):void 0,L=b?d(w,b,"conv7"):void 0,M=l(b||w||x,5*n,1,"conv8");f={conv0:E,conv1:S,conv2:_,conv3:k,conv4:N,conv5:A,conv6:T,conv7:L,conv8:M}}else{var h=r[0],p=r[1],m=r[2],g=r[3],v=r[4],y=r[5],x=r[6],w=r[7],b=r[8],E=c(h,p,"conv0"),S=c(p,m,"conv1"),_=c(m,g,"conv2"),k=c(g,v,"conv3"),N=c(v,y,"conv4"),A=c(y,x,"conv5"),T=c(x,w,"conv6"),L=c(w,b,"conv7"),M=l(b,5*n,1,"conv8");f={conv0:E,conv1:S,conv2:_,conv3:k,conv4:N,conv5:A,conv6:T,conv7:L,conv8:M}}if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:f,paramMappings:s}}function i$(e,t){var n=Fa(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function a(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var i=hy(n);return{extractConvParams:o,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function s$(e,t){var n=[],r=i$(e,n),o=r.extractConvParams,a=r.extractConvWithBatchNormParams,i=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:u>7?i("conv6"):void 0,conv7:u>8?i("conv7"):void 0,conv8:o("conv8")}}else s={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:o("conv8")};return Lo(e,n),{params:s,paramMappings:n}}var K1;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(K1||(K1={}));var gy=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),ck=function(e){_e(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return r$(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=Uo(n,r.conv0);return o=Bt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv1),o=Bt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv2),o=Bt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv3),o=Bt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv4),o=Bt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv5),o=Bt(o,[2,2],[1,1],"same"),o=Uo(o,r.conv6),o=Uo(o,r.conv7),Sr(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?my(Sr(n,r.conv0,"valid",!1)):Vo(n,r.conv0);return o=Bt(o,[2,2],[2,2],"same"),o=Vo(o,r.conv1),o=Bt(o,[2,2],[2,2],"same"),o=Vo(o,r.conv2),o=Bt(o,[2,2],[2,2],"same"),o=Vo(o,r.conv3),o=Bt(o,[2,2],[2,2],"same"),o=Vo(o,r.conv4),o=Bt(o,[2,2],[2,2],"same"),o=Vo(o,r.conv5),o=Bt(o,[2,2],[1,1],"same"),o=r.conv6?Vo(o,r.conv6):o,o=r.conv7?Vo(o,r.conv7):o,Sr(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,a=this.params;if(!a)throw new Error("TinyYolov2 - load model before inference");return ue(function(){var i=n.toBatchTensor(r,!1).toFloat();return i=o.config.meanRgb?Ml(i,o.config.meanRgb):i,i=i.div(ie(256)),o.config.withSeparableConvs?o.runMobilenet(i,a):o.runTinyYolov2(i,a)})},t.prototype.forward=function(n,r){return me(this,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return o=this.forwardInput,[4,$t(n)];case 1:return[4,o.apply(this,[a.sent(),r])];case 2:return[2,a.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),me(this,void 0,void 0,function(){var o,a,i,s,u,l,c,d,f,h,p,m,g,v,y=this;return ge(this,function(x){switch(x.label){case 0:return o=new gy(r),a=o.inputSize,i=o.scoreThreshold,[4,$t(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,a)];case 2:return u=x.sent(),l=ue(function(){return Mt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),i)];case 3:return d=x.sent(),u.dispose(),l.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),p=d.map(function(w){return w.classScore}),m=d.map(function(w){return y.config.classes[w.label]}),g=ul(f.map(function(w){return w.rescale(a)}),h,this.config.iouThreshold,!0),v=g.map(function(w){return new OS(h[w],p[w],m[w],f[w],c)}),[2,v]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return s$(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return a$(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return me(this,void 0,void 0,function(){var a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S,_,k,N,A,T,L,M,$,U,j,D=this;return ge(this,function(F){switch(F.label){case 0:return a=r.width,i=r.height,s=Math.max(a,i),u=s/a,l=s/i,c=n.shape[1],d=this.config.anchors.length,f=ue(function(){var z=n.reshape([c,c,d,D.boxEncodingSize]),H=z.slice([0,0,0,0],[c,c,d,4]),X=z.slice([0,0,0,4],[c,c,d,1]),ee=D.withClassScores?Mo(z.slice([0,0,0,5],[c,c,d,D.config.classes.length]),3):ie(0);return[H,X,ee]}),h=f[0],p=f[1],m=f[2],g=[],[4,p.array()];case 1:return v=F.sent(),[4,h.array()];case 2:y=F.sent(),x=0,F.label=3;case 3:if(!(x<c))return[3,12];w=0,F.label=4;case 4:if(!(w<c))return[3,11];b=0,F.label=5;case 5:return b<d?(E=rp(v[x][w][b][0]),!o||E>o?(S=(w+rp(y[x][w][b][0]))/c*u,_=(x+rp(y[x][w][b][1]))/c*l,k=Math.exp(y[x][w][b][2])*this.config.anchors[b].x/c*u,N=Math.exp(y[x][w][b][3])*this.config.anchors[b].y/c*l,A=S-k/2,T=_-N/2,L={row:x,col:w,anchor:b},this.withClassScores?[4,this.extractPredictedClass(m,L)]:[3,7]):[3,9]):[3,10];case 6:return j=F.sent(),[3,8];case 7:j={classScore:1,label:0},F.label=8;case 8:M=j,$=M.classScore,U=M.label,g.push(on({box:new Ff(A,T,A+k,T+N),score:E,classScore:E*$,label:U},L)),F.label=9;case 9:return b++,[3,5];case 10:return w++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),p.dispose(),m.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return me(this,void 0,void 0,function(){var o,a,i,s;return ge(this,function(u){switch(u.label){case 0:return o=r.row,a=r.col,i=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][a][i][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Oo),u$=function(e){_e(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:Qz,classes:["face"]},n?{anchors:Zz,meanRgb:e$}:{anchors:Jz,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return me(this,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return[4,this.detect(n,r)];case 1:return o=a.sent(),[2,o.map(function(i){return new co(i.score,i.relativeBox,{width:i.imageWidth,height:i.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?n$:t$},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(ck),dk=function(e){_e(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(gy),Fl=function(){function e(){}return e.prototype.then=function(t){return me(this,void 0,void 0,function(){var n;return ge(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return me(this,void 0,void 0,function(){return ge(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function jf(e,t,n,r,o){return o===void 0&&(o=function(a){var i=a.alignedRect;return i}),me(this,void 0,void 0,function(){var a,i,s,u,l;return ge(this,function(c){switch(c.label){case 0:return a=e.map(function(d){return mz(d)?o(d):d.detection}),s=r,s?[3,5]:t instanceof dt?[4,cy(t,a)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,ly(t,a)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return i=s,[4,n(i)];case 6:return l=c.sent(),i.forEach(function(d){return d instanceof dt&&d.dispose()}),[2,l]}})})}function yy(e,t,n,r,o){return me(this,void 0,void 0,function(){var a=this;return ge(this,function(i){return[2,jf([e],t,function(s){return me(a,void 0,void 0,function(){return ge(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function l$(e){return ue(function(){return Yn(Mt(e,3).reverse(),3)})}var wc=2,Ud=12;function c$(e,t){var n=Lf(e,t),r=dy(e,t);function o(l,c){var d=kt(e(l));return t.push({paramPath:c}),d}function a(l,c,d){d===void 0&&(d=!1);var f=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),p=n(l[1],l[2],3,c+"/conv2"),m=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],d?2:3,c+"/conv3"),v=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:p,prelu2_alpha:m,conv3:g,prelu3_alpha:v}}function i(){var l=a([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return on(on({},l),{conv4_1:c,conv4_2:d})}function s(){var l=a([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return on(on({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var l=a([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return on(on({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:p,fc2_2:m,fc2_3:g})}return{extractPNetParams:i,extractRNetParams:s,extractONetParams:u}}function d$(e){var t=Bo(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],a=c$(n,o),i=a.extractPNetParams,s=a.extractRNetParams,u=a.extractONetParams,l=i(),c=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}function f$(e,t){var n=Fa(e,t);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function a(c){return n(c,1)}function i(c){var d=r(c+"/conv1"),f=a(c+"/prelu1_alpha"),h=r(c+"/conv2"),p=a(c+"/prelu2_alpha"),m=r(c+"/conv3"),g=a(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:p,conv3:m,prelu3_alpha:g}}function s(){var c=i("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return on(on({},c),{conv4_1:d,conv4_2:f})}function u(){var c=i("rnet"),d=o("rnet/fc1"),f=a("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),p=o("rnet/fc2_2");return on(on({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:p})}function l(){var c=i("onet"),d=r("onet/conv4"),f=a("onet/prelu4_alpha"),h=o("onet/fc1"),p=a("onet/prelu5_alpha"),m=o("onet/fc2_1"),g=o("onet/fc2_2"),v=o("onet/fc2_3");return on(on({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:p,fc2_1:m,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function h$(e){var t=[],n=f$(e,t),r=n.extractPNetParams,o=n.extractRNetParams,a=n.extractONetParams,i=r(),s=o(),u=a();return Lo(e,t),{params:{pnet:i,rnet:s,onet:u},paramMappings:t}}function Kv(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function p$(e,t,n){for(var r=n[0],o=n[1],a=Ud/e,i=[],s=Math.min(r,o)*a,u=0;s>=12;)i.push(a*Math.pow(t,u)),s=s*t,u+=1;return i}var xy=function(e){_e(t,e);function t(n,r,o,a){return e.call(this,{left:n,top:r,right:o,bottom:a},!0)||this}return t}(Da);function fk(e){return ue(function(){return un(Ot(e,ie(127.5)),ie(.0078125))})}function cs(e,t){return ue(function(){return Me(ft(e),un(t,Od(ft(Od(e)))))})}function wy(e,t,n){return n===void 0&&(n=!1),ue(function(){var r=Sr(e,t.conv1,"valid");return r=cs(r,t.prelu1_alpha),r=Bt(r,n?[2,2]:[3,3],[2,2],"same"),r=Sr(r,t.conv2,"valid"),r=cs(r,t.prelu2_alpha),r=n?r:Bt(r,[3,3],[2,2],"valid"),r=Sr(r,t.conv3,"valid"),r=cs(r,t.prelu3_alpha),r})}function v$(e,t){return ue(function(){var n=wy(e,t,!0),r=Sr(n,t.conv4_1,"valid"),o=rr(Tf(r,3),3),a=Mo(Ot(r,o),3),i=Sr(n,t.conv4_2,"valid");return{prob:a,regions:i}})}function m$(e,t){return ue(function(){var n=Kv(t,e.shape.slice(1)),r=n.height,o=n.width,a=Qg.resizeBilinear(e,[r,o]),i=fk(a);return Na(i,[0,2,1,3])})}function g$(e,t,n,r){for(var o=[],a=e.arraySync(),i=0;i<e.shape[0];i++)for(var s=0;s<e.shape[1];s++)a[i][s]>=r&&o.push(new He(s,i));var u=o.map(function(l){var c=new Ff(Math.round((l.y*wc+1)/n),Math.round((l.x*wc+1)/n),Math.round((l.y*wc+Ud)/n),Math.round((l.x*wc+Ud)/n)),d=a[l.y][l.x],f=t.arraySync(),h=new xy(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:d,region:h}});return u}function y$(e,t,n,r,o){o.stage1=[];var a=t.map(function(f){return ue(function(){var h={scale:f},p=m$(e,f),m=Date.now(),g=v$(p,r),v=g.prob,y=g.regions;h.pnet=Date.now()-m;var x=Mt(Mt(v,3)[1])[0],w=Mt(y)[0];return{scoresTensor:x,regionsTensor:w,scale:f,statsForScale:h}})}),i=a.map(function(f){var h=f.scoresTensor,p=f.regionsTensor,m=f.scale,g=f.statsForScale,v=g$(h,p,m,n);if(h.dispose(),p.dispose(),!v.length)return o.stage1.push(g),[];var y=Date.now(),x=ul(v.map(function(w){return w.cell}),v.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(w){return v[w]})}),s=i.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),d=ul(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,p=f.region;return new Ff(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function hk(e,t,n){var r=n.width,o=n.height;return me(this,void 0,void 0,function(){var a,i,s,u=this;return ge(this,function(l){switch(l.label){case 0:return a=di(e),[4,Promise.all(t.map(function(c){return me(u,void 0,void 0,function(){var d,f,h,p,m,g,v,y;return ge(this,function(x){return d=c.padAtBorders(e.height,e.width),f=d.y,h=d.ey,p=d.x,m=d.ex,g=p-1,v=f-1,y=a.getImageData(g,v,m-g,h-v),[2,cn.isNodejs()?uy(y):createImageBitmap(y)]})})}))];case 1:return i=l.sent(),s=[],i.forEach(function(c){var d=Of({width:r,height:o}),f=di(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,p=[],m=0;m<h.length;m+=4)p.push(h[m+2]),p.push(h[m+1]),p.push(h[m]);s.push(p)}),[2,s.map(function(c){var d=ue(function(){var f=Na(_n(c,[1,r,o,3]),[0,2,1,3]).toFloat();return fk(f)});return d})]}})})}function x$(e,t){return ue(function(){var n=wy(e,t),r=Cr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Qr(r,t.fc1),a=cs(o,t.prelu4_alpha),i=Qr(a,t.fc2_1),s=rr(Tf(i,1),1),u=Mo(Ot(i,s),1),l=Qr(a,t.fc2_2),c=Mt(u,1)[1];return{scores:c,regions:l}})}function w$(e,t,n,r,o){return me(this,void 0,void 0,function(){var a,i,s,u,l,c,d,f,h,p,m,g,v,y;return ge(this,function(x){switch(x.label){case 0:return a=Date.now(),[4,hk(e,t,{width:24,height:24})];case 1:return i=x.sent(),o.stage2_extractImagePatches=Date.now()-a,a=Date.now(),s=i.map(function(w){var b=x$(w,r);return w.dispose(),b}),o.stage2_rnet=Date.now()-a,u=s.length>1?At(s.map(function(w){return w.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[x.sent()]),u.dispose(),f=l.map(function(w,b){return{score:w,idx:b}}).filter(function(w){return w.score>n}).map(function(w){var b=w.idx;return b}),h=f.map(function(w){return t[w]}),p=f.map(function(w){return l[w]}),m=[],g=[],h.length>0&&(a=Date.now(),v=ul(h,p,.7),o.stage2_nms=Date.now()-a,y=v.map(function(w){var b=s[f[w]].regions.arraySync();return new xy(b[0][0],b[0][1],b[0][2],b[0][3])}),g=v.map(function(w){return p[w]}),m=v.map(function(w,b){return h[w].calibrate(y[b])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function b$(e,t){return ue(function(){var n=wy(e,t);n=Bt(n,[2,2],[2,2],"same"),n=Sr(n,t.conv4,"valid"),n=cs(n,t.prelu4_alpha);var r=Cr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Qr(r,t.fc1),a=cs(o,t.prelu5_alpha),i=Qr(a,t.fc2_1),s=rr(Tf(i,1),1),u=Mo(Ot(i,s),1),l=Qr(a,t.fc2_2),c=Qr(a,t.fc2_3),d=Mt(u,1)[1];return{scores:d,regions:l,points:c}})}function C$(e,t,n,r,o){return me(this,void 0,void 0,function(){var a,i,s,u,l,c,d,f,h,p,m,g,v,y,x;return ge(this,function(w){switch(w.label){case 0:return a=Date.now(),[4,hk(e,t,{width:48,height:48})];case 1:return i=w.sent(),o.stage3_extractImagePatches=Date.now()-a,a=Date.now(),s=i.map(function(b){var E=b$(b,r);return b.dispose(),E}),o.stage3_onet=Date.now()-a,u=s.length>1?At(s.map(function(b){return b.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[w.sent()]),u.dispose(),f=l.map(function(b,E){return{score:b,idx:E}}).filter(function(b){return b.score>n}).map(function(b){var E=b.idx;return E}),h=f.map(function(b){var E=s[b].regions.arraySync();return new xy(E[0][0],E[0][1],E[0][2],E[0][3])}),p=f.map(function(b,E){return t[b].calibrate(h[E])}),m=f.map(function(b){return l[b]}),g=[],v=[],y=[],p.length>0&&(a=Date.now(),x=ul(p,m,.7,!1),o.stage3_nms=Date.now()-a,g=x.map(function(b){return p[b]}),v=x.map(function(b){return m[b]}),y=x.map(function(b,E){return Array(5).fill(0).map(function(S,_){var k=s[b].points.arraySync();return new He(k[0][_]*(g[E].width+1)+g[E].left,k[0][_+5]*(g[E].height+1)+g[E].top)})})),s.forEach(function(b){b.regions.dispose(),b.scores.dispose(),b.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var E$=function(e){_e(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return me(this,void 0,void 0,function(){return ge(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return me(this,void 0,void 0,function(){return ge(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),me(this,void 0,void 0,function(){var o,a,i,s,u,l,c,d,f,h,p,m,g,v,y,x,w,b,E,S,_;return ge(this,function(k){switch(k.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(a=n.canvases[0],!a)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return i={},s=Date.now(),u=ue(function(){return l$(rr(ry.fromPixels(a)).toFloat())}),l=function(N){return u.dispose(),i.total=Date.now()-s,N},c=u.shape.slice(1),d=c[0],f=c[1],h=new uk(r),p=h.minFaceSize,m=h.scaleFactor,g=h.maxNumScales,v=h.scoreThresholds,y=h.scaleSteps,x=(y||p$(p,m,[d,f])).filter(function(N){var A=Kv(N,[d,f]);return Math.min(A.width,A.height)>Ud}).slice(0,g),i.scales=x,i.pyramid=x.map(function(N){return Kv(N,[d,f])}),w=Date.now(),[4,y$(u,x,v[0],o.pnet,i)];case 1:return b=k.sent(),i.total_stage1=Date.now()-w,b.boxes.length?(i.stage2_numInputBoxes=b.boxes.length,w=Date.now(),[4,w$(a,b.boxes,v[1],o.rnet,i)]):[2,l({results:[],stats:i})];case 2:return E=k.sent(),i.total_stage2=Date.now()-w,E.boxes.length?(i.stage3_numInputBoxes=E.boxes.length,w=Date.now(),[4,C$(a,E.boxes,v[2],o.onet,i)]):[2,l({results:[],stats:i})];case 3:return S=k.sent(),i.total_stage3=Date.now()-w,_=S.boxes.map(function(N,A){return py(iy({},new co(S.scores[A],new ay(N.left/f,N.top/d,N.width/f,N.height/d),{height:d,width:f})),new Z6(S.points[A].map(function(T){return T.sub(new He(N.left,N.top)).div(new He(N.width,N.height))}),{width:N.width,height:N.height}))}),[2,l({results:_,stats:i})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),me(this,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return o=this.forwardInput,[4,$t(n)];case 1:return[4,o.apply(this,[a.sent(),r])];case 2:return[2,a.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),me(this,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return o=this.forwardInput,[4,$t(n)];case 1:return[2,o.apply(this,[a.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return h$(n)},t.prototype.extractParams=function(n){return d$(n)},t}(Oo),_$=.4,S$=[new He(1.603231,2.094468),new He(6.041143,7.080126),new He(2.882459,3.518061),new He(4.266906,5.178857),new He(9.041765,10.66308)],k$=[117.001,114.697,97.404],R$=function(e){_e(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:_$,classes:["face"],anchors:S$,meanRgb:k$,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return me(this,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return[4,this.detect(n,r)];case 1:return o=a.sent(),[2,o.map(function(i){return new co(i.score,i.relativeBox,{width:i.imageWidth,height:i.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(ck),gn={ssdMobilenetv1:new lk,tinyFaceDetector:new R$,tinyYolov2:new u$,mtcnn:new E$,faceLandmark68Net:new nk,faceLandmark68TinyNet:new Dz,faceRecognitionNet:new Oz,faceExpressionNet:new vz,ageGenderNet:new Sz},pk=function(e){_e(t,e);function t(n,r,o){var a=e.call(this)||this;return a.parentTask=n,a.input=r,a.extractedFaces=o,a}return t}(Fl),by=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o=this;return ge(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return n=a.sent(),[4,jf(n,this.input,function(i){return me(o,void 0,void 0,function(){return ge(this,function(s){switch(s.label){case 0:return[4,Promise.all(i.map(function(u){return gn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=a.sent(),[2,n.map(function(i,s){return ZS(i,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new Sy(this,this.input)},t}(pk),Cy=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r;return ge(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,yy(n,this.input,function(a){return gn.faceExpressionNet.predictExpressions(a)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,ZS(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new ky(this,this.input)},t}(pk),Ey=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Ry(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Dy(this,this.input)},t}(by),_y=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Ny(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Iy(this,this.input)},t}(Cy),vk=function(e){_e(t,e);function t(n,r,o){var a=e.call(this)||this;return a.parentTask=n,a.input=r,a.extractedFaces=o,a}return t}(Fl),Sy=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o=this;return ge(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return n=a.sent(),[4,jf(n,this.input,function(i){return me(o,void 0,void 0,function(){return ge(this,function(s){switch(s.label){case 0:return[4,Promise.all(i.map(function(u){return gn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=a.sent(),[2,n.map(function(i,s){var u=r[s],l=u.age,c=u.gender,d=u.genderProbability;return ik(sk(i,c,d),l)})]}})})},t.prototype.withFaceExpressions=function(){return new by(this,this.input)},t}(vk),ky=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o,a,i;return ge(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,yy(n,this.input,function(u){return gn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,a=r.gender,i=r.genderProbability,[2,ik(sk(n,a,i),o)]}})})},t.prototype.withFaceExpressions=function(){return new Cy(this,this.input)},t}(vk),Ry=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Ey(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Dy(this,this.input)},t}(Sy),Ny=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new _y(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Iy(this,this.input)},t}(ky),mk=function(e){_e(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(Fl),Dy=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r;return ge(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,jf(n,this.input,function(a){return Promise.all(a.map(function(i){return gn.faceRecognitionNet.computeFaceDescriptor(i)}))},null,function(a){return a.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(a,i){return ak(n[i],a)})]}})})},t.prototype.withFaceExpressions=function(){return new Ey(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ry(this,this.input)},t}(mk),Iy=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r;return ge(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,yy(n,this.input,function(a){return gn.faceRecognitionNet.computeFaceDescriptor(a)},null,function(a){return a.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,ak(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new _y(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ny(this,this.input)},t}(mk),gk=function(e){_e(t,e);function t(n,r,o){var a=e.call(this)||this;return a.parentTask=n,a.input=r,a.useTinyLandmarkNet=o,a}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?gn.faceLandmark68TinyNet:gn.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Fl),N$=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o,a,i,s=this;return ge(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof dt?[4,cy(this.input,r)]:[3,3];case 2:return a=u.sent(),[3,5];case 3:return[4,ly(this.input,r)];case 4:a=u.sent(),u.label=5;case 5:return o=a,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return i=u.sent(),o.forEach(function(l){return l instanceof dt&&l.dispose()}),[2,n.map(function(l,c){return py(l,i[c])})]}})})},t.prototype.withFaceExpressions=function(){return new Ey(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ry(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Dy(this,this.input)},t}(gk),D$=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o,a,i;return ge(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof dt?[4,cy(this.input,[r])]:[3,3]):[2];case 2:return a=s.sent(),[3,5];case 3:return[4,ly(this.input,[r])];case 4:a=s.sent(),s.label=5;case 5:return o=a,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return i=s.sent(),o.forEach(function(u){return u instanceof dt&&u.dispose()}),[2,py(n,i)]}})})},t.prototype.withFaceExpressions=function(){return new _y(this,this.input)},t.prototype.withAgeAndGender=function(){return new Ny(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Iy(this,this.input)},t}(gk),yk=function(e){_e(t,e);function t(n,r){r===void 0&&(r=new Bf);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(Fl),xk=function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r,o,a;return ge(this,function(i){switch(i.label){case 0:return n=this,r=n.input,o=n.options,o instanceof uk?[4,gn.mtcnn.forward(r,o)]:[3,2];case 1:return[2,i.sent().map(function(s){return s.detection})];case 2:if(a=o instanceof dk?function(s){return gn.tinyFaceDetector.locateFaces(s,o)}:o instanceof Bf?function(s){return gn.ssdMobilenetv1.locateFaces(s,o)}:o instanceof gy?function(s){return gn.tinyYolov2.locateFaces(s,o)}:null,!a)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,a(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return me(n,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return[4,this.run()];case 1:return o=a.sent(),[2,r(o.map(function(i){return iy({},i)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new N$(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new by(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Sy(this.runAndExtendWithFaceDetections(),this.input)},t}(yk);(function(e){_e(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return me(this,void 0,void 0,function(){var n,r;return ge(this,function(o){switch(o.label){case 0:return[4,new xk(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(a){a.score>r.score&&(r=a)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return me(n,void 0,void 0,function(){var o;return ge(this,function(a){switch(a.label){case 0:return[4,this.run()];case 1:return o=a.sent(),[2,r(o?iy({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new D$(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Cy(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new ky(this.runAndExtendWithFaceDetection(),this.input)},t})(yk);function I$(e,t){return t===void 0&&(t=new Bf),new xk(e,t)}function T$(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,a){return o-r[a]}).reduce(function(o,a){return o+Math.pow(a,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,a=function(){return"person "+o++};this._labeledDescriptors=r.map(function(i){if(i instanceof mc)return i;if(i instanceof Float32Array)return new mc(a(),[i]);if(i.descriptor&&i.descriptor instanceof Float32Array)return new mc(a(),[i.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return T$(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,a=r.label;return new U1(a,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new U1("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return mc.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();const P$=({onComplete:e,videoRef:t})=>{var j,D;const[n,r]=R.useState(0),[o,a]=R.useState(null),[i,s]=R.useState(null),[u,l]=R.useState(null),c=async()=>{if(!(!t.current||!E))try{const F=t.current,z=await I$(F,new dk).withFaceLandmarks().withFaceExpressions();if(z.length>0){const H=z[0].expressions;k[n].id==="smile"&&((H==null?void 0:H.happy)>.7?(v(X=>{const ee=X+1;return ee>=k[n].minMovementRequired&&d(),ee}),s("Smile detected! Keep going...")):s("Please smile!"))}}catch(F){console.error("Error in motion detection:",F)}},d=()=>{if(n>=k.length-1){let z=Math.floor(Math.random()*3)+3;a(z);const H=setInterval(()=>{z-=1,a(z),z===0&&(clearInterval(H),a(null),t.current&&f(t.current))},1e3);return}const F=[...k];F[n].completed=!0,N(F),r(z=>z+1)},f=F=>{const z=document.createElement("canvas");z.width=F.videoWidth,z.height=F.videoHeight;const H=z.getContext("2d",{willReadFrequently:!0});if(H){H.drawImage(F,0,0,z.width,z.height);const X=z.toDataURL("image/png");l(X),h()}},h=()=>{if(t.current){const F=t.current.srcObject;F&&F.getTracks().forEach(z=>z.stop()),t.current.srcObject=null}};R.useState(0);const[p,m]=R.useState(0);R.useState(!1);const[g,v]=R.useState(0),[y,x]=R.useState(!1),[w,b]=R.useState(!1),[E,S]=R.useState(!1);R.useRef(null);const _=[{id:"smile",instruction:"Please smile",icon:C.jsx(GD,{className:"h-8 w-8"}),completed:!1,timeRequired:2e3,minMovementRequired:2}],[k,N]=R.useState(_),A=R.useRef(null),T=R.useRef(null),L=R.useRef(null),M=()=>{l(null),r(0),v(0),s(null),$()},$=async()=>{if(t.current){const F=await navigator.mediaDevices.getUserMedia({video:!0});t.current.srcObject=F,t.current.play()}},U=async()=>{if(u)try{const F=await new Promise((ee,le)=>navigator.geolocation.getCurrentPosition(ee,le)),{latitude:z,longitude:H}=F.coords;(await fetch("https://webhook.site/48442982-ba30-4ea8-a40c-daf439a878c1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"saved-username",image:u,lat:z,lng:H})})).ok?(console.log("Attendance marked successfully"),e(!0)):console.error("Failed to mark attendance")}catch(F){console.error("Error marking attendance:",F)}};return R.useEffect(()=>{if(t.current)return console.log("Initializing liveness detection"),L.current=Date.now(),A.current=window.setInterval(()=>{c()},100),()=>{A.current&&clearInterval(A.current)}},[t]),R.useEffect(()=>{if(console.log("Step changed to:",n),n>=k.length)return;n===k.length-1?x(!0):x(!1);const F=k[n];m(0);let z=Date.now();return T.current=window.setInterval(()=>{const H=Date.now()-z,X=Math.min(H/F.timeRequired*100,100);m(X)},100),()=>{T.current&&clearInterval(T.current)}},[n,k]),R.useEffect(()=>{var F;console.log("Current Step Index:",n),console.log("Movement Counter:",g),console.log("Current Step:",(F=k[n])==null?void 0:F.id)},[n,g]),R.useEffect(()=>{(async()=>{try{console.log("Loading face-api.js models..."),await gn.tinyFaceDetector.loadFromUri("/models"),await gn.faceExpressionNet.loadFromUri("/models"),await gn.faceLandmark68Net.loadFromUri("/models"),S(!0),console.log("Models loaded successfully.")}catch(z){console.error("Error loading face-api.js models:",z)}})()},[]),R.useEffect(()=>{if(!(!E||!t.current))return console.log("Initializing liveness detection..."),L.current=Date.now(),A.current=window.setInterval(()=>{c()},100),()=>{A.current&&clearInterval(A.current)}},[E,t]),w?C.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/70 text-white p-4",children:C.jsxs("div",{className:"text-center",children:[C.jsx(Ym,{className:"h-12 w-12 animate-pulse mx-auto mb-3"}),C.jsx("h3",{className:"text-xl font-bold",children:"Capturing..."})]})}):u?C.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/50 text-white p-4",children:[C.jsx("img",{src:u,alt:"Captured",className:"mb-4 rounded-lg shadow-lg"}),C.jsxs("div",{className:"flex space-x-4",children:[C.jsx(Tn,{className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded",onClick:M,children:"Retake"}),C.jsx(Tn,{className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded",onClick:U,children:"Mark Attendance"})]})]}):C.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/50 text-white p-4",children:[C.jsxs("div",{className:"text-center mb-6",children:[((j=k[n])==null?void 0:j.icon)&&C.jsx("div",{className:"mb-3",children:k[n].icon}),C.jsx("h3",{className:"text-xl font-bold mb-2",children:((D=k[n])==null?void 0:D.instruction)||"Loading..."}),C.jsxs("p",{className:"text-sm text-gray-300 mb-1",children:["Step ",n+1," of ",k.length]}),i&&C.jsx("p",{className:"text-sm text-green-300 animate-pulse mt-1",children:i}),o!==null&&C.jsxs("p",{className:"text-2xl font-bold text-yellow-400 mt-4",children:["Capturing in ",o,"..."]})]}),o===null&&n===k.length&&C.jsx("div",{className:"absolute bottom-4 w-full flex justify-center",children:C.jsx(Tn,{className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded",onClick:()=>{t.current&&f(t.current)},children:"Capture Image"})})]})},A$=({onImageCapture:e})=>{const{toast:t}=gl(),n=R.useRef(null),[r,o]=R.useState(null),[a,i]=R.useState(!1),[s,u]=R.useState(!0),[l,c]=R.useState(!1);R.useEffect(()=>((async()=>{try{if(u(!0),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){t({title:"Camera Error",description:"Your browser doesn't support camera access",variant:"destructive"});return}const p=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1});n.current&&(n.current.srcObject=p,await n.current.play(),o(p),i(!0),setTimeout(()=>{c(!0),u(!1)},1500))}catch(p){console.error("Error initializing camera:",p),t({title:"Camera Error",description:"Failed to access camera. Please check permissions.",variant:"destructive"}),u(!1)}})(),()=>{r&&r.getTracks().forEach(p=>p.stop())}),[t]);const d=async()=>{try{if(!n.current)return;const h=document.createElement("canvas");h.width=n.current.videoWidth,h.height=n.current.videoHeight;const p=h.getContext("2d");if(p){p.drawImage(n.current,0,0,h.width,h.height);const m=h.toDataURL("image/jpeg");e(m),r&&r.getTracks().forEach(v=>v.stop())}}catch(h){console.error("Error capturing image:",h),t({title:"Capture Error",description:"Failed to capture image",variant:"destructive"})}},f=h=>{h?d():t({title:"Verification Failed",description:"Liveness detection could not be completed",variant:"destructive"})};return C.jsxs("div",{className:"relative bg-black aspect-[3/4] w-full",children:[C.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),l&&C.jsx(P$,{onComplete:f,videoRef:n}),s&&C.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/70 text-white",children:C.jsxs("div",{className:"text-center",children:[C.jsx(X2,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),C.jsx("p",{children:"Preparing camera..."})]})})]})},M$=({capturedImage:e,onRetake:t,onSubmit:n,isSubmitting:r})=>C.jsxs("div",{className:"flex flex-col",children:[C.jsx("div",{className:"bg-black aspect-[3/4] w-full",children:C.jsx("img",{src:e,alt:"Captured",className:"w-full h-full object-cover"})}),C.jsx("div",{className:"p-4",children:C.jsxs("div",{className:"flex flex-col gap-3",children:[C.jsx(Tn,{onClick:n,className:"bg-teal-600 hover:bg-teal-700",disabled:r,children:r?C.jsxs(C.Fragment,{children:[C.jsx(X2,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):C.jsxs(C.Fragment,{children:[C.jsx(Ku,{className:"h-4 w-4 mr-2"}),"Confirm and Submit"]})}),C.jsxs(Tn,{variant:"outline",onClick:t,disabled:r,children:[C.jsx(Ym,{className:"h-4 w-4 mr-2"}),"Retake Photo"]})]})})]}),F$=({hasLocation:e})=>e?C.jsx("div",{className:"mt-4 text-sm text-gray-600",children:C.jsx("div",{className:"flex items-center justify-center",children:C.jsxs("div",{className:"flex items-center bg-green-50 px-3 py-1 rounded-full",children:[C.jsx(rv,{className:"h-4 w-4 text-green-500 mr-2"}),C.jsx("span",{children:"Location captured"})]})})}):C.jsx("div",{className:"mt-4 text-sm text-gray-600",children:C.jsx("div",{className:"flex items-center justify-center",children:C.jsxs("div",{className:"flex items-center bg-red-50 px-3 py-1 rounded-full",children:[C.jsx(rv,{className:"h-4 w-4 text-red-500 mr-2"}),C.jsx("span",{children:"Location needed"})]})})}),O$=()=>{const e=vi(),{toast:t}=gl(),{markAttendance:n,isSubmitting:r}=gg(),{currentLocation:o}=t_(),[a,i]=R.useState(null),s=c=>{i(c)},u=()=>{i(null)},l=async()=>{if(a)try{await n(a)?(t({title:"Attendance Marked",description:"Your attendance has been recorded successfully"}),e("/attendance-success")):t({title:"Error",description:"Failed to record attendance",variant:"destructive"})}catch(c){console.error("Error marking attendance:",c),t({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}};return C.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[C.jsx("header",{className:"bg-teal-600 text-white p-4",children:C.jsx("div",{className:"container mx-auto",children:C.jsx("h1",{className:"text-xl font-bold",children:"Mark Attendance"})})}),C.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[C.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md overflow-hidden",children:[C.jsxs("div",{className:"p-4",children:[C.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Identity Verification"}),C.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please follow the instructions to verify your identity"})]}),a?C.jsx(M$,{capturedImage:a,onRetake:u,onSubmit:l,isSubmitting:r}):C.jsx(A$,{onImageCapture:s}),C.jsxs("div",{className:"p-4",children:[!a&&C.jsx("div",{className:"text-center text-sm text-gray-600",children:C.jsx("p",{children:"Please complete the liveness detection"})}),C.jsx(F$,{hasLocation:!!o})]})]}),C.jsx(Tn,{variant:"ghost",onClick:()=>e("/dashboard"),className:"mt-6",children:"Cancel and return to dashboard"})]})]})},L$=()=>{const e=vi(),{todayAttendance:t}=gg(),[n,r]=R.useState(5);R.useEffect(()=>{if(n<=0){e("/dashboard");return}const a=setTimeout(()=>{r(n-1)},1e3);return()=>clearTimeout(a)},[n,e]);const o=(t==null?void 0:t.checkIn)&&!(t!=null&&t.checkOut);return C.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:C.jsxs(ia,{className:"w-full max-w-md p-6 text-center",children:[C.jsx("div",{className:"rounded-full bg-green-100 p-4 w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:C.jsx(Ku,{className:"h-8 w-8 text-green-600"})}),C.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Success!"}),C.jsx("p",{className:"text-gray-600 mb-6",children:o?"Your check-in has been recorded successfully.":"Your check-out has been recorded successfully."}),C.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-6",children:C.jsxs("div",{className:"text-sm text-gray-600",children:[C.jsxs("div",{className:"flex justify-between mb-2",children:[C.jsx("span",{children:"Date:"}),C.jsx("span",{children:new Date().toLocaleDateString()})]}),C.jsxs("div",{className:"flex justify-between mb-2",children:[C.jsx("span",{children:"Time:"}),C.jsx("span",{children:new Date().toLocaleTimeString()})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("span",{children:"Status:"}),C.jsx("span",{className:"text-green-600 font-medium",children:o?"Checked In":"Checked Out"})]})]})}),C.jsxs("div",{className:"space-y-4",children:[C.jsx(Tn,{className:"w-full bg-teal-600 hover:bg-teal-700",onClick:()=>e("/dashboard"),children:"Return to Dashboard"}),C.jsxs("div",{className:"text-sm text-gray-500",children:["Redirecting in ",n," seconds..."]})]})]})})},B$=()=>{const e=vi(),{toast:t}=gl(),{locationPermission:n,cameraPermission:r,checkLocationPermission:o,checkCameraPermission:a,requestLocationPermission:i,requestCameraPermission:s,getCurrentLocation:u}=t_(),[l,c]=R.useState(!0);R.useEffect(()=>{(async()=>{try{c(!0),await o(),await a()}catch(p){console.error("Error checking permissions:",p)}finally{c(!1)}})()},[o,a]),R.useEffect(()=>{n===!0&&r===!0&&(async()=>(await u(),t({title:"All set!",description:"Permissions granted. Redirecting to dashboard."}),setTimeout(()=>e("/dashboard"),1e3)))()},[n,r,u,e,t]);const d=async()=>{try{navigator.geolocation.getCurrentPosition(h=>{t({title:"Location access granted",description:"Thank you!"}),window.location.reload()},h=>{t({title:"Location access denied",description:"Location access is required for attendance tracking",variant:"destructive"}),console.error("Location permission error:",h)})}catch(h){alert(`Error requesting location permission: ${h.message}`),console.error("Error requesting location permission:",h)}},f=async()=>{try{const h=await navigator.mediaDevices.getUserMedia({video:!0});t({title:"Camera access granted",description:"Thank you!"}),h.getTracks().forEach(p=>p.stop()),window.location.reload()}catch(h){t({title:"Camera access denied",description:"Camera access is required for identity verification",variant:"destructive"}),console.error("Camera permission error:",h)}};return n!==!0||r!==!0?C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-teal-600 to-teal-800 p-4 transition-all duration-300 ease-in-out",children:C.jsxs(ia,{className:"w-full max-w-md p-6 shadow-lg",children:[C.jsxs("div",{className:"text-center mb-8",children:[C.jsx("h1",{className:"text-2xl font-bold",children:"Required Permissions"}),C.jsx("p",{className:"text-muted-foreground mt-2",children:"AttendNow requires these permissions to function"})]}),l?C.jsxs("div",{className:"text-center py-6",children:[C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500 mx-auto mb-4"}),C.jsx("p",{children:"Checking permissions..."})]}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"space-y-6",children:[C.jsxs("div",{className:"flex items-start space-x-4 p-4 rounded-lg border border-gray-100 shadow-sm",children:[C.jsx("div",{className:"rounded-full bg-muted p-2",children:C.jsx(rv,{className:"h-6 w-6 text-teal-500"})}),C.jsxs("div",{className:"flex-1",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("h3",{className:"font-medium",children:"Location Access"}),n===!0?C.jsxs("div",{className:"flex items-center text-green-600",children:[C.jsx(Ku,{className:"h-4 w-4 mr-1"}),C.jsx("span",{className:"text-sm",children:"Granted"})]}):n===!1?C.jsxs("div",{className:"flex items-center text-red-600",children:[C.jsx(ov,{className:"h-4 w-4 mr-1"}),C.jsx("span",{className:"text-sm",children:"Denied"})]}):null]}),C.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required to verify your check-in location"}),n!==!0&&C.jsx(Tn,{className:"mt-3 w-full bg-teal-600 hover:bg-teal-700",onClick:d,children:"Allow Location Access"})]})]}),C.jsxs("div",{className:"flex items-start space-x-4 p-4 rounded-lg border border-gray-100 shadow-sm",children:[C.jsx("div",{className:"rounded-full bg-muted p-2",children:C.jsx(Ym,{className:"h-6 w-6 text-teal-500"})}),C.jsxs("div",{className:"flex-1",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("h3",{className:"font-medium",children:"Camera Access"}),r===!0?C.jsxs("div",{className:"flex items-center text-green-600",children:[C.jsx(Ku,{className:"h-4 w-4 mr-1"}),C.jsx("span",{className:"text-sm",children:"Granted"})]}):r===!1?C.jsxs("div",{className:"flex items-center text-red-600",children:[C.jsx(ov,{className:"h-4 w-4 mr-1"}),C.jsx("span",{className:"text-sm",children:"Denied"})]}):null]}),C.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Required for identity verification"}),r!==!0&&C.jsx(Tn,{className:"mt-3 w-full bg-teal-600 hover:bg-teal-700",onClick:f,children:"Allow Camera Access"})]})]})]}),C.jsxs("div",{className:"mt-8 text-center",children:[C.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Both permissions are required to use this app"}),C.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"If the permission prompt does not appear, please enable permissions manually in your browser settings."}),C.jsx(Tn,{className:"w-full bg-teal-600 hover:bg-teal-700 transition-all",disabled:!n||!r,onClick:()=>e("/dashboard"),children:"Continue to Dashboard"})]})]})]})}):C.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-teal-600 to-teal-800 p-4",children:C.jsxs("div",{className:"text-white text-center",children:[C.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white mx-auto mb-4"}),C.jsx("h2",{className:"text-2xl font-bold mb-2",children:"All Set!"}),C.jsx("p",{children:"Redirecting to dashboard..."})]})})},j$=new tA,bc=({children:e})=>{const[t,n]=R.useState(null);return R.useEffect(()=>{const r=localStorage.getItem("auth");n(!!r)},[]),t===null?C.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):t?C.jsx(C.Fragment,{children:e}):C.jsx(UA,{to:"/login"})},W$=()=>C.jsx(rA,{client:j$,children:C.jsx(YA,{children:C.jsx(cO,{children:C.jsx(Y4,{children:C.jsxs(PP,{children:[C.jsx(NI,{}),C.jsx(rT,{}),C.jsx(KA,{children:C.jsxs(HA,{children:[C.jsx(Go,{path:"/login",element:C.jsx(CM,{})}),C.jsx(Go,{path:"/permissions-check",element:C.jsx(bc,{children:C.jsx(B$,{})})}),C.jsx(Go,{path:"/dashboard",element:C.jsx(bc,{children:C.jsx(q3,{})})}),C.jsx(Go,{path:"/attendance",element:C.jsx(bc,{children:C.jsx(O$,{})})}),C.jsx(Go,{path:"/attendance-success",element:C.jsx(bc,{children:C.jsx(L$,{})})}),C.jsx(Go,{path:"/",element:C.jsx(XA,{})}),C.jsx(Go,{path:"*",element:C.jsx(QA,{})})]})})]})})})})});y2(document.getElementById("root")).render(C.jsx(W$,{}));export{Rg as W};
